webpackJsonp([1],{"+DLE":function(e,t){},"+GCz":function(e,t){},"0Lu9":function(e,t){},"0Qll":function(e,t){},"4ZFM":function(e,t){},"6Qis":function(e,t){},"7Xnb":function(e,t){},"8dWQ":function(e,t){},"93n+":function(e,t){},AwKP:function(e,t){},BwKJ:function(e,t){},C1ID:function(e,t){},EGP7:function(e,t){},GViy:function(e,t){},GkGg:function(e,t){},H5mK:function(e,t){},JGkj:function(e,t){},Ka8N:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),n=a("zL8q"),r=a.n(n),i=(a("tvR6"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]});var o=a("VU/8")({name:"App"},i,!1,function(e){a("GkGg")},null,null).exports,l=a("/ocq"),c=a("//Fk"),u=a.n(c),d=a("mtWM"),p=a.n(d),m={routerName:null,token:null,user:null,useractualname:null,email:null,Is_superuser:null};p.a.defaults.withCredentials=!0,p.a.defaults.baseURL=config.baseurl,p.a.interceptors.request.use(function(e){return m.token&&(e.headers.Authorization=""+m.token),e},function(e){return u.a.reject(e)}),p.a.interceptors.response.use(function(e){return e},function(e){try{if(401===e.response.status)n.Message.error({message:"请先登录"}),os.replace({name:"Login"});else if(500===e.response.status||404===e.response.status)n.Message.error({message:"服务器内部异常, 请检查",duration:1e3});else if(504===e.response.status)n.Message.error({message:"请求超时,请联系系统管理员",duration:1e3});else if(405===e.response.status)n.Message.error({message:"Not Allowed"});else if(e.response.data.constructor===String)NotificaNotificationstion.error({title:"error",message:e.response.data});else for(var t in e.response.data)e.response.data[t].constructor===Array?n.Message.error({title:t,message:e.response.data[t][0]}):e.response.data[t].constructor===String&&n.Message.error({title:t,message:e.response.data[t]});return u.a.reject(e.response.data)}catch(e){n.Message.error({message:"服务器连接超时，请重试"})}});var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.a.get(e,{params:t,withCredentials:!0}).then(function(e){return e.data})},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.a.post(e,t).then(function(e){return e.data})},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.withCredentials=!0,p.a.delete(e,t).then(function(e){return e.data})},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.withCredentials=!0,p.a.patch(e,t).then(function(e){return e.data})},b=function(e){return h("/api/testrunner/getpermissionslist/",e)},_=function(e){return g("/api/user/userinfo/",e)},y={data:function(){var e=this;return{HTurl:config.HTurl,editdialogVisible:!1,editVariablesForm:{username:this.$store.state.user,name:this.$store.state.useractualname,email:this.$store.state.email},editpasswordVisible:!1,editpasswordForm:{password:"",newpassword:"",checkpassword:""},rules:{password:[{required:!0,message:"请输入旧密码",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}],newpassword:[{validator:function(t,a,s){if(!a)return s(new Error("新密码不能为空"));a===e.editpasswordForm.password?s(new Error("新密码不能与原密码相同!")):a.toString().length<6?s(new Error("密码至少六位")):s()},required:!0,trigger:"blur"}],checkpassword:[{validator:function(t,a,s){if(!a)return s(new Error("确认密码不能为空"));a!==e.editpasswordForm.newpassword?s(new Error("与新密码不一致!")):a.toString().length<6?s(new Error("密码至少六位")):s()},required:!0,trigger:"blur"}]}}},methods:{handleLogOut:function(){this.$store.commit("isLogin",null),this.setLocalValue("token",null),this.$router.push({name:"Login"})},handleEditConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.editdialogVisible=!1,_(t.editVariablesForm).then(function(e){e.success?(t.$store.commit("setUseractualname",t.editVariablesForm.name),t.$store.commit("setUseEmail",t.editVariablesForm.email),t.setLocalValue("useractualname",t.editVariablesForm.name),t.setLocalValue("email",t.editVariablesForm.email),t.$message.success({message:e.msg,duration:1e3})):t.$message.error({message:e.msg,duration:1e3})}))})},handleEditpasswordConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.editpasswordVisible=!1,(a=t.editpasswordForm,f("/api/user/updateuserpassword/",a)).then(function(e){e.success?(t.$message.success({message:e.msg,duration:1e3}),t.$router.push("/testrunner/login")):(t.editpasswordForm.password="",t.editpasswordForm.newpassword="",t.editpasswordForm.checkpassword="",t.$message.error({message:e.msg,duration:1e3}))}))})},canceltable:function(e){"editpasswordForm"===e?(this.editpasswordVisible=!1,this.editpasswordForm.password="",this.editpasswordForm.newpassword="",this.editpasswordForm.checkpassword=""):(this.editdialogVisible=!1,this.editVariablesForm={username:this.$store.state.user,useractualname:this.$store.state.useractualname,email:this.$store.state.email})}},name:"Header"},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"nav-header"},[a("span",{staticStyle:{color:"white","font-size":"25px","margin-left":"10px"}},[e._v("雞你胎鎂")]),e._v(" "),a("span",{staticClass:"right"},[a("div",{staticStyle:{float:"right",color:"#d9d9d9","margin-right":"100px"}},[a("a",{staticClass:"iconfont",on:{click:function(t){e.editdialogVisible=!0}}},[e._v("")]),e._v(" "),a("span",{staticStyle:{"padding-left":"5px","font-size":"large"},domProps:{textContent:e._s(this.$store.state.useractualname)}}),e._v(" "),1==this.$store.state.Is_superuser||"true"==this.$store.state.Is_superuser?a("a",{staticStyle:{"padding-left":"10px",color:"#d9d9d9","text-decoration":"none"},attrs:{href:e.HTurl,target:"_blank"}},[e._v("后台管理")]):e._e(),e._v(" "),a("a",{staticStyle:{"padding-left":"10px"},on:{click:function(t){e.editpasswordVisible=!0}}},[e._v("修改密码")]),e._v(" "),a("a",{staticStyle:{"padding-left":"10px"},on:{click:e.handleLogOut}},[e._v("注 销")])])]),e._v(" "),a("el-dialog",{attrs:{title:"修改用户信息",visible:e.editdialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.editdialogVisible=t}}},[a("el-form",{ref:"editVariablesForm",staticClass:"project",attrs:{model:e.editVariablesForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.editVariablesForm.username,callback:function(t){e.$set(e.editVariablesForm,"username",t)},expression:"editVariablesForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入用户名"},model:{value:e.editVariablesForm.name,callback:function(t){e.$set(e.editVariablesForm,"name",t)},expression:"editVariablesForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入邮箱"},model:{value:e.editVariablesForm.email,callback:function(t){e.$set(e.editVariablesForm,"email",t)},expression:"editVariablesForm.email"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.canceltable("editVariablesForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditConfirm("editVariablesForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:e.editpasswordVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.editpasswordVisible=t}}},[a("el-form",{ref:"editpasswordForm",staticClass:"project",attrs:{model:e.editpasswordForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"旧密码",prop:"password"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入旧密码",type:"password"},model:{value:e.editpasswordForm.password,callback:function(t){e.$set(e.editpasswordForm,"password",t)},expression:"editpasswordForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码",prop:"newpassword"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入新密码",type:"password"},model:{value:e.editpasswordForm.newpassword,callback:function(t){e.$set(e.editpasswordForm,"newpassword",t)},expression:"editpasswordForm.newpassword"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"checkpassword"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入确认密码",type:"password"},model:{value:e.editpasswordForm.checkpassword,callback:function(t){e.$set(e.editpasswordForm,"checkpassword",t)},expression:"editpasswordForm.checkpassword"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.canceltable("editpasswordForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditpasswordConfirm("editpasswordForm")}}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var x=a("VU/8")(y,w,!1,function(e){a("yxV7")},"data-v-5ef08998",null).exports,k=new s.default,C={name:"Side",data:function(){return{side_menu:[{code:"el-icon-s-tools",title:"系统管理",index:"homelist"},{title:"项目概况",index:"ProjectDetail",code:"el-icon-collection"},{title:"测试资料库",index:"TestDataIndex",code:"el-icon-s-data"},{title:"数据库配置",index:"DataBase",code:"el-icon-coin"},{code:"el-icon-menu",index:"api",title:"API自动化",subs:[{title:"API 模板",index:"RecordApi"},{title:"测试用例",index:"AutoTest"},{title:"配置管理",index:"RecordConfig"},{title:"全局变量",index:"GlobalEnv"},{title:"域名管理",index:"HostIP"},{title:"驱动代码",index:"DebugTalk"},{title:"定时任务",index:"Task"},{title:"历史报告",index:"Reports"}]},{code:"el-icon-s-order",index:"webselemium",title:"web自动化",subs:[{title:"UI用例管理"},{title:"UI测试计划"},{title:"UI页面配置"},{title:"UI全局变量"},{title:"UI定时任务"},{title:"UI测试报告"}]}]}},created:function(){var e=this;k.$on("collapse",function(t){e.collapse=t,k.$emit("collapse-content",t)})},methods:{select:function(e){this.$store.commit("setRouterName",e),this.$router.push({name:e}),this.setLocalValue("routerName",e)}}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{staticClass:"common-side-bar",attrs:{"unique-opened":"","default-active":e.$store.state.routerName,"background-color":"#304056","text-color":"#BFCBD9","active-text-color":"#318DF1"},on:{select:e.select}},[e._l(e.side_menu,function(t){return[t.subs?[a("el-submenu",{key:t.index,attrs:{index:t.index,disabled:"homelist"===e.$store.state.routerName}},[a("template",{slot:"title"},[a("span",{class:t.code,attrs:{slot:"title"},slot:"title"}),e._v("  "+e._s(t.title)+"\n                    ")]),e._v(" "),e._l(t.subs,function(t){return[t.subs?a("el-submenu",{key:t.index,attrs:{index:t.index}},[a("template",{slot:"title"},[e._v(e._s(t.title))]),e._v(" "),e._l(t.subs,function(t,s){return a("el-menu-item",{key:s,attrs:{index:t.index}},[e._v(e._s(t.title))])})],2):a("el-menu-item",{key:t.index,attrs:{index:t.index}},[e._v(e._s(t.title))])]})],2)]:"项目概况"==t.title||"测试资料库"==t.title||"数据库配置"==t.title?[a("el-menu-item",{key:t.index,attrs:{index:t.index,disabled:"homelist"===e.$store.state.routerName}},[a("template",{slot:"title"},[a("span",{class:t.code,attrs:{slot:"title"},slot:"title"}),e._v("  "+e._s(t.title)+"\n                    ")])],2)]:[a("el-menu-item",{key:t.index,attrs:{index:t.index}},[a("template",{slot:"title"},[a("span",{class:t.code,attrs:{slot:"title"},slot:"title"}),e._v("  "+e._s(t.title)+"\n                    ")])],2)]]})],2)},staticRenderFns:[]};var T={name:"Home",components:{HomeHeader:x,HomeSide:a("VU/8")(C,S,!1,function(e){a("xQym")},"data-v-c04d5be4",null).exports}},F={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[t("home-header")],1),this._v(" "),t("el-container",[t("el-aside",{staticStyle:{width:"202px"}},[t("home-side")],1),this._v(" "),t("el-main",[t("router-view")],1)],1)],1)},staticRenderFns:[]};var $=a("VU/8")(T,F,!1,function(e){a("m2dO")},"data-v-4d031dd8",null).exports,D={name:"Register",data:function(){return{registerForm:{username:"",password:"",name:"",repwd:"",email:""},passwordInvalid:"",usernameInvalid:"",repwdInvalid:"",emailInvalid:"",nameInvalid:""}},rules:{name:[{min:1,max:20,message:"最多不超过20个字符",trigger:"blur"}]},methods:{validateUser:function(){return!!/^[a-zA-Z0-9_-]{4,16}$/.test(this.registerForm.username)||(this.usernameInvalid="用户名4到16位,只能是字母,数字,下划线,连字符",!1)},validatePassword:function(){return!!/^[a-zA-Z\d_]{6,}$/.test(this.registerForm.password)||(this.passwordInvalid="密码至少6位数",!1)},validateRepwd:function(){return this.registerForm.password===this.registerForm.repwd||(this.repwdInvalid="确认密码和密码不一致",!1)},validateEmail:function(){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(this.registerForm.email)||(this.emailInvalid="邮箱格式不正确",!1)},handleRegisterSuccess:function(e){e.success?this.$router.push("/testrunner/login"):this.$message.error({message:e.msg,duration:2e3,center:!0})},submitForm:function(e){var t,a=this;this.validateUser()&&this.validatePassword()&&this.validateRepwd()&&this.validateEmail()&&(t=this.registerForm,f("/api/user/register/",t)).then(function(e){a.handleRegisterSuccess(e)})}}},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"login"},[a("el-header",[a("el-row",[a("el-col",{attrs:{span:4,offset:1}},[a("div")])],1)],1),e._v(" "),a("el-main",{staticStyle:{padding:"0px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",[a("div",{attrs:{id:"form-title"}},[e._v("自动化平台《xuxc》")]),e._v(" "),a("form",{attrs:{id:"submit-form"}},[a("div",{attrs:{id:"form-content"}},[a("div",{staticStyle:{"text-align":"center"},attrs:{id:"form-msg"}},[e._v("注册账号")]),e._v(" "),a("div",{attrs:{id:"form-inputs"}},[a("div",{staticClass:"form-input-div"},[a("i",{staticClass:"iconfont",staticStyle:{position:"absolute",bottom:"438px","padding-left":"10px"}},[e._v("")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.username,expression:"registerForm.username"}],attrs:{placeholder:"用户名",type:"text",id:"user"},domProps:{value:e.registerForm.username},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"username",t.target.value)}}}),e._v(" "),a("div",{staticClass:"err_msg",attrs:{id:"user_err"},domProps:{innerHTML:e._s(e.usernameInvalid)},on:{mouseover:function(t){e.usernameInvalid=""}}})]),e._v(" "),a("div",{staticClass:"form-input-div"},[a("i",{staticClass:"iconfont",staticStyle:{position:"absolute",bottom:"375px","padding-left":"10px"}},[e._v("")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.name,expression:"registerForm.name"}],attrs:{placeholder:"姓名",type:"text",id:"name"},domProps:{value:e.registerForm.name},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"name",t.target.value)}}}),e._v(" "),a("div",{staticClass:"err_msg",attrs:{id:"user_name"},domProps:{innerHTML:e._s(e.nameInvalid)},on:{mouseover:function(t){e.nameInvalid=""}}})]),e._v(" "),a("div",{staticClass:"form-input-div"},[a("i",{staticClass:"iconfont",staticStyle:{position:"absolute",bottom:"312px","padding-left":"10px"}},[e._v("")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.password,expression:"registerForm.password"}],attrs:{placeholder:"密码",type:"password",id:"pwd"},domProps:{value:e.registerForm.password},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"password",t.target.value)}}}),e._v(" "),a("div",{staticClass:"err_msg",attrs:{id:"pwd_err"},domProps:{innerHTML:e._s(e.passwordInvalid)},on:{mouseover:function(t){e.passwordInvalid=""}}})]),e._v(" "),a("div",{staticClass:"form-input-div"},[a("i",{staticClass:"iconfont",staticStyle:{position:"absolute",bottom:"250px","padding-left":"10px"}},[e._v("")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.repwd,expression:"registerForm.repwd"}],attrs:{placeholder:"确认密码",type:"password",id:"repwd"},domProps:{value:e.registerForm.repwd},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"repwd",t.target.value)}}}),e._v(" "),a("div",{staticClass:"err_msg",attrs:{id:"repwd_err"},domProps:{innerHTML:e._s(e.repwdInvalid)},on:{mouseover:function(t){e.repwdInvalid=""}}})]),e._v(" "),a("div",{staticClass:"form-input-div"},[a("i",{staticClass:"iconfont",staticStyle:{position:"absolute",bottom:"190px","padding-left":"10px"}},[e._v("")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.email,expression:"registerForm.email"}],attrs:{placeholder:"邮箱",type:"email",id:"email"},domProps:{value:e.registerForm.email},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"email",t.target.value)}}}),e._v(" "),a("div",{staticClass:"err_msg",attrs:{id:"email_err"},domProps:{innerHTML:e._s(e.emailInvalid)},on:{mouseover:function(t){e.emailInvalid=""}}})]),e._v(" "),a("div",{staticClass:"form-submit"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button",id:"submitBtn"},on:{click:e.submitForm}},[e._v("立即注册\n                                    ")])])]),e._v(" "),a("div",{staticClass:"form-foot"},[a("span",[e._v("已有账户，"),a("router-link",{attrs:{to:"/testrunner/login"}},[e._v("立即登陆")])],1)])])])])])],1)],1)],1)},staticRenderFns:[]};var P=a("VU/8")(D,V,!1,function(e){a("o75T")},"data-v-477a24e6",null).exports,N={name:"Login",data:function(){return{loginForm:{username:"",password:""},usernameInvalid:"",passwordInvalid:""}},methods:{validateUserName:function(){return""!==this.loginForm.username.replace(/(^\s*)/g,"")||(this.usernameInvalid="用户名不能为空",!1)},validatePassword:function(){return""!==this.loginForm.password.replace(/(^\s*)/g,"")||(this.passwordInvalid="密码不能为空",!1)},handleLoginSuccess:function(e){e.success?(this.$router.push({name:"homelist"}),this.$store.commit("isLogin",e.token),this.$store.commit("setUser",e.user),this.$store.commit("setUseractualname",e.name),this.$store.commit("setUseEmail",e.email),this.$store.commit("setIs_superuser",e.Is_superuser),this.$store.commit("setRouterName","homelist"),this.setLocalValue("token",e.token),this.setLocalValue("user",e.user),this.setLocalValue("routerName","homelist"),this.setLocalValue("useractualname",e.name),this.setLocalValue("email",e.email),this.setLocalValue("Is_superuser",e.Is_superuser)):this.$message.error({message:e.msg,duration:2e3,center:!0})},submitForm:function(){var e,t=this;this.validateUserName()&&this.validatePassword()&&(e=this.loginForm,f("/api/user/login/",e)).then(function(e){t.handleLoginSuccess(e)})}}},R={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",{staticClass:"login login-wrap-nighttime"},[s("div",{staticClass:"login-box "},[s("div",{staticClass:"login-box-left"},[s("img",{attrs:{src:a("O7CB"),alt:""}}),e._v(" "),s("div",{staticClass:"box-left-content"},[s("div",{staticClass:"line"}),e._v(" "),s("div",{staticClass:"slogan"},[e._v("自动化平台《xuxc》")])])]),e._v(" "),s("div",{staticClass:"login-box-right"},[s("div",{staticClass:"login-box-content"},[s("div",{staticClass:"login-box-inp"},[s("form",{attrs:{id:"submit-form"}},[s("div",{staticStyle:{"text-align":"center"},attrs:{id:"form-msg"}},[e._v("登录账号")]),e._v(" "),s("div",{attrs:{id:"form-inputs"}},[s("div",{staticClass:"form-input-div"},[s("i",{staticClass:"iconfont",staticStyle:{position:"absolute",bottom:"215px","padding-left":"10px"}},[e._v("")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.username,expression:"loginForm.username"}],attrs:{placeholder:"用户名",type:"text",id:"username"},domProps:{value:e.loginForm.username},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"username",t.target.value)}}}),e._v(" "),s("div",{staticClass:"err_msg",attrs:{id:"username_err"},domProps:{innerHTML:e._s(e.usernameInvalid)},on:{mouseover:function(t){e.usernameInvalid=""}}})]),e._v(" "),s("div",{staticClass:"form-input-div"},[s("i",{staticClass:"iconfont",staticStyle:{position:"absolute",bottom:"155px","padding-left":"10px"}},[e._v("")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.password,expression:"loginForm.password"}],attrs:{placeholder:"密码",type:"password",id:"pwd"},domProps:{value:e.loginForm.password},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"password",t.target.value)}}}),e._v(" "),s("div",{staticClass:"err_msg",attrs:{id:"pwd_err"},domProps:{innerHTML:e._s(e.passwordInvalid)},on:{mouseover:function(t){e.passwordInvalid=""}}})]),e._v(" "),s("div",{staticClass:"form-submit"},[s("button",{staticClass:"btn btn-primary",staticStyle:{"border-radius":"5px!important"},attrs:{type:"button",id:"submitBtn"},on:{click:e.submitForm}},[e._v("立即登录\n                                    ")])])]),e._v(" "),s("div",{staticClass:"form-foot"},[s("span",[e._v("没有账户，"),s("router-link",{attrs:{to:"/testrunner/register"}},[e._v("立即注册")])],1)])])])])])]),e._v(" "),s("el-footer",{staticClass:"copyright"},[s("span",[e._v("©Copyright 2022 xuxc")])])],1)},staticRenderFns:[]};var j=a("VU/8")(N,R,!1,function(e){a("AwKP")},"data-v-52d1c782",null).exports,L="/api/testrunner/project/",E=function(e){return h(L,e)},I={data:function(){return{dialogVisible:!1,editVisible:!1,permissions:[],projectData:{results:[]},projectForm:{name:"",desc:"",responsible:this.$store.state.useractualname,id:""},rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],desc:[{required:!0,message:"简要描述下该项目",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}]}}},methods:{handleCellClick:function(e){this.$store.commit("setRouterName","ProjectDetail"),this.setLocalValue("routerName","ProjectDetail"),this.$router.push({name:"ProjectDetail",params:{id:e.id}})},handleEdit:function(e,t){this.editVisible=!0,this.projectForm.name=t.name,this.projectForm.desc=t.desc,this.projectForm.id=t.id},handleDelete:function(e,t){var a=this;this.$confirm("此操作将永久删除该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e;(e={data:{id:t.id}},v(L,e)).then(function(e){e.success?(a.success(e),a.getProjectList()):a.failure(e)})})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return""!==t.projectForm.id?t.editVisible=!0:t.dialogVisible=!0,!1;t.dialogVisible=!1,t.editVisible=!1;var a,s,n=void 0;""===t.projectForm.id?(s=t.projectForm,n=f(L,s)):(a=t.projectForm,n=g(L,a)),n.then(function(e){e.success?(t.success(e),t.getProjectList()):t.failure(e),t.projectForm.name="",t.projectForm.desc="",t.projectForm.id=""})})},success:function(e){this.$notify({message:e.msg,type:"success",duration:1e3})},failure:function(e){console.log(e),this.$notify.error({message:e.msg,duration:1e3})},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"project"}).then(function(t){e.permissions=t.permissions})},getProjectList:function(){var e=this;E().then(function(t){e.projectData=t})},getPagination:function(e){var t=this;(function(e){return h(e)})(e).then(function(e){t.projectData=e})}},mounted:function(){this.getProjectList(),this.getpermissions()},name:"ProjectList"},A={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#F7F7F7",padding:"0",height:"50px"}},[a("div",[a("div",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n                    添加项目\n                ")]):e._e(),e._v(" "),a("el-button",{staticStyle:{"margin-left":"50px"},attrs:{type:"info",round:"",size:"small",icon:"el-icon-d-arrow-left",disabled:null===e.projectData.previous},on:{click:function(t){return e.getPagination(e.projectData.previous)}}},[e._v("\n                    上一页\n                ")]),e._v(" "),a("el-button",{attrs:{type:"info",round:"",size:"small",disabled:null===e.projectData.next},on:{click:function(t){return e.getPagination(e.projectData.next)}}},[e._v("\n                    下一页\n                    "),a("i",{staticClass:"el-icon-d-arrow-right"})]),e._v(" "),a("el-dialog",{attrs:{title:"添加项目",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"projectForm",staticClass:"project",attrs:{model:e.projectForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[a("el-input",{attrs:{clearable:""},model:{value:e.projectForm.name,callback:function(t){e.$set(e.projectForm,"name",t)},expression:"projectForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目描述",prop:"desc"}},[a("el-input",{attrs:{clearable:""},model:{value:e.projectForm.desc,callback:function(t){e.$set(e.projectForm,"desc",t)},expression:"projectForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("projectForm")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:e.projectData.results,border:"",stripe:"","show-header":e.projectData.results.length>0,"highlight-current-row":""}},[a("el-table-column",{attrs:{label:"项目名称",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"font-size":"18px","font-weight":"bold",cursor:"pointer"},on:{click:function(a){return e.handleCellClick(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"负责人",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.responsible))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"项目描述",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间",width:"260",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.permissions.includes("view")?a("el-button",{attrs:{size:"medium"},on:{click:function(a){return e.handleCellClick(t.row)}}},[e._v("详情\n                        ")]):e._e(),e._v(" "),e.permissions.includes("change")?a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑\n                        ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"编辑项目",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"projectForm",staticClass:"project",attrs:{model:e.projectForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[a("el-input",{attrs:{clearable:""},model:{value:e.projectForm.name,callback:function(t){e.$set(e.projectForm,"name",t)},expression:"projectForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目描述",prop:"desc"}},[a("el-input",{attrs:{clearable:""},model:{value:e.projectForm.desc,callback:function(t){e.$set(e.projectForm,"desc",t)},expression:"projectForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("projectForm")}}},[e._v("确 定")])],1)],1),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n                        ")]):e._e()]}}])})],1)],1)],1)],1)},staticRenderFns:[]};var B=a("VU/8")(I,A,!1,function(e){a("oi8e")},"data-v-e7fbf0d2",null).exports,q={name:"ProjectDetail",data:function(){return{projectInfo:{},option:{title:{text:"用例类型分布"},tooltip:{},xAxis:{},yAxis:{},series:[]},runcasepotion:{title:{text:"用例运行情况"},tooltip:{},xAxis:{},yAxis:{},series:[]}}},methods:{gettagcount:function(){var e,t=this;(e={project:this.$route.params.id},h("/api/testrunner/gettagcount/",e)).then(function(e){t.option.xAxis={data:e.typename},t.option.series=[{name:"",type:"bar",barWidth:"35%",data:e.countlist}],t.$echarts.init(document.getElementById("casetable")).setOption(t.option)})},getreporttail:function(){var e,t=this;(e={project:this.$route.params.id},h("/api/testrunner/getreporttail/",e)).then(function(e){t.runcasepotion.xAxis={data:["通过","失败","异常","跳过"]},t.runcasepotion.series=[{name:"",type:"bar",color:"lightgreen",barWidth:"25%",data:[e.successes,e.failure,e.error,e.skippe]}],t.$echarts.init(document.getElementById("runcasetable")).setOption(t.runcasepotion)})},success:function(e){this.$notify({message:e.msg,type:"success",duration:1e3})},failure:function(e){this.$notify.error({message:e.msg,duration:1e3})},getProjectDetail:function(){var e=this;console.log(this.$route.params.id),function(e){return h(L+e+"/")}(this.$route.params.id).then(function(t){e.projectInfo=t})}},mounted:function(){this.gettagcount(),this.getProjectDetail(),this.getreporttail()}},z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ul",{staticClass:"title-project"},[a("li",{staticClass:"title-li",attrs:{title:"Test API Project"}},[a("b",[e._v(e._s(e.projectInfo.name))]),e._v(" "),a("b",{staticClass:"desc-li"},[e._v(e._s(e.projectInfo.desc))])])]),e._v(" "),a("ul",{staticClass:"project_detail"},[a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.api_count)+" 个接口")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("接口总数")])]),e._v(" "),a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.case_count)+" 个用例")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("用例集总数")])]),e._v(" "),a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.config_count)+" 套配置")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("配置总数")])]),e._v(" "),a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.variables_count)+" 对变量")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("全局变量对数")])])]),e._v(" "),a("ul",{staticClass:"project_detail"},[a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.host_count)+" 套环境")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("环境总数")])]),e._v(" "),a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.task_count)+" 项任务")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("定时任务个数")])]),e._v(" "),a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.report_count)+" 个报告")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("测试报告总数")])]),e._v(" "),a("li",{staticClass:"pull-left"},[a("p",{staticClass:"title-p"},[a("i",{staticClass:"iconfont"},[e._v("")]),e._v("  "+e._s(e.projectInfo.uitestplan)+" 个UI测试计划")]),e._v(" "),a("p",{staticClass:"desc-p"},[e._v("UI测试计划总数")])])]),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{display:"table",height:"400px",width:"1000px","margin-top":"30px"}},[t("div",{attrs:{id:"casetable"}}),this._v(" "),t("div",{attrs:{id:"runcasetable"}})])}]};var U=a("VU/8")(q,z,!1,function(e){a("mEqO")},"data-v-aa4507a6",null).exports,M=function(e,t,a){return p()({url:"/api/testrunner/pycode/"+e+"/",method:"PATCH",params:t,data:a})},O={props:{id:{require:!0},save:Boolean,run:Boolean},watch:{save:function(){this.handleConfirm()},run:function(){this.handleRunCode()}},data:function(){return{codeHeight:500,requestData:{code:"",id:"",project:this.$route.params.id},resp:{msg:""}}},name:"PycodeDebug",methods:{handleRunCode:function(){var e,t,a=this;this.resp.msg="",(e=this.requestData.id,t={params:{project:this.$route.params.id}},p.a.get("/api/testrunner/runpycode/"+e+"/",t)).then(function(e){a.resp=e.data})},handleConfirm:function(){var e=this;M(this.id,{project:this.$route.params.id},this.requestData).then(function(t){e.$notify.success("代码保存成功"),e.getPycode()})},editorInit:function(){a("R3yc"),a("2qnb"),a("eKfU"),a("SOV9")},getPycode:function(){var e,t,a=this;(e=this.id,t={params:{project:this.$route.params.id}},p.a.get("/api/testrunner/pycode/"+e+"/",t)).then(function(e){a.requestData=e.data})}},components:{editor:a("o4sT")},mounted:function(){this.$nextTick(function(){this.getPycode(),this.codeHeight=window.screen.height-284})}},H={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-main",{staticStyle:{height:"600px"}},[a("editor",{attrs:{lang:"python",theme:"monokai",options:{enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0}},on:{init:e.editorInit},model:{value:e.requestData.code,callback:function(t){e.$set(e.requestData,"code",t)},expression:"requestData.code"}})],1),e._v(" "),a("el-footer",{staticStyle:{height:"50px"}},[a("editor",{attrs:{lang:"text",theme:"monokai",height:e.codeHeight},model:{value:e.resp.msg,callback:function(t){e.$set(e.resp,"msg",t)},expression:"resp.msg"}})],1)],1)},staticRenderFns:[]};var G={components:{PycodeDebug:a("VU/8")(O,H,!1,function(e){a("ithZ")},"data-v-2f3cfcc9",null).exports},data:function(){return{permissions:[],back:!1,del:!1,save:!1,run:!1,PycodedebugActivate:!1,respConfig:"",dialogVisible:!1,editVisible:!1,pycodefileForm:{name:"",desc:"",create_user:this.$store.state.useractualname,project:this.$route.params.id,id:""},search:"",pycodeData:{count:0,results:[]},currentRow:"",currentPage:1,selectTestData:[],rules:{name:[{required:!0,message:"请输入文件全称",trigger:"blur"},{min:1,max:30,message:"最多不超过30个字符",trigger:"blur"}],desc:[{required:!1,message:"简要描述下该文件",trigger:"blur"},{min:0,max:100,message:"最多不超过100个字符",trigger:"blur"}]},pycodeid:"",loading:!0}},methods:{quitEditPycode:function(){var e=this;this.$confirm("请确认是否已保存最新代码，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.PycodedebugActivate=!1})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"pycode"}).then(function(t){e.permissions=t.permissions})},handleSelectionChange:function(e){this.selectTestData=e},handleEditPycode:function(e){this.PycodedebugActivate=!0,this.pycodeid=e},handlecancle:function(){this.editVisible=!1,this.pycodefileForm.name="",this.pycodefileForm.desc="",this.pycodefileForm.id=""},handleDelPycode:function(e){var t=this;this.$confirm("此操作将永久删除该测试文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a,s;(a=e,s={params:{project:t.$route.params.id}},p.a.delete("/api/testrunner/pycode/"+a+"/",s)).then(function(e){e.data.success?t.$notify.success(e.data.msg):t.$notify.error(e.data.msg),t.PycodeList(),t.currentPage=1})})},delSelectionPycodefile:function(){var e=this;0!==this.selectTestData.length?this.$confirm("此操作将永久删除勾选的文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t,a;(t=e.selectTestData,a={project:e.$route.params.id},p.a.delete("/api/testrunner/pycode/",{data:t,params:a})).then(function(t){e.$notify.success("删除成功"),e.PycodeList()})}):this.$notify.warning({message:"请至少勾选一个文件"})},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.pycodefileForm.project,search:this.search}},p.a.get("/api/testrunner/pycode/",t)).then(function(e){a.pycodeData=e.data})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return""!==t.pycodefileForm.id?t.editVisible=!0:t.dialogVisible=!0,!1;t.dialogVisible=!1,t.editVisible=!1;var a,s,n=void 0;""===t.pycodefileForm.id?(a=t.pycodefileForm,s={project:t.$route.params.id},n=p()({url:"/api/testrunner/pycode/",method:"POST",data:a,params:s})):n=M(t.pycodefileForm.id,{project:t.$route.params.id},t.pycodefileForm),n.then(function(e){t.pycodefileForm.id,e.data.success?(t.$notify.success(e.data.msg),t.currentPage=1):t.$notify.error(e.data.msg),t.PycodeList(),t.pycodefileForm.name="",t.pycodefileForm.desc="",t.pycodefileForm.id=""})})},handleEditPycodeData:function(e,t){this.editVisible=!0,this.pycodefileForm.name=t.name,this.pycodefileForm.desc=t.desc,this.pycodefileForm.id=t.id},PycodeList:function(){var e,t=this;(e={params:{project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/pycode/",e)).then(function(e){t.pycodeData=e.data,t.loading=!1})}},name:"RecordPycode",mounted:function(){this.$nextTick(function(){this.PycodeList()}),this.getpermissions()}},K={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{disabled:e.PycodedebugActivate,type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新增文件\n                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{disabled:e.PycodedebugActivate,type:"danger",icon:"el-icon-delete",size:"mini",title:"批量删除"},on:{click:e.delSelectionPycodefile}},[e._v("批量删除")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.PycodedebugActivate,expression:"PycodedebugActivate"}],attrs:{type:"primary",size:"mini",icon:"el-icon-lock",round:""},on:{click:function(t){e.save=!e.save}}},[e._v("保存\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.PycodedebugActivate,expression:"PycodedebugActivate"}],attrs:{icon:"el-icon-caret-right",type:"success",size:"mini",round:""},on:{click:function(t){e.run=!e.run}}},[e._v("运行\n                ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"添加文件",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"pycodefileForm",staticClass:"project",attrs:{model:e.pycodefileForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[a("el-input",{attrs:{clearable:""},model:{value:e.pycodefileForm.name,callback:function(t){e.$set(e.pycodefileForm,"name",t)},expression:"pycodefileForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件描述",prop:"desc"}},[a("el-input",{attrs:{clearable:""},model:{value:e.pycodefileForm.desc,callback:function(t){e.$set(e.pycodefileForm,"desc",t)},expression:"pycodefileForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("pycodefileForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑文件信息",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"pycodefileForm",staticClass:"project",attrs:{model:e.pycodefileForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"修改名称",prop:"name"}},[a("el-input",{attrs:{clearable:""},model:{value:e.pycodefileForm.name,callback:function(t){e.$set(e.pycodefileForm,"name",t)},expression:"pycodefileForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"修改描述",prop:"desc"}},[a("el-input",{attrs:{clearable:""},model:{value:e.pycodefileForm.desc,callback:function(t){e.$set(e.pycodefileForm,"desc",t)},expression:"pycodefileForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handlecancle}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("pycodefileForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:!e.PycodedebugActivate,type:"text"},on:{click:e.quitEditPycode}},[e._v("返回列表")])],1)])]),e._v(" "),a("el-container",[e.PycodedebugActivate?a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[a("PycodeDebug",{attrs:{id:e.pycodeid,save:e.save,run:e.run}})],1):e._e()],1),e._v(" "),a("el-container",{directives:[{name:"show",rawName:"v-show",value:!e.PycodedebugActivate,expression:"!PycodedebugActivate"}]},[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"30px",overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入变量名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.PycodeList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"230px",top:"150px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},"element-loading-text":"正在玩命加载","highlight-current-row":"",data:e.pycodeData.results,"show-header":0!==e.pycodeData.results.length,stripe:"",height:"600px"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"文件名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"简要描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"260",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.pycodeData.count&&"debugtalk.py"!==t.row.name&&e.permissions.includes("change"),expression:"pycodeData.count !== 0 && scope.row.name !== 'debugtalk.py' && permissions.includes('change')"}],attrs:{type:"info",size:"mini",title:"编辑基本信息"},on:{click:function(a){return e.handleEditPycodeData(t.$index,t.row)}}},[e._v("编辑\n                                    ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.pycodeData.count&&e.permissions.includes("change"),expression:"pycodeData.count !== 0 && permissions.includes('change')"}],attrs:{type:"success",size:"mini",title:"编辑脚本内容"},on:{click:function(a){return e.handleEditPycode(t.row.id)}}},[e._v("脚本\n                                    ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.pycodeData.count&&"debugtalk.py"!==t.row.name&&e.permissions.includes("delete"),expression:"pycodeData.count !== 0 && scope.row.name !== 'debugtalk.py' && permissions.includes('delete')"}],attrs:{type:"danger",size:"mini",title:"删除"},on:{click:function(a){return e.handleDelPycode(t.row.id)}}},[e._v("\n                                    删除\n                                    ")])],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.pycodeData.count,expression:"pycodeData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.pycodeData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var J=a("VU/8")(G,K,!1,function(e){a("vrYQ")},"data-v-21dcc542",null).exports,Z=a("BO1k"),Q=a.n(Z),W={props:{save:Boolean,header:{require:!1}},methods:{querySearch:function(e,t){var a=this.headerOptions;t(e?a.filter(this.createFilter(e)):a)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){this.tableData.push({key:"",value:"",desc:""})},handleDelete:function(e,t){this.tableData.splice(e,1)},parseHeader:function(){var e={header:{},desc:{}},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.tableData);!(t=(n=r.next()).done);t=!0){var i=n.value;""!==i.key&&""!==i.value&&(e.header[i.key]=i.value,e.desc[i.key]=i.desc)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e}},watch:{save:function(){this.$emit("header",this.parseHeader(),this.tableData)},header:function(){0!==this.header.length&&(this.tableData=this.header)}},computed:{height:function(){return window.screen.height-440}},data:function(){return{headerOptions:[{value:"Accept"},{value:"Accept-Charset"},{value:"Accept-Language"},{value:"Accept-Datetime"},{value:"Authorization"},{value:"Cache-Control"},{value:"Connection"},{value:"Cookie"},{value:"Content-Length"},{value:"Content-MD5"},{value:"Content-Type"},{value:"Expect"},{value:"Date"},{value:"From"},{value:"Host"},{value:"If-Match"},{value:"If-Modified-Since"},{value:"If-None-Match"},{value:"If-Range"},{value:"If-Unmodified-Since"},{value:"Max-Forwards"},{value:"Origin"},{value:"Pragma"},{value:"Proxy-Authorization"},{value:"Range"},{value:"Referer"},{value:"TE"},{value:"User-Agent"},{value:"Upgrade"},{value:"Via"},{value:"Warning"}],currentRow:"",tableData:[{key:"",value:"",desc:""}]}},name:"Header"},X={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:e.tableData,height:e.height,border:!1,"cell-style":{paddingTop:"4px",paddingBottom:"4px"}},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"标签",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-autocomplete",{attrs:{clearable:"","fetch-suggestions":e.querySearch,placeholder:"头部标签"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"内容",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"头部内容"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"头部信息简要描述"},model:{value:t.row.desc,callback:function(a){e.$set(t.row,"desc",a)},expression:"scope.row.desc"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var Y=a("VU/8")(W,X,!1,function(e){a("NI1z")},"data-v-7646cb79",null).exports,ee=function(e){return config.baseurl+"/api/testrunner/file/"},te=function(e){return p.a.post("/api/testrunner/download/",e,{responseType:"blob"})},ae=function(e){return p.a.get("/api/testrunner/file/",e).then(function(e){return e.data})},se=function(e){return p.a.post("/api/testrunner/exportVariables/",e,{responseType:"blob"})},ne=function(e){return config.baseurl+"/api/testrunner/importvariables/"},re={props:{save:Boolean,request:{require:!1}},computed:{height:function(){return window.screen.height-464}},name:"Request",components:{editor:a("o4sT")},watch:{save:function(){this.$emit("request",{form:this.parseForm(),json:this.parseJson(),params:this.parseParams(),files:this.parseFile()},{data:this.formData,params:this.paramsData,json_data:this.jsonData})},request:function(){0!==this.request.length&&(this.formData=this.request.data,this.jsonData=this.request.json_data,this.paramsData=this.request.params)}},methods:{editorInit:function(){a("R3yc"),a("NbQv"),a("hzkg"),a("5WxL")},uploadSuccess:function(e,t,a){var s=t.size;s=s>=1048576?(s/1048576).toFixed(2).toString()+"MB":s>=1024?(s/1024).toFixed(2).toString()+"KB":s.toString()+"Byte",this.formData[this.currentIndex].value=t.name,this.formData[this.currentIndex].size=s,this.fileList=[],e.success||this.$message.error(t.name)},uploadFile:function(e){return ee()},UploadBefore:function(e){this.filedata.name=e.name},uploadError:function(e){401===e.status?this.$router.replace({name:"Login"}):this.$message.error("Sorry，文件上传失败啦, 请重试！")},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){("data"===this.dataType?this.formData:this.paramsData).push({key:"",value:"",type:1,desc:""})},handleDelete:function(e,t){("data"===this.dataType?this.formData:this.paramsData).splice(e,1)},parseFile:function(){var e={files:{},desc:{}},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.formData);!(t=(n=r.next()).done);t=!0){var i=n.value;""!==i.key&&5===i.type&&(e.files[i.key]=i.value,e.desc[i.key]=i.desc)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e},parseForm:function(){var e={data:{},desc:{}},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.formData);!(t=(n=r.next()).done);t=!0){var i=n.value;if(""!==i.key&&5!==i.type){var o=this.parseType(i.type,i.value);if("exception"===o)continue;e.data[i.key]=o,e.desc[i.key]=i.desc}}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e},parseParams:function(){var e={params:{},desc:{}},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.paramsData);!(t=(n=r.next()).done);t=!0){var i=n.value;""!==i.key&&(e.params[i.key]=i.value,e.desc[i.key]=i.desc)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e},parseJson:function(){var e={};if(""!==this.jsonData)try{e=JSON.parse(this.jsonData)}catch(e){this.$notify.error({title:"json错误",message:"不是标准的json数据格式",duration:2e3})}return e},parseType:function(e,t){var a=void 0,s=t+" => "+this.dataTypeOptions[e-1].label+" 转换异常, 该数据自动剔除";switch(e){case 1:a=t;break;case 2:a=parseInt(t);break;case 3:a=parseFloat(t);break;case 4:if("False"!==t&&"True"!==t)return this.$notify.error({title:"类型转换错误",message:s,duration:2e3}),"exception";a={True:!0,False:!1}[t]}return 0===a||a||4===e||1===e?a:(this.$notify.error({title:"类型转换错误",message:s,duration:2e3}),"exception")}},data:function(){return{fileList:[],uploadheader:{Authorization:this.$store.state.token},currentIndex:0,currentRow:"",jsonData:"",formData:[{key:"",value:"",type:1,desc:""}],paramsData:[{key:"",value:"",type:"",desc:""}],filedata:{project:this.$route.params.id,name:"",relation:1},dataTypeOptions:[{label:"String",value:1},{label:"Integer",value:2},{label:"Float",value:3},{label:"Boolean",value:4},{label:"File",value:5}],dataOptions:[{label:"data",value:"表单"},{label:"json",value:"json"},{label:"params",value:"params"}],dataType:"json"}}},ie={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"margin-left":"200px"}},[a("el-radio-group",{model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}},e._l(e.dataOptions,function(t){return a("el-radio",{key:t.value,attrs:{label:t.label}},[e._v(e._s(t.value)+"\n            ")])}),1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"5px"}},[a("el-table",{directives:[{name:"show",rawName:"v-show",value:"json"!==e.dataType,expression:"dataType !== 'json' "}],staticStyle:{width:"100%"},attrs:{"highlight-current-row":"","cell-style":{paddingTop:"4px",paddingBottom:"4px"},strpe:"",height:e.height,data:"data"===e.dataType?e.formData:e.paramsData},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"请求Key",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"Key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),"data"===e.dataType?a("el-table-column",{attrs:{label:"类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",a)},expression:"scope.row.type"}},e._l(e.dataTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}],null,!1,2747676114)}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"请求Value",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"show",rawName:"v-show",value:5!==t.row.type,expression:"scope.row.type !== 5"}],attrs:{clearable:"",placeholder:"Value"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}}),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:5===t.row.type,expression:"scope.row.type === 5"}]},[a("el-col",{attrs:{span:7}},[a("el-upload",{attrs:{"show-file-list":!1,data:e.filedata,"before-upload":e.UploadBefore,action:e.uploadFile(t.row),limit:1,type:"small",headers:e.uploadheader,"file-list":e.fileList,"on-error":e.uploadError,"on-success":e.uploadSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.currentIndex=t.$index}}},[e._v("选择文件\n                                ")])],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-badge",{staticStyle:{"margin-top":"8px"},attrs:{value:t.row.size}},[a("i",{staticClass:"el-icon-document",domProps:{textContent:e._s(t.row.value)}})])],1)],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"参数简要描述"},model:{value:t.row.desc,callback:function(a){e.$set(t.row,"desc",a)},expression:"scope.row.desc"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1),e._v(" "),a("editor",{directives:[{name:"show",rawName:"v-show",value:"json"===e.dataType,expression:"dataType === 'json' "}],attrs:{lang:"json",theme:"github",width:"100%",height:e.height},on:{init:e.editorInit},model:{value:e.jsonData,callback:function(t){e.jsonData=t},expression:"jsonData"}})],1)])},staticRenderFns:[]};var oe=a("VU/8")(re,ie,!1,function(e){a("ksBu")},"data-v-2df84c20",null).exports,le={props:{save:Boolean,extract:{require:!1}},computed:{height:function(){return window.screen.height-440}},watch:{save:function(){this.$emit("extract",this.parseExtract(),this.tableData)},extract:function(){0!==this.extract.length&&(this.tableData=this.extract)}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){this.tableData.push({key:"",value:"",desc:""})},handleDelete:function(e,t){this.tableData.splice(e,1)},parseExtract:function(){var e={extract:[],desc:{}},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.tableData);!(t=(n=r.next()).done);t=!0){var i=n.value,o=i.key,l=i.value;if(""!==o&&""!==l){var c={};c[o]=l,e.extract.push(c),e.desc[o]=i.desc}}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e}},data:function(){return{currentRow:"",tableData:[{key:"",value:"",desc:""}]}},name:"Extract"},ce={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",strpe:"",height:e.height,data:e.tableData,"cell-style":{paddingTop:"4px",paddingBottom:"4px"}},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"变量名",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"接收抽取值后的变量名"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"抽取表达式",width:"420"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"抽取表达式"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"抽取值简要描述"},model:{value:t.row.desc,callback:function(a){e.$set(t.row,"desc",a)},expression:"scope.row.desc"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var ue=a("VU/8")(le,ce,!1,function(e){a("bRCp")},"data-v-d66549f6",null).exports,de={props:{save:Boolean,validate:{require:!1}},computed:{height:function(){return window.screen.height-440}},watch:{save:function(){this.$emit("validate",this.parseValidate(),this.tableData)},validate:function(){0!==this.validate.length&&(this.tableData=this.validate)}},methods:{querySearch:function(e,t){var a=this.validateOptions;t(e?a.filter(this.createFilter(e)):a)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){this.tableData.push({expect:"",actual:"",comparator:"equals",type:1})},handleDelete:function(e,t){this.tableData.splice(e,1)},parseType:function(e,t){var a=void 0,s=t+" => "+this.dataTypeOptions[e-1].label+" 转换异常, 该数据自动剔除";switch(e){case 1:a=t;break;case 2:a=parseInt(t);break;case 3:a=parseFloat(t);break;case 4:if("False"!==t&&"True"!==t)return this.$notify.error({title:"类型转换错误",message:s,duration:2e3}),"exception";a={True:!0,False:!1}[t];break;case 5:case 6:try{a=JSON.parse(t)}catch(e){a=!1}}return 0===a||a||4===e||1===e?a:(this.$notify.error({title:"类型转换错误",message:s,duration:2e3}),"exception")},parseValidate:function(){var e={validate:[]},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.tableData);!(t=(n=r.next()).done);t=!0){var i=n.value;if(""!==i.actual){var o={},l=this.parseType(i.type,i.expect);if("exception"===l)continue;o[i.comparator]=[i.actual,l],e.validate.push(o)}}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e}},data:function(){return{currentValidate:"",currentRow:"",tableData:[{expect:"",actual:"",comparator:"equals",type:1}],dataTypeOptions:[{label:"String",value:1},{label:"Integer",value:2},{label:"Float",value:3},{label:"Boolean",value:4},{label:"List",value:5},{label:"Dict",value:6}],validateOptions:[{value:"equals"},{value:"less_than"},{value:"less_than_or_equals"},{value:"greater_than"},{value:"greater_than_or_equals"},{value:"not_equals"},{value:"string_equals"},{value:"length_equals"},{value:"length_greater_than"},{value:"length_greater_than_or_equals"},{value:"length_less_than"},{value:"length_less_than_or_equals"},{value:"contains"},{value:"contained_by"},{value:"type_match"},{value:"regex_match"},{value:"startswith"},{value:"endswith"}]}},name:"Validate"},pe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"","cell-style":{paddingTop:"4px",paddingBottom:"4px"},strpe:"",height:e.height,data:e.tableData},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"断言类型",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",content:t.row.comparator,placement:"bottom",disabled:""===t.row.comparator&&"disabled"}},[a("el-autocomplete",{attrs:{clearable:"","fetch-suggestions":e.querySearch,placeholder:"请输入断言类型"},model:{value:t.row.comparator,callback:function(a){e.$set(t.row,"comparator",a)},expression:"scope.row.comparator"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"",label:"实际返回值",width:"370"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"实际返回值"},model:{value:t.row.actual,callback:function(a){e.$set(t.row,"actual",a)},expression:"scope.row.actual"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"期望类型",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",a)},expression:"scope.row.type"}},e._l(e.dataTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"期望返回值",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",rows:1,clearable:"",placeholder:"期望返回值"},model:{value:t.row.expect,callback:function(a){e.$set(t.row,"expect",a)},expression:"scope.row.expect"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var me=a("VU/8")(de,pe,!1,function(e){a("W0BZ")},"data-v-238416d0",null).exports,he={name:"Variables",props:{save:Boolean,variables:{require:!1}},computed:{height:function(){return window.screen.height-440}},watch:{save:function(){this.$emit("variables",this.parseVariables(),this.tableData)},variables:function(){0!==this.variables.length&&(this.tableData=this.variables)}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){this.tableData.push({key:"",value:"",type:1,desc:""})},handleDelete:function(e,t){this.tableData.splice(e,1)},parseType:function(e,t){var a=void 0,s=t+" => "+this.dataTypeOptions[e-1].label+" 转换异常, 该数据自动剔除";switch(e){case 1:a=t;break;case 2:a=parseInt(t);break;case 3:a=parseFloat(t);break;case 4:if("True"!==t&&"False"!==t)return this.$notify.error({title:"类型转换错误",message:s,duration:2e3}),"exception";a={True:!0,False:!1}[t];break;case 5:case 6:try{a=JSON.parse(t)}catch(e){a=!1}}return 0===a||a||4===e||1===e?a:(this.$notify.error({title:"类型转换错误",message:s,duration:2e3}),"exception")},parseVariables:function(){var e={variables:[],desc:{}},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.tableData);!(t=(n=r.next()).done);t=!0){var i=n.value;if(""!==i.key){var o={},l=this.parseType(i.type,i.value);if("exception"===l)continue;o[i.key]=l,e.variables.push(o),e.desc[i.key]=i.desc}}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e}},data:function(){return{currentRow:"",tableData:[{key:"",value:"",type:1,desc:""}],dataTypeOptions:[{label:"String",value:1},{label:"Integer",value:2},{label:"Float",value:3},{label:"Boolean",value:4},{label:"List",value:5},{label:"Dict",value:6}],dataType:"data"}}},fe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"","cell-style":{paddingTop:"4px",paddingBottom:"4px"},strpe:"",height:e.height,data:e.tableData},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"变量名",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"Key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",a)},expression:"scope.row.type"}},e._l(e.dataTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"变量值",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",rows:1,clearable:"",placeholder:"Value"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"内容",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"变量简要描述"},model:{value:t.row.desc,callback:function(a){e.$set(t.row,"desc",a)},expression:"scope.row.desc"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var ve=a("VU/8")(he,fe,!1,function(e){a("UD7K")},"data-v-05d88a45",null).exports,ge={props:{save:Boolean,hooks:{require:!1}},computed:{height:function(){return window.screen.height-440}},watch:{save:function(){this.$emit("hooks",this.parse_hooks(),this.tableData)},hooks:function(){0!==this.hooks.length&&(this.tableData=this.hooks)}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t,a){this.tableData.push({setup:"",teardown:""})},handleDelete:function(e,t){this.tableData.splice(e,1)},parse_hooks:function(){var e={setup_hooks:[],teardown_hooks:[]},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.tableData);!(t=(n=r.next()).done);t=!0){var i=n.value;""!==i.setup&&e.setup_hooks.push(i.setup),""!==i.teardown&&e.teardown_hooks.push(i.teardown)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e}},data:function(){return{currentRow:"",tableData:[{setup:"",teardown:""}]}},name:"Hooks"},be={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"","cell-style":{paddingTop:"4px",paddingBottom:"4px"},strpe:"",height:e.height,data:e.tableData},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"测试之前执行的方法",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"${ setup_hooks function($request, *args, **kwargs) }"},model:{value:t.row.setup,callback:function(a){e.$set(t.row,"setup",a)},expression:"scope.row.setup"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"测试之后执行的方法",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"${ teardown_hooks function(response, *args, **kwargs) }"},model:{value:t.row.teardown,callback:function(a){e.$set(t.row,"teardown",a)},expression:"scope.row.teardown"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var _e=a("VU/8")(ge,be,!1,function(e){a("qpjN")},"data-v-a01c28fe",null).exports,ye=function(e,t){return p.a.get("/api/testrunner/databaseconfig/"+e+"/",t).then(function(e){return e.data})},we={name:"sqlVariables",props:{save:Boolean,sqlVariables:{require:!1}},computed:{height:function(){return window.screen.height-440}},watch:{save:function(){this.$emit("sqlVariables",this.parsesqlVariables(),this.tableData)},sqlVariables:function(){0!==this.sqlVariables.length&&(this.tableData=this.sqlVariables)}},mounted:function(){this.getDataBaseList()},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){this.tableData.push({key:"",database:"",databasetype:"",query:{params1:"",params2:"",params3:"",params4:""},desc:""})},clearrowtype:function(e){e.databasetype=""},changedatabasetype:function(e){var t;t=this.dataBaseDataOptions.find(function(t){return t.id==e.database}),e.databasetype=t.type},parsesqlVariables:function(){return this.tableData},handleDelete:function(e,t){this.tableData.splice(e,1)},getDataBaseList:function(){var e=this;ye(this.$route.params.id).then(function(t){e.dataBaseDataOptions=t.results})}},data:function(){return{currentRow:"",tableData:[{key:"",database:"",databasetype:"",query:{params1:"",params2:"",params3:"",params4:""},desc:""}],dataBaseDataOptions:[],querytypeOptions:[{value:"select",lable:"select"},{value:"update",lable:"update"},{value:"insert",lable:"insert"},{value:"delete",lable:"delete"}],valuetypeoptions:[{value:"str",lable:"str"},{value:"float",lable:"float"},{value:"int",lable:"int"}],dataType:"data"}}},xe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"","cell-style":{paddingTop:"4px",paddingBottom:"4px"},strpe:"",height:e.height,data:e.tableData},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"变量名",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"Key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"数据库",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{clearable:"true"},on:{clear:function(a){return e.clearrowtype(t.row)},change:function(a){return e.changedatabasetype(t.row)}},model:{value:t.row.database,callback:function(a){e.$set(t.row,"database",a)},expression:"scope.row.database"}},e._l(e.dataBaseDataOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"参数一",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.databasetype?a("el-input",{attrs:{type:"textarea",rows:1,clearable:"",placeholder:"请输入MDX语句"},model:{value:t.row.query.params1,callback:function(a){e.$set(t.row.query,"params1",a)},expression:"scope.row.query.params1"}}):e._e(),e._v(" "),2==t.row.databasetype?a("el-select",{attrs:{placeholder:"请选择操作类型"},model:{value:t.row.query.params1,callback:function(a){e.$set(t.row.query,"params1",a)},expression:"scope.row.query.params1"}},e._l(e.querytypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"参数二",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.databasetype?a("el-input",{attrs:{type:"textarea",rows:1,clearable:"",placeholder:'精度处理：{"ride":100,"expect":1000,"around":0}'},model:{value:t.row.query.params2,callback:function(a){e.$set(t.row.query,"params2",a)},expression:"scope.row.query.params2"}}):e._e(),e._v(" "),2==t.row.databasetype?a("el-input",{attrs:{type:"textarea",rows:1,clearable:"",placeholder:"请输入sql语句"},model:{value:t.row.query.params2,callback:function(a){e.$set(t.row.query,"params2",a)},expression:"scope.row.query.params2"}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"参数三",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.databasetype?a("el-select",{attrs:{placeholder:"请选择返回数值类型"},model:{value:t.row.query.params3,callback:function(a){e.$set(t.row.query,"params3",a)},expression:"scope.row.query.params3"}},e._l(e.valuetypeoptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e(),e._v(" "),2==t.row.databasetype?a("el-input",{attrs:{type:"textarea",rows:1,clearable:"",placeholder:"请输入需要返回字段，未必填"},model:{value:t.row.query.params3,callback:function(a){e.$set(t.row.query,"params3",a)},expression:"scope.row.query.params3"}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"参数四",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.databasetype?a("el-input",{attrs:{type:"textarea",rows:1,clearable:"",placeholder:"请输入字典key列表,[key1,key2]"},model:{value:t.row.query.params4,callback:function(a){e.$set(t.row.query,"params4",a)},expression:"scope.row.query.params4"}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"内容",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"变量简要描述"},model:{value:t.row.desc,callback:function(a){e.$set(t.row,"desc",a)},expression:"scope.row.desc"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var ke=a("VU/8")(we,xe,!1,function(e){a("BwKJ")},"data-v-595b77b3",null).exports,Ce={name:"DebugReport",methods:{handleRequest:function(e){["start_timestamp"].forEach(function(t){delete e[t]});try{e.body=JSON.parse(e.body)}catch(e){}return e},handleContent:function(e){try{e=JSON.parse(e)}catch(e){}return e},handleResponse:function(e){return["response_time_ms","encoding","ok","reason","url","text","json","content_size","content_type"].forEach(function(t){delete e[t]}),e}},props:{summary:{require:!0}}},Se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"overflow-y":"scroll",height:"800px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:[e.summary],size:"medium",border:"",stripe:"","header-cell-style":{textAlign:"center",background:"#F8F8FA"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"测试时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("timestampToTime")(t.row.time.start_at)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"持续时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{textContent:e._s(t.row.time.duration.toFixed(3)+" 秒")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Total",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(t.row.stat.testsRun))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Success",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.stat.successes))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Failed",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(t.row.stat.failures))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Error",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.row.stat.errors))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Skipped",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.row.stat.skipped))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Platform"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("HttpRunner: "+e._s(t.row.platform.httprunner_version))]),e._v(" "),a("p",[e._v("Python: "+e._s(t.row.platform.python_version))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.platform.platform))])],1)])]}}])})],1),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),e._l(e.summary.details,function(t){return e._t("default",function(){return[a("div",[a("span",{staticStyle:{"font-weight":"bold","font-size":"medium"}},[e._v(e._s(t.name))]),e._v(" "),a("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"}},[a("pre",{staticClass:"code-block"},[e._v(e._s(t.in_out))]),e._v(" "),a("el-button",{attrs:{slot:"reference",round:"",type:"text"},slot:"reference"},[e._v("parameters & output")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.records,border:"","header-cell-style":{textAlign:"center",background:"#F8F8FA"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"名 称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"请求地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.meta_data.request.url))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"请求方法"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:t.row.meta_data.request.method},[e._v(e._s(t.row.meta_data.request.method))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"响应时间 (ms)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.meta_data.response.elapsed_ms))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:t.row.status},[e._v(e._s(t.row.status))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tabs",[a("el-tab-pane",{attrs:{label:"请求头"}},[a("pre",{staticClass:"code-block",domProps:{innerHTML:e._s(e.handleRequest(t.row.meta_data.request))}})]),e._v(" "),null!==t.row.meta_data.response.content?a("el-tab-pane",{attrs:{label:"内容"}},[a("pre",{staticClass:"code-block",domProps:{textContent:e._s(e.handleContent(t.row.meta_data.response.content))}})]):e._e(),e._v(" "),a("el-tab-pane",{attrs:{label:"响应结果"}},[a("pre",{staticClass:"code-block",domProps:{textContent:e._s(e.handleResponse(t.row.meta_data.response))}})]),e._v(" "),0!==t.row.meta_data.validators.length?a("el-tab-pane",{attrs:{label:"断言信息"}},[a("pre",{staticClass:"code-block",domProps:{innerHTML:e._s(t.row.meta_data.validators)}})]):e._e(),e._v(" "),""!==t.row.attachment?a("el-tab-pane",{attrs:{label:"异常信息"}},[a("pre",{staticClass:"code-block",domProps:{innerHTML:e._s(t.row.attachment)}})]):e._e()],1)]}}],null,!0)})],1)]})})],2)},staticRenderFns:[]};var Te=a("VU/8")(Ce,Se,!1,function(e){a("VZlN")},"data-v-9ed3d90e",null).exports,Fe=function(e){return p.a.get("/api/testrunner/api/",e).then(function(e){return e.data})},$e=function(e){return p.a.get("/api/testrunner/api/",e).then(function(e){return e.data})},De={components:{Headers:Y,Request:oe,Extract:ue,Validate:me,Variables:ve,Hooks:_e,sqlVariables:ke,Report:Te},props:{host:{require:!1},nodeId:{require:!1},project:{require:!1},config:{require:!1},response:{require:!1}},methods:{reverseStatus:function(){this.save=!this.save,this.run=!0},handleHeader:function(e){this.header=e},handleRequest:function(e){this.request=e},handleValidate:function(e){this.validate=e},handleExtract:function(e){this.extract=e},handleVariables:function(e){this.variables=e},handleHooks:function(e){this.hooks=e},handlesqlVariables:function(e){this.sqlVariables=e,this.run?(this.runAPI(),this.run=!1):""===this.id?this.addAPI():this.updateAPI()},validateData:function(){return""===this.url?(this.$notify.error({title:"url错误",message:"接口请求地址不能为空",duration:1500}),!1):""!==this.name||(this.$notify.error({title:"name错误",message:"接口名称不能为空",duration:1500}),!1)},updateAPI:function(){var e,t,a=this;this.validateData()&&(e=this.id,t={header:this.header,request:this.request,extract:this.extract,validate:this.validate,variables:this.variables,sqlVariables:this.sqlVariables,hooks:this.hooks,url:this.url,method:this.method,name:this.name,times:this.times},p.a.patch("/api/testrunner/api/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.success?a.$emit("addSuccess"):a.$message.error({message:e.msg,duration:1e3})})},runAPI:function(){var e,t=this;this.validateData()&&(this.loading=!0,(e={header:this.header,request:this.request,extract:this.extract,validate:this.validate,variables:this.variables,hooks:this.hooks,sqlVariables:this.sqlVariables,url:this.url,method:this.method,name:this.name,times:this.times,project:this.project,config:this.config,host:this.host},p.a.post("/api/testrunner/run_api/",e).then(function(e){return e.data})).then(function(e){t.summary=e,t.dialogTableVisible=!0,t.loading=!1}).catch(function(e){t.loading=!1}))},addAPI:function(){var e,t=this;this.validateData()&&(e={header:this.header,request:this.request,extract:this.extract,validate:this.validate,variables:this.variables,hooks:this.hooks,sqlVariables:this.sqlVariables,url:this.url,method:this.method,name:this.name,times:this.times,nodeId:this.nodeId,project:this.project},p.a.post("/api/testrunner/api/",e).then(function(e){return e.data})).then(function(e){e.success?t.$emit("addSuccess"):t.$message.error({message:e.msg,duration:1e3})})}},watch:{response:function(){this.name=this.response.body.name,this.method=this.response.body.method,this.url=this.response.body.url,this.times=this.response.body.times,this.id=this.response.id,this.sqlVariables=this.response.sqlVariables}},data:function(){return{loading:!1,times:1,name:"",url:"",id:"",header:[],request:[],extract:[],validate:[],variables:[],sqlVariables:[],hooks:[],method:"GET",dialogTableVisible:!1,save:!1,run:!1,summary:{},activeTag:"second",httpOptions:[{label:"GET"},{label:"POST"},{label:"PUT"},{label:"DELETE"},{label:"HEAD"},{label:"OPTIONS"},{label:"PATCH"}]}},name:"ApiBody"},Ve={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",[a("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入接口名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[a("template",{slot:"prepend"},[e._v("接口信息录入")]),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:function(t){e.save=!e.save}},slot:"append"},[e._v("保存\n                ")])],2),e._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary",disabled:e.loading},on:{click:e.reverseStatus}},[e._v("发送\n            ")])],1),e._v(" "),a("div",[a("el-input",{staticStyle:{width:"600px","margin-top":"10px"},attrs:{placeholder:"请输入接口请求地址",clearable:""},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}},[a("el-select",{staticStyle:{width:"125px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.method,callback:function(t){e.method=t},expression:"method"}},e._l(e.httpOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})}),1)],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"循环次数",placement:"bottom"}},[a("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:1,max:100},model:{value:e.times,callback:function(t){e.times=t},expression:"times"}})],1)],1)]),e._v(" "),a("div",{staticClass:"request"},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("el-tabs",{staticStyle:{"margin-left":"20px"},model:{value:e.activeTag,callback:function(t){e.activeTag=t},expression:"activeTag"}},[a("el-tab-pane",{attrs:{label:"请求头",name:"first"}},[a("headers",{attrs:{save:e.save,header:e.response?e.response.body.header:[]},on:{header:e.handleHeader}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"请求体",name:"second"}},[a("request",{attrs:{save:e.save,request:e.response?e.response.body.request:[]},on:{request:e.handleRequest}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"提取器",name:"third"}},[a("extract",{attrs:{save:e.save,extract:e.response?e.response.body.extract:[]},on:{extract:e.handleExtract}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"断言",name:"fourth"}},[a("validate",{attrs:{save:e.save,validate:e.response?e.response.body.validate:[]},on:{validate:e.handleValidate}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"变量设置",name:"five"}},[a("variables",{attrs:{save:e.save,variables:e.response?e.response.body.variables:[]},on:{variables:e.handleVariables}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"前后置方法设置",name:"six"}},[a("hooks",{attrs:{save:e.save,hooks:e.response?e.response.body.hooks:[]},on:{hooks:e.handleHooks}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"数据库操作",name:"seven"}},[a("sqlVariables",{attrs:{save:e.save,sqlVariables:e.response?e.response.body.sqlVariables:[]},on:{sqlVariables:e.handlesqlVariables}})],1)],1)],1)])},staticRenderFns:[]};var Pe=a("VU/8")(De,Ve,!1,function(e){a("fn7o")},"data-v-687c737e",null).exports,Ne=function(e,t){return p.a.get("/api/testrunner/tree/"+e+"/",t).then(function(e){return e.data})},Re=function(e,t){return p.a.patch("/api/testrunner/tree/"+e+"/",t).then(function(e){return e.data})},je={components:{Report:Te},name:"ApiList",props:{host:{require:!0},config:{require:!0},run:Boolean,back:Boolean,node:{require:!0},project:{require:!0},permissions:{require:!0},del:Boolean},data:function(){return{checked:!1,search:"",reportName:"",asyncs:!1,filterText:"",loading:!1,expand:"&#xe65f;",dataTree:{},dialogTreeVisible:!1,dialogTableVisible:!1,summary:{},selectAPI:[],currentRow:"",currentPage:1,apiData:{count:0,results:[]},defaultProps:{children:"children",label:"label"}}},watch:{filterText:function(e){this.$refs.tree.filter(e)},run:function(){this.asyncs=!1,this.reportName="",this.getTree()},back:function(){this.getAPIList()},node:function(){this.search="",this.getAPIList()},checked:function(){this.checked?this.toggleAll():this.toggleClear()},del:function(){var e=this;0!==this.selectAPI.length?this.$confirm("此操作将永久删除API，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectAPI},p.a.delete("/api/testrunner/api/",t).then(function(e){return e.data})).then(function(t){e.getAPIList()})}):this.$notify.warning({title:"提示",message:"请至少选择一个接口",duration:1e3})}},methods:{handleCopyAPI:function(e){var t=this;this.$prompt("请输入接口名称","复制接口",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"接口名称不能为空"}).then(function(a){var s,n,r=a.value;(s=e,n={name:r},p.a.post("/api/testrunner/api/"+s+"/",n).then(function(e){return e.data})).then(function(e){t.getAPIList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},runTree:function(){var e=this;this.dialogTreeVisible=!1;var t,a=this.$refs.tree.getCheckedKeys();0===a.length?this.$notify.error({title:"提示",message:"请至少选择一个节点",duration:1500}):(t={host:this.host,project:this.project,relation:a,async:this.asyncs,name:this.reportName,config:this.config},p.a.post("/api/testrunner/run_api_tree/",t).then(function(e){return e.data})).then(function(t){t.hasOwnProperty("status")?e.$message.info({message:t.msg,duration:1500}):(e.summary=t,e.dialogTableVisible=!0)})},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:1}}).then(function(t){e.dataTree=t.tree,e.dialogTreeVisible=!0})},handleSelectionChange:function(e){this.selectAPI=e},toggleAll:function(){this.$refs.multipleTable.toggleAllSelection()},toggleClear:function(){this.$refs.multipleTable.clearSelection()},getAPIList:function(){var e=this;$e({params:{node:this.node,project:this.project,search:this.search}}).then(function(t){e.apiData=t})},exportAPI:function(){var e,t,a=this;(e={page:this.currentPage,node:this.node,project:this.project,search:this.search},p()({url:"/api/testrunner/exportApi/",method:"POST",params:e,data:t,responseType:"blob"})).then(function(e){new Blob([e.data],{type:"application/vnd.ms-excel"});var t=window.URL.createObjectURL(e.data),s=document.createElement("a");s.style.display="none",s.download="API.xls",s.href=t,s.click(),200==e.status?a.$notify.success({message:"导出成功"}):a.$notify.error({message:"导出失败"})})},handleCurrentChange:function(e){var t=this;Fe({params:{page:this.currentPage,node:this.node,project:this.project,search:this.search}}).then(function(e){t.apiData=e})},handleDelApi:function(e){var t=this;this.$confirm("此操作将永久删除该API，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/api/"+a+"/").then(function(e){return e.data})).then(function(e){t.getAPIList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},handleRowClick:function(e){var t,a=this;(t=e.id,p.a.get("/api/testrunner/api/"+t+"/").then(function(e){return e.data})).then(function(e){e.success?a.$emit("api",e):a.$message.error(e.msg)})},handleRunAPI:function(e){var t,a,s=this;this.loading=!0,(t=e,a={params:{host:this.host,config:this.config}},p.a.get("/api/testrunner/run_api_pk/"+t+"/",a).then(function(e){return e.data})).then(function(e){s.summary=e,s.dialogTableVisible=!0,s.loading=!1}).catch(function(e){s.loading=!1})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""}},mounted:function(){this.getAPIList()}},Le={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-left":"10px"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:1}},[e.apiData.count>0?a("el-checkbox",{staticStyle:{"padding-top":"14px","padding-left":"2px"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}):e._e()],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入接口名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getAPIList},slot:"append"})],1)],1),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{size:"smail"},on:{click:e.exportAPI}},[e._v("导出")]):e._e()],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"运行接口",visible:e.dialogTreeVisible,width:"45%"},on:{"update:visible":function(t){e.dialogTreeVisible=t}}},[a("div",[a("div",[a("el-row",{attrs:{gutter:2}},[a("el-col",{attrs:{span:8}},[a("el-switch",{staticStyle:{"margin-top":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"异步执行","inactive-text":"同步执行"},model:{value:e.asyncs,callback:function(t){e.asyncs=t},expression:"asyncs"}})],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.asyncs,expression:"asyncs"}],attrs:{clearable:"",placeholder:"请输入报告名称",disabled:!1},model:{value:e.reportName,callback:function(t){e.reportName=t},expression:"reportName"}})],1)],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-input",{attrs:{placeholder:"输入节点名称进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search",value:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"overflow-y":"scroll",height:"400px"},attrs:{data:e.dataTree,"check-strictly":!1,"filter-node-method":e.filterNode,"show-checkbox":"","check-on-click-node":"","node-key":"id","highlight-current":"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTreeVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.runTree}},[e._v("确 定")])],1)]),e._v(" "),a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"500px",top:"160px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",height:"600px",data:e.apiData.results,"show-header":!0,stripe:""},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"接口类型",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"接口路径","show-overflow-tooltip":"",width:"“300”"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"test_demo_ellipsis"},[e._v(e._s(t.row.url))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"接口名称",width:"“300”","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"test_demo_ellipsis"},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"create_user",label:"创建人",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间","show-overflow-tooltip":"",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"300",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleRowClick(t.row)}}},[a("span",[e._v("编辑")])]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleCopyAPI(t.row.id)}}},[a("span",[e._v("复制")])]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary ",size:"mini"},on:{click:function(a){return e.handleRunAPI(t.row.id)}}},[a("span",[e._v("运行")])]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelApi(t.row.id)}}},[a("span",[e._v("删除")])]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.apiData.count,expression:"apiData.count !== 0 "}],staticStyle:{"margin-top":"25px"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.apiData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ee=function(e){return p.a.get("/api/testrunner/host_ip/"+e+"/").then(function(e){return e.data})},Ie=function(e){return p.a.get("/api/testrunner/config/"+e+"/").then(function(e){return e.data})},Ae=function(e){return p.a.get("/api/testrunner/uiconfig/"+e+"/").then(function(e){return e.data})},Be={watch:{filterText:function(e){this.$refs.tree2.filter(e)}},components:{ApiBody:Pe,ApiList:a("VU/8")(je,Le,!1,function(e){a("8dWQ")},"data-v-763ab2cb",null).exports},computed:{initResponse:{get:function(){return this.addAPIFlag},set:function(e){this.addAPIFlag=e,this.response={id:"",body:{name:"",times:1,url:"",method:"POST",header:[{key:"",value:"",desc:""}],request:{data:[{key:"",value:"",desc:"",type:1}],params:[{key:"",value:"",desc:"",type:1}],json_data:""},validate:[{expect:"",actual:"",comparator:"equals",type:1}],variables:[{key:"",value:"",desc:"",type:1}],extract:[{key:"",value:"",desc:""}],hooks:[{setup:"",teardown:""}],sqlVariables:[{key:"",database:"",databasetype:"",query:{params1:"",params2:"",params3:"",params4:""},desc:""}]}}}}},data:function(){return{loading:!1,configOptions:[],hostOptions:[],permissions:[],currentConfig:"请选择",currentHost:"请选择",back:!1,del:!1,run:!1,response:"",apiForm:{swaggerurl:"",token:""},nodeForm:{name:""},rules:{name:[{required:!0,message:"请输入节点名称",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],swaggerurl:[{required:!0,message:"请输入API地址",trigger:"blur"}],token:[{required:!0,message:"请输入token信息",trigger:"blur"}]},radio:"根节点",addAPIFlag:!1,treeId:"",maxId:"",rmid:"",dialogVisible:!1,tbdialogVisible:!1,currentNode:"",data:"",filterText:"",expand:"&#xe65f;",dataTree:[]}},methods:{quxiao:function(){this.nodeForm.name="",this.dialogVisible=!1},opentb:function(){this.apiForm={swaggerurl:"",token:""},this.tbdialogVisible=!0},handleBackList:function(){this.addAPIFlag=!1,this.back=!this.back},handleDragEnd:function(){this.updateTree(!1)},handleAddSuccess:function(){this.back=!this.back,this.addAPIFlag=!1},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"api"}).then(function(t){e.permissions=t.permissions})},handleAPI:function(e){this.addAPIFlag=!0,this.response=e},synchronizationAPIConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$confirm("此操作将覆盖所有分组和接口, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e,a=n.Loading.service({text:"加载中... 请稍后",background:"rgba(0, 0, 0, 0.8)"});(e={project:t.$route.params.id,swaggerurl:t.apiForm.swaggerurl,token:t.apiForm.token,nodeid:t.currentNode.id},p.a.post("/api/testrunner/synchronization_api/",e)).then(function(e){e.data.success?(t.tbdialogVisible=!1,a.close(),location.reload()):(t.$message.error(e.data.msg),a.close()),a.close()})})})},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:1}}).then(function(t){e.dataTree=t.tree,e.treeId=t.id,e.maxId=t.max})},getConfig:function(){var e=this;Ie(this.$route.params.id).then(function(t){e.configOptions=t.results,e.configOptions.push({name:"请选择"})})},getHost:function(){var e=this;Ee(this.$route.params.id).then(function(t){e.hostOptions=t.results,e.hostOptions.push({name:"请选择"})})},updateTree:function(e){var t=this;Re(this.treeId,{body:this.dataTree,node:this.currentNode.id,mode:e,type:1}).then(function(e){e.success?(t.dataTree=e.tree,t.maxId=e.max):t.$message.error(e.msg)})},deleteNode:function(){var e=this;this.$confirm("此操作将永久删除该节点下所有接口, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){""===e.currentNode?e.$message.info("请选择一个节点"):0!==e.currentNode.children.length?e.$message.warning("此节点有子节点，不可删除！"):(e.remove(e.currentNode,e.data),e.updateTree(!0))})},renameNode:function(){var e=this;this.$prompt("请输入节点名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"节点名称不能为空"}).then(function(t){var a=t.value,s=e.data.parent,n=s.data.children||s.data;n[n.findIndex(function(t){return t.id===e.currentNode.id})].label=a,e.updateTree(!1)})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.append(t.currentNode),t.updateTree(!1),t.nodeForm.name="",t.dialogVisible=!1)})},handleNodeClick:function(e,t){this.addAPIFlag=!1,this.currentNode=e,this.data=t},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},remove:function(e,t){var a=t.parent,s=a.data.children||a.data,n=s.findIndex(function(t){return t.id===e.id});s.splice(n,1)},append:function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var a={id:t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),label:this.nodeForm.name,children:[]};""!==e&&0!==this.dataTree.length&&"根节点"!==this.radio?(e.children||this.$set(e,"children",[]),e.children.push(a)):this.dataTree.push(a)}},name:"RecordApi",mounted:function(){this.getTree(),this.getConfig(),this.getHost(),this.getpermissions()}},qe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n                    新建分组\n                ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"新建分组",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"nodeForm",staticClass:"project",attrs:{model:e.nodeForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"节点名称",prop:"name"}},[a("el-input",{model:{value:e.nodeForm.name,callback:function(t){e.$set(e.nodeForm,"name",t)},expression:"nodeForm.name"}})],1)],1),e._v(" "),a("el-radio-group",{attrs:{size:"small"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"根节点"}}),e._v(" "),a("el-radio-button",{attrs:{label:"子节点"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.quxiao()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("nodeForm")}}},[e._v("确 定")])],1)],1),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"danger",size:"small",icon:"el-icon-delete"},on:{click:e.deleteNode}},[e._v("删除分组\n                ")]):e._e(),e._v(" "),e.permissions.includes("change")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"info",size:"small",icon:"el-icon-edit-outline"},on:{click:e.renameNode}},[e._v("重命名\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.initResponse=!0}}},[e._v("添加接口\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.opentb()}}},[e._v("同步接口\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-dialog",{attrs:{title:"同步swagger-ui接口",visible:e.tbdialogVisible,width:"30%",align:"center",center:""},on:{"update:visible":function(t){e.tbdialogVisible=t}}},[a("el-form",{ref:"apiForm",staticClass:"project",attrs:{model:e.apiForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"API地址",prop:"swaggerurl"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入完整的API接口地址"},model:{value:e.apiForm.swaggerurl,callback:function(t){e.$set(e.apiForm,"swaggerurl",t)},expression:"apiForm.swaggerurl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"cookie",prop:"token"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入接口的token信息"},model:{value:e.apiForm.token,callback:function(t){e.$set(e.apiForm,"token",t)},expression:"apiForm.token"}})],1),e._v(" "),a("p",{staticStyle:{color:"red"}},[e._v("同步接口会覆盖现有的API组织架构及API接口，请谨慎操作！")])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.tbdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.synchronizationAPIConfirm("apiForm")}}},[e._v("同 步")])],1)],1):e._e(),e._v("\n\n\n                 环境:\n                "),a("el-select",{attrs:{placeholder:"请选择",size:"small",tyle:"margin-left: -6px"},model:{value:e.currentHost,callback:function(t){e.currentHost=t},expression:"currentHost"}},e._l(e.hostOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v("\n                 配置:\n                "),a("el-select",{attrs:{placeholder:"请选择",size:"small",tyle:"margin-left: -6px",filterable:""},model:{value:e.currentConfig,callback:function(t){e.currentConfig=t},expression:"currentConfig"}},e._l(e.configOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),!e.addAPIFlag&&e.permissions.includes("add")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.run=!e.run}}},[e._v("运行")]):e._e(),e._v(" "),!e.addAPIFlag&&e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.del=!e.del}}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:!e.addAPIFlag,type:"text"},on:{click:e.handleBackList}},[e._v("返回列表\n                ")])],1)])]),e._v(" "),a("el-container",[a("el-aside",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,draggable:"","highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick,"node-drag-end":e.handleDragEnd},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)])]),e._v(" "),a("el-main",{staticStyle:{padding:"0"}},[a("api-body",{directives:[{name:"show",rawName:"v-show",value:e.addAPIFlag,expression:"addAPIFlag"}],attrs:{nodeId:e.currentNode.id,project:e.$route.params.id,response:e.response,config:e.currentConfig,host:e.currentHost},on:{addSuccess:e.handleAddSuccess}}),e._v(" "),a("api-list",{directives:[{name:"show",rawName:"v-show",value:!e.addAPIFlag,expression:"!addAPIFlag"}],attrs:{permissions:e.permissions,node:""!==e.currentNode?e.currentNode.id:"",project:e.$route.params.id,config:e.currentConfig,host:e.currentHost,del:e.del,back:e.back,run:e.run},on:{api:e.handleAPI}})],1)],1)],1)},staticRenderFns:[]};var ze=a("VU/8")(Be,qe,!1,function(e){a("sfPE")},"data-v-2f54641c",null).exports,Ue=a("mvHQ"),Me=a.n(Ue),Oe=a("w/TU"),He=a.n(Oe),Ge={components:{Headers:Y,Request:oe,Extract:ue,Validate:me,Variables:ve,Hooks:_e,sqlVariables:ke,Report:Te},props:{response:{require:!0},host:{require:!0}},methods:{handleHeader:function(e,t){this.header=t,this.tempBody.header=e},handleRequest:function(e,t){this.request=t,this.tempBody.request=e},handleValidate:function(e,t){this.validate=t,this.tempBody.validate=e},handleExtract:function(e,t){this.extract=t,this.tempBody.extract=e},handleVariables:function(e,t){this.variables=t,this.tempBody.variables=e},handleHooks:function(e,t){this.hooks=t,this.tempBody.hooks=e},handlesqlVariables:function(e,t){if(this.sqlVariables=t,this.tempBody.sqlVariables=e,this.tempBody.url=this.url,this.tempBody.method=this.method,this.tempBody.name=this.name,this.tempBody.times=this.times,this.validateData()){var a={header:this.header,request:this.request,extract:this.extract,validate:this.validate,variables:this.variables,hooks:this.hooks,url:this.url,method:this.method,name:this.name,times:this.times,sqlVariables:this.sqlVariables};this.$emit("getNewBody",a,this.tempBody),this.run=!1}},validateData:function(){return""===this.url?(this.$notify.error({title:"url错误",message:"接口请求地址不能为空",duration:1500}),!1):""!==this.name||(this.$notify.error({title:"name错误",message:"接口名称不能为空",duration:1500}),!1)}},watch:{esc:function(){this.$emit("escEdit")}},data:function(){return{loading:!1,run:!1,esc:!1,times:this.response.body.times,name:this.response.body.name,url:this.response.body.url,header:[],request:[],extract:[],validate:[],variables:[],sqlVariables:[],hooks:[],tempBody:{},method:this.response.body.method,save:!1,summary:{},dialogTableVisible:!1,activeTag:"second",httpOptions:[{label:"GET"},{label:"POST"},{label:"PUT"},{label:"DELETE"},{label:"HEAD"},{label:"OPTIONS"},{label:"PATCH"}]}},name:"TestBody",mounted:function(){this.header=this.response.body.header,this.request=this.response.body.request,this.extract=this.response.body.extract,this.validate=this.response.body.validate,this.variables=this.response.body.variables,this.hooks=this.response.body.hooks,this.sqlVariables=this.response.body.sqlVariables}},Ke={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",[a("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入接口名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[a("template",{slot:"prepend"},[e._v("接口信息录入")]),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:function(t){e.save=!e.save}},slot:"append"},[e._v("保存\n                ")])],2),e._v(" "),a("el-button",{attrs:{slot:"append",type:"danger"},on:{click:function(t){e.esc=!e.esc}},slot:"append"},[e._v("返回\n            ")])],1),e._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入接口请求地址",clearable:""},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend",size:"small"},slot:"prepend",model:{value:e.method,callback:function(t){e.method=t},expression:"method"}},e._l(e.httpOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})}),1)],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"循环次数",placement:"bottom"}},[a("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:1,max:100},model:{value:e.times,callback:function(t){e.times=t},expression:"times"}})],1)],1),e._v(" "),e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"request"},[a("el-tabs",{staticStyle:{"margin-left":"20px"},model:{value:e.activeTag,callback:function(t){e.activeTag=t},expression:"activeTag"}},[a("el-tab-pane",{attrs:{label:"请求头",name:"first"}},[a("headers",{attrs:{save:e.save,header:e.header},on:{header:e.handleHeader}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"请求体",name:"second"}},[a("request",{attrs:{save:e.save,request:e.request},on:{request:e.handleRequest}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"提取器",name:"third"}},[a("extract",{attrs:{save:e.save,extract:e.extract},on:{extract:e.handleExtract}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"断言",name:"fourth"}},[a("validate",{attrs:{save:e.save,validate:e.validate},on:{validate:e.handleValidate}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"变量设置",name:"five"}},[a("variables",{attrs:{save:e.save,variables:e.variables},on:{variables:e.handleVariables}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"前后置方法设置",name:"six"}},[a("hooks",{attrs:{save:e.save,hooks:e.hooks},on:{hooks:e.handleHooks}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"数据库操作",name:"seven"}},[a("sqlVariables",{attrs:{save:e.save,sqlVariables:e.sqlVariables},on:{sqlVariables:e.handlesqlVariables}})],1)],1)],1)])},staticRenderFns:[]};var Je=a("VU/8")(Ge,Ke,!1,function(e){a("OkVz")},"data-v-1a1a5d63",null).exports,Ze=function(e){return p.a.get("/api/testrunner/test/",e).then(function(e){return e.data})},Qe=function(e){return p.a.get("/api/testrunner/test/",e).then(function(e){return e.data})},We={components:{draggable:He.a,HttpRunner:Je,Report:Te},computed:{isConfigExist:{get:function(){return this.testData.length>0&&"config"===this.testData[0].body.method&&"请选择"!==this.testData[0].body.name}}},props:{host:{require:!0},config:{require:!0},configdesc:{require:!0},project:{require:!0},node:{require:!0},testStepResp:{require:!1},back:Boolean},name:"EditTest",watch:{config:function(){var e={body:{name:this.config,method:"config"}};0!==this.testData.length&&"config"===this.testData[0].body.method||"请选择"===this.config?"请选择"!==this.config&&this.testData.splice(0,1,e):this.testData.splice(0,0,e)},back:function(){this.editTestStepActivate=!1},filterText:function(e){this.$refs.tree2.filter(e)},testStepResp:function(){try{this.testName=this.testStepResp.case.name,this.testId=this.testStepResp.case.id,this.testTag=this.testStepResp.case.tag,this.relation=this.testStepResp.case.relation,this.testData=JSON.parse(Me()(this.testStepResp.step))}catch(e){this.testName="",this.testId="",this.testTag="集成用例",this.testData=JSON.parse(Me()(this.testStepResp))}}},data:function(){return{drga:!1,tagOptions:{1:"冒烟用例",2:"集成用例",3:"监控脚本",4:"回归用例",5:"系统用例",6:"空库用例"},suite_loading:!1,loading:!1,dialogTableVisible:!1,editTestStepActivate:!1,currentPage:1,length:0,testId:"",search:"",testName:"",relation:"",testTag:"集成用例",currentTest:"",currentNode:"",currentAPI:"",data:"",filterText:"",expand:"&#xe65f;",dataTree:[],summary:{},apiData:{count:0,results:[]},testData:[]}},methods:{onStart:function(){this.drag=!0},onEnd:function(){this.drag=!1},handleNewBody:function(e,t){console.log("------------handleNewBody----------"),this.editTestStepActivate=!1;var a=this.testData[this.currentTest].case,s=this.testData[this.currentTest].id;this.testData[this.currentTest]={body:e,newBody:t,case:a,id:s}},validateData:function(){return""===this.testName||this.testName.length>100?(this.$notify.warning({title:"提示",duration:1e3,message:"用例集名称必填，不能超过100个字符"}),!1):0===this.testData.length?(this.$notify.warning({title:"提示",duration:1e3,message:"测试用例集至少包含一个接口"}),!1):"config"!==this.testData[0].body.method||1!==this.testData.length||(this.$notify.warning({title:"提示",duration:1e3,message:"测试用例集至少包含一个接口"}),!1)},addTestSuite:function(){var e,t=this,a=this.testData.length;"config"===this.testData[0].body.method&&(a-=1),(e={length:a,project:this.project,relation:this.node,name:this.testName,body:this.testData,tag:this.testTag},p.a.post("/api/testrunner/test/",e).then(function(e){return e.data})).then(function(e){e.success?t.$emit("addSuccess"):t.$message({message:e.msg,type:"error",duration:1e3}),t.currentPage=1})},updateTestSuite:function(){var e,t,a=this,s=this.testData.length;"config"===this.testData[0].body.method&&(s-=1),(e=this.testId,t={length:s,name:this.testName,tag:this.testTag,body:this.testData,project:this.project,relation:this.relation},p.a.patch("/api/testrunner/test/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.success?a.$emit("addSuccess"):a.$message({message:e.msg,type:"error",duration:1e3}),a.currentPage=1})},handleClickSave:function(){this.validateData()&&(""===this.testId?this.addTestSuite():this.updateTestSuite())},handleClickRun:function(){var e,t=this;this.validateData()&&(this.suite_loading=!0,(e={host:this.host,name:this.testName,body:this.testData,project:this.project},p.a.post("/api/testrunner/run_testsuite/",e).then(function(e){return e.data})).then(function(e){t.suite_loading=!1,t.summary=e,t.dialogTableVisible=!0}).catch(function(e){t.suite_loading=!1}))},handleSingleRun:function(){var e=this;this.loading=!0;var t,a=null;this.testData.length>0&&"config"===this.testData[0].body.method&&(a=this.testData[0].body),(t={host:this.host,config:a,body:this.testData[this.currentTest],project:this.project},p.a.post("/api/testrunner/run_test/",t).then(function(e){return e.data})).then(function(t){e.loading=!1,e.summary=t,e.dialogTableVisible=!0}).catch(function(t){e.loading=!1})},handlePageChange:function(e){var t=this;Fe({params:{page:this.currentPage,node:this.currentNode,project:this.project,search:this.search}}).then(function(e){t.apiData=e})},getAPIList:function(){var e=this;$e({params:{node:this.currentNode,project:this.project,search:this.search}}).then(function(t){e.apiData=t})},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:1}}).then(function(t){e.dataTree=t.tree})},handleNodeClick:function(e,t){this.currentNode=e.id,this.data=t,this.getAPIList()},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},dragEnd:function(e){this.testData.length>this.length&&this.testData.splice(this.length,1)},drop:function(e){e.preventDefault(),this.testData.push(this.currentAPI)},allowDrop:function(e){e.preventDefault()}},mounted:function(){this.getTree(),this.getAPIList()}},Xe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-aside",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)])]),e._v(" "),a("el-main",[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.editTestStepActivate,expression:"!editTestStepActivate"}]},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:7}},[a("el-input",{attrs:{placeholder:"请输入接口名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getAPIList},slot:"append"})],1)],1),e._v(" "),a("el-col",{staticStyle:{right:"145px",position:"absolute"},attrs:{span:30}},[e.testData.length>0?a("el-input",{staticStyle:{width:"400px","text-align":"center"},attrs:{placeholder:"请输入测试用例名称",clearable:""},model:{value:e.testName,callback:function(t){e.testName=t},expression:"testName"}},[a("el-select",{staticStyle:{width:"105px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.testTag,callback:function(t){e.testTag=t},expression:"testTag"}},e._l(e.tagOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:e.handleClickSave},slot:"append"},[e._v("保存\n                        ")])],1):e._e(),e._v(" "),e.testData.length>0?a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.suite_loading,expression:"suite_loading"}],attrs:{type:"primary"},on:{click:e.handleClickRun},model:{value:e.testName,callback:function(t){e.testName=t},expression:"testName"}},[e._v("发送\n                    ")]):e._e()],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.editTestStepActivate,expression:"!editTestStepActivate"}],staticStyle:{"margin-top":"10px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[e._l(e.apiData.results,function(t,s){return a("div",{key:s,staticStyle:{cursor:"pointer","margin-top":"10px"},attrs:{draggable:"true"},on:{dragstart:function(a){e.currentAPI=JSON.parse(JSON.stringify(t))}}},["POST"===t.method.toUpperCase()?a("div",{staticClass:"block block_post"},[a("span",{staticClass:"block-method block_method_post block_method_color"},[e._v("POST")]),e._v(" "),a("el-tooltip",{attrs:{content:t.url,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.url))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.name))])])],1):e._e(),e._v(" "),"GET"===t.method.toUpperCase()?a("div",{staticClass:"block block_get"},[a("span",{staticClass:"block-method block_method_get block_method_color"},[e._v("GET")]),e._v(" "),a("el-tooltip",{attrs:{content:t.url,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.url))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.name))])])],1):e._e(),e._v(" "),"PUT"===t.method.toUpperCase()?a("div",{staticClass:"block block_put"},[a("span",{staticClass:"block-method block_method_put block_method_color"},[e._v("PUT")]),e._v(" "),a("el-tooltip",{attrs:{content:t.url,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.url))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.name))])])],1):e._e(),e._v(" "),"DELETE"===t.method.toUpperCase()?a("div",{staticClass:"block block_delete"},[a("span",{staticClass:"block-method block_method_delete block_method_color"},[e._v("DELETE")]),e._v(" "),a("el-tooltip",{attrs:{content:t.url,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.url))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.name))])])],1):e._e(),e._v(" "),"PATCH"===t.method.toUpperCase()?a("div",{staticClass:"block block_patch"},[a("span",{staticClass:"block-method block_method_patch block_method_color"},[e._v("PATCH")]),e._v(" "),a("el-tooltip",{attrs:{content:t.url,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.url))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.name))])])],1):e._e(),e._v(" "),"HEAD"===t.method.toUpperCase()?a("div",{staticClass:"block block_head"},[a("span",{staticClass:"block-method block_method_head block_method_color"},[e._v("HEAD")]),e._v(" "),a("el-tooltip",{attrs:{content:t.url,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.url))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.name))])])],1):e._e(),e._v(" "),"OPTIONS"===t.method.toUpperCase()?a("div",{staticClass:"block block_options"},[a("span",{staticClass:"block-method block_method_options block_method_color"},[e._v("OPTIONS")]),e._v(" "),a("el-tooltip",{attrs:{content:t.url,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.url))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.name))])])],1):e._e()])}),e._v(" "),a("el-footer",{staticStyle:{"padding-top":"30px","padding-left":"0px"}},[a("el-col",{attrs:{span:10}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.apiData.count,expression:"apiData.count !== 0"}],staticStyle:{"margin-top":"5px","text-align":"center"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.apiData.count},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],2),e._v(" "),a("el-col",{attrs:{span:12}},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("div",{staticStyle:{"max-height":"600px",overflow:"auto"},on:{drop:function(t){return e.drop(t)},dragover:function(t){return e.allowDrop(t)}}},[a("div",{staticClass:"test-list"},[0===e.testData.length?a("span",{staticStyle:{color:"red"}},[e._v("温馨提示："),a("br"),e._v("选择左侧相应API节点显示可拖拽的API"),a("br"),e._v("从左边拖拽API至此区域组成业务用例"),a("br"),e._v("\n                                上下拖动此区域接口调整接口调用顺序\n                            ")]):e._e(),e._v(" "),e.isConfigExist?a("div",{staticClass:"block block_test",on:{mousemove:function(t){e.currentTest=-1}}},[a("span",{staticClass:"block-method block_method_config block_method_color"},[e._v(e._s(e.testData[0].body.method))]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.testData[0].body.name,expression:"testData[0].body.name"}],staticClass:"block-test-name",attrs:{disabled:""},domProps:{value:e.testData[0].body.name},on:{input:function(t){t.target.composing||e.$set(e.testData[0].body,"name",t.target.value)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1===e.currentTest,expression:"currentTest === -1"}],staticStyle:{position:"absolute",right:"12px",top:"8px"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.testData.splice(e.index,1)}}})],1):e._e(),e._v(" "),a("draggable",{attrs:{group:"test",sort:!0,"force-fallback":"true",animation:"100"},on:{start:e.onStart,end:e.onEnd},model:{value:e.testData,callback:function(t){e.testData=t},expression:"testData"}},e._l(e.testData,function(t,s){return"config"!==t.body.method?a("div",{key:s,staticClass:"block block_test",on:{mousemove:function(t){e.currentTest=s}}},[a("span",{staticClass:"block-method block_method_test block_method_color"},[e._v("A P I")]),e._v(" "),a("span",{staticClass:"test_demo_ellipsis"},[e._v(e._s(t.name))]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"84px",top:"8px"},attrs:{type:"info",icon:"el-icon-edit",circle:"",size:"mini"},on:{click:function(t){e.editTestStepActivate=!0}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"48px",top:"8px"},attrs:{type:"success",icon:"el-icon-caret-right",circle:"",size:"mini"},on:{click:e.handleSingleRun}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"12px",top:"8px"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.testData.splice(s,1)}}})],1):e._e()}),0)],1)])],1)],1)],1),e._v(" "),e.editTestStepActivate?a("http-runner",{attrs:{host:e.host,response:e.testData[e.currentTest],config:e.config,configdesc:e.configdesc},on:{escEdit:function(t){e.editTestStepActivate=!1},getNewBody:e.handleNewBody}}):e._e()],1)],1)},staticRenderFns:[]};var Ye=a("VU/8")(We,Xe,!1,function(e){a("jAaO")},"data-v-6a2195ac",null).exports,et={name:"TestList",components:{Report:Te},props:{run:Boolean,back:Boolean,project:{require:!0},host:{require:!0},node:{require:!1},permissions:{require:!0},del:Boolean},watch:{filterText:function(e){this.$refs.tree.filter(e)},run:function(){this.asyncs=!1,this.reportName="",this.getTree()},node:function(){this.search="",this.getTestList()},back:function(){this.getTestList()},del:function(){var e=this;0!==this.selectTest.length?this.$confirm("此操作将永久删除测试用例集，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectTest},p.a.delete("/api/testrunner/test/",t).then(function(e){return e.data})).then(function(t){e.getTestList()})}):this.$notify.warning({title:"提示",message:"请至少选择一个用例集",duration:1e3})}},data:function(){return{search:"",options:[{value:"",label:"全部"},{value:"1",label:"冒烟用例"},{value:"2",label:"集成用例"},{value:"3",label:"监控脚本"},{value:"4",label:"回归用例"},{value:"5",label:"系统用例"},{value:"6",label:"空库用例"}],value:"",reportName:"",asyncs:!1,filterText:"",expand:"&#xe65f;",dialogTreeVisible:!1,dataTree:{},loading:!1,dialogTableVisible:!1,selectTest:[],summary:{},currentRow:"",testData:{count:0,results:[]},currentPage:1,defaultProps:{children:"children",label:"label"}}},methods:{getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:2}}).then(function(t){e.dataTree=t.tree,e.dialogTreeVisible=!0})},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},runTree:function(){var e=this;this.dialogTreeVisible=!1;var t,a=this.$refs.tree.getCheckedKeys();0===a.length?this.$notify.error({title:"提示",message:"请至少选择一个节点",duration:1500}):(t={host:this.host,project:this.project,relation:a,async:this.asyncs,name:this.reportName},p.a.post("/api/testrunner/run_suite_tree/",t).then(function(e){return e.data})).then(function(t){t.hasOwnProperty("status")?e.$message.info({message:t.msg,duration:1500}):(e.summary=t,e.dialogTableVisible=!0)})},handleRunTest:function(e,t){var a,s,n=this;this.loading=!0,(a=e,s={params:{project:this.project,name:t,host:this.host}},p.a.get("/api/testrunner/run_testsuite_pk/"+a+"/",s).then(function(e){return e.data})).then(function(e){n.summary=e,n.dialogTableVisible=!0,n.loading=!1}).catch(function(e){n.loading=!1})},handleCurrentChange:function(e){var t=this;Qe({params:{page:this.currentPage,project:this.project,tag:this.value,node:this.node,search:this.search}}).then(function(e){t.testData=e})},handleEditTest:function(e){var t,a=this;(t=e,p.a.get("/api/testrunner/teststep/"+t+"/").then(function(e){return e.data})).then(function(e){a.$emit("testStep",e)})},handleCopyTest:function(e){var t=this;this.$prompt("请输入用例集名称","提示",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"用例集不能为空"}).then(function(a){var s,n,r=a.value;(s=e,n={name:r,relation:t.node,project:t.project},p.a.post("/api/testrunner/test/"+s+"/",n).then(function(e){return e.data})).then(function(e){t.getTestList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},handleSelectionChange:function(e){this.selectTest=e},handleDelTest:function(e){var t=this;this.$confirm("此操作将永久删除该测试用例集，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/test/"+a+"/").then(function(e){return e.data})).then(function(e){t.getTestList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},getTestList:function(){var e=this;Ze({params:{project:this.project,node:this.node,search:this.search,tag:this.value}}).then(function(t){e.testData=t})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""}},mounted:function(){this.getTestList()}},tt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{"padding-top":"10px",height:"50px"}},[a("div",{staticStyle:{overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{staticStyle:{"padding-left":"25px","padding-right":"0px",width:"25%"},attrs:{span:7}},[e._v("\n                      用例类型:\n                  "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getTestList},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入用例名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getTestList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px",height:"700px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"500px",top:"160px"}},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%","modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"运行测试用例集",visible:e.dialogTreeVisible,width:"45%","modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogTreeVisible=t}}},[a("div",[a("div",[a("el-row",{attrs:{gutter:2}},[a("el-col",{attrs:{span:8}},[a("el-switch",{staticStyle:{"margin-top":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"异步执行","inactive-text":"同步执行"},model:{value:e.asyncs,callback:function(t){e.asyncs=t},expression:"asyncs"}})],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.asyncs,expression:"asyncs"}],attrs:{clearable:"",placeholder:"请输入报告名称",disabled:!1},model:{value:e.reportName,callback:function(t){e.reportName=t},expression:"reportName"}})],1)],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-input",{attrs:{value:"",placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"overflow-y":"scroll",height:"400px"},attrs:{data:e.dataTree,"check-strictly":!1,"filter-node-method":e.filterNode,"show-checkbox":"","check-on-click-node":"","node-key":"id","highlight-current":"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTreeVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.runTree}},[e._v("确 定")])],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.testData.results,"show-header":0!==e.testData.count,stripe:"",height:"700px"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"用例名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"API个数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.length)+" 个")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用例类型",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.tag?a("el-tag",[e._v("冒烟用例")]):e._e(),e._v(" "),2===t.row.tag?a("el-tag",{attrs:{type:"success"}},[e._v("集成用例")]):e._e(),e._v(" "),3===t.row.tag?a("el-tag",{attrs:{type:"danger"}},[e._v("监控脚本")]):e._e(),e._v(" "),4===t.row.tag?a("el-tag",{attrs:{type:"info"}},[e._v("回归用例")]):e._e(),e._v(" "),5===t.row.tag?a("el-tag",{attrs:{type:"primary"}},[e._v("系统用例")]):e._e(),e._v(" "),6===t.row.tag?a("el-tag",{attrs:{type:"warning"}},[e._v("空库用例")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditTest(t.row.id)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.handleRunTest(t.row.id,t.row.name)}}},[e._v("运行")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleCopyTest(t.row.id)}}},[e._v("复制\n                                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelTest(t.row.id)}}},[e._v("删除\n                                ")]):e._e()],1)]}}])})],1),e._v(" "),a("div",[a("el-footer",{staticStyle:{"padding-top":"10px"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:9}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.testData.count,expression:"testData.count !== 0 "}],attrs:{"current-page":e.currentPage,"page-size":5,layout:"total, prev, pager, next, jumper",total:e.testData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)],1)])],1)],1)},staticRenderFns:[]};var at={computed:{buttonActivate:{get:function(){return!this.addTestActivate||""===this.currentNode},set:function(e){this.addTestActivate=e,this.testStepResp=[]}}},watch:{filterText:function(e){this.$refs.tree2.filter(e)}},components:{EditTest:Ye,TestList:a("VU/8")(et,tt,!1,function(e){a("+DLE")},"data-v-e611198a",null).exports},data:function(){return{permissions:[],loading:!1,excludeproject:this.$route.params.id,testStepResp:[],syncdialogVisible:!1,syncForm:{oldproject:"",oldnodeid:""},nodeForm:{name:""},rules:{name:[{required:!0,message:"请输入节点名称",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],oldproject:[{required:!0,message:"请选择用例项目源",trigger:"blur"}],oldnodeid:[{required:!0,message:"请选择用例分组源",trigger:"blur"}]},hostOptions:[],back:!1,del:!1,run:!1,radio:"根节点",addTestActivate:!0,currentConfig:"请选择",currentHost:"请选择",treeId:"",maxId:"",dialogVisible:!1,currentNode:"",data:"",filterText:"",expand:"&#xe65f;",oldtree:[],projectlist:[],dataTree:[],configOptions:[]}},methods:{clearid:function(){this.syncForm.oldproject="",this.syncForm.oldnodeid=""},synsqx:function(){this.clearid(),this.syncdialogVisible=!1},opensy:function(){this.clearid(),this.syncdialogVisible=!0,this.getpojectlsit()},getpojectlsit:function(){var e=this;E().then(function(t){e.projectlist=t.results})},getoldtree:function(e){var t,a=this;null!=e&&""!=e&&void 0!=e&&(t={params:{project:e,type:2}},p.a.get("/api/testrunner/getoneleveltree/",t).then(function(e){return e.data})).then(function(e){a.oldtree=e.tree})},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"case"}).then(function(t){e.permissions=t.permissions})},syncCaseConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$confirm("此操作将覆盖所选分组的用例和组织, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e,a=n.Loading.service({text:"加载中... 请稍后",background:"rgba(0, 0, 0, 0.8)"});(e={project:t.$route.params.id,nodeid:t.currentNode.id,oldproject:t.syncForm.oldproject,oldnodeid:t.syncForm.oldnodeid},p.a.post("/api/testrunner/generateCase/",e).then(function(e){return e.data})).then(function(e){e.success?(t.clearid(),t.syncdialogVisible=!1,a.close(),t.$message.info({message:e.msg,duration:1e3}),location.reload()):(a.close(),t.$message.info({message:e.msg,duration:1e3}))}),a.close()})})},handleDragEnd:function(){this.updateTree(!1)},getConfig:function(){var e=this;Ie(this.$route.params.id).then(function(t){e.configOptions=t.results,e.configOptions.push({name:"请选择"})})},handleBackList:function(){this.addTestActivate=!0,this.back=!this.back},quxiao:function(){this.nodeForm.name="",this.dialogVisible=!1},handleTestStep:function(e){this.testStepResp=e,this.addTestActivate=!1},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:2}}).then(function(t){e.dataTree=t.tree,e.treeId=t.id,e.maxId=t.max})},updateTree:function(e){var t=this;Re(this.treeId,{mode:e,body:this.dataTree,node:this.currentNode.id,type:2}).then(function(e){e.success?(t.dataTree=e.tree,t.maxId=e.max):t.$message.error(e.msg)})},renameNode:function(){var e=this;this.$prompt("请输入节点名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"节点名称不能为空"}).then(function(t){var a=t.value,s=e.data.parent,n=s.data.children||s.data;n[n.findIndex(function(t){return t.id===e.currentNode.id})].label=a,e.updateTree(!1)})},deleteNode:function(){var e=this;this.$confirm("此操作将永久删除该节点下所有用例, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){""===e.currentNode?e.$message.info("请选择一个节点"):0!==e.currentNode.children.length?e.$message.warning("此节点有子节点，不可删除！"):(e.remove(e.currentNode,e.data),e.updateTree(!0))})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.append(t.currentNode),t.updateTree(!1),t.dialogVisible=!1,t.nodeForm.name="")})},handleNodeClick:function(e,t){this.currentNode=e,this.data=t},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},remove:function(e,t){var a=t.parent,s=a.data.children||a.data,n=s.findIndex(function(t){return t.id===e.id});s.splice(n,1)},append:function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var a={id:t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),label:this.nodeForm.name,children:[]};""!==e&&0!==this.dataTree.length&&"根节点"!==this.radio?(e.children||this.$set(e,"children",[]),e.children.push(a)):this.dataTree.push(a)},getHost:function(){var e=this;Ee(this.$route.params.id).then(function(t){e.hostOptions=t.results,e.hostOptions.push({name:"请选择"})})}},name:"AutoTest",mounted:function(){this.getTree(),this.getConfig(),this.getHost(),this.getpermissions()}},st={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus",disabled:!e.addTestActivate},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n                    新建分组\n                ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"新建分组",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"nodeForm",staticClass:"project",attrs:{model:e.nodeForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"节点名称",prop:"name"}},[a("el-input",{model:{value:e.nodeForm.name,callback:function(t){e.$set(e.nodeForm,"name",t)},expression:"nodeForm.name"}})],1)],1),e._v(" "),a("el-radio-group",{attrs:{size:"small"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"根节点"}}),e._v(" "),a("el-radio-button",{attrs:{label:"子节点"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.quxiao()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("nodeForm")}}},[e._v("确 定")])],1)],1),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",disabled:e.buttonActivate},on:{click:e.deleteNode}},[e._v("删除分组\n                ")]):e._e(),e._v(" "),e.permissions.includes("change")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"info",size:"small",icon:"el-icon-edit-outline"},on:{click:e.renameNode}},[e._v("重命名\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline",disabled:e.buttonActivate},on:{click:function(t){e.buttonActivate=!1}}},[e._v("添加用例\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline",disabled:e.buttonActivate},on:{click:function(t){return e.opensy()}}},[e._v("同步用例\n                ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"同步目标项目用例",visible:e.syncdialogVisible,width:"25%",align:"center",center:""},on:{"update:visible":function(t){e.syncdialogVisible=t}}},[a("el-form",{ref:"syncForm",staticClass:"project",attrs:{model:e.syncForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"项目源",prop:"oldproject"}},[a("el-select",{staticStyle:{float:"left"},attrs:{size:"medium",clearable:"",placeholder:"请选择"},on:{change:function(t){return e.getoldtree(t)},clear:function(t){return e.clearid()}},model:{value:e.syncForm.oldproject,callback:function(t){e.$set(e.syncForm,"oldproject",t)},expression:"syncForm.oldproject"}},e._l(e.projectlist,function(t){return t.id!=e.excludeproject?a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}}):e._e()}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分组源",prop:"oldnodeid"}},[a("el-select",{staticStyle:{float:"left"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.syncForm.oldnodeid,callback:function(t){e.$set(e.syncForm,"oldnodeid",t)},expression:"syncForm.oldnodeid"}},e._l(e.oldtree,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}),1)],1),e._v(" "),a("p",{staticStyle:{color:"red"}},[e._v("同步用例会覆盖现有的所选分组下的用例和子级分组，请谨慎操作！")])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.synsqx()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.syncCaseConfirm("syncForm")}}},[e._v("同 步")])],1)],1),e._v("\n                 环境:\n                "),a("el-select",{attrs:{placeholder:"请选择",size:"small",tyle:"margin-left: -6px"},model:{value:e.currentHost,callback:function(t){e.currentHost=t},expression:"currentHost"}},e._l(e.hostOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v("\n                 配置:\n                "),a("el-select",{attrs:{placeholder:"请选择",size:"small",tyle:"margin-left: -6px",filterable:"",disabled:e.addTestActivate},model:{value:e.currentConfig,callback:function(t){e.currentConfig=t},expression:"currentConfig"}},e._l(e.configOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),e.addTestActivate&&e.permissions.includes("add")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.run=!e.run}}},[e._v("运行")]):e._e(),e._v(" "),e.addTestActivate&&e.permissions.includes("delete")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){e.del=!e.del}}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:e.addTestActivate,type:"text"},on:{click:e.handleBackList}},[e._v("返回列表\n                ")])],1)])]),e._v(" "),a("el-container",[a("el-aside",{directives:[{name:"show",rawName:"v-show",value:e.addTestActivate,expression:"addTestActivate"}],staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,draggable:"","highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick,"node-drag-end":e.handleDragEnd},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)])]),e._v(" "),a("el-main",{staticStyle:{padding:"0"}},[a("test-list",{directives:[{name:"show",rawName:"v-show",value:e.addTestActivate,expression:"addTestActivate"}],attrs:{permissions:e.permissions,project:e.$route.params.id,node:""!==e.currentNode?e.currentNode.id:"",del:e.del,back:e.back,run:e.run,host:e.currentHost},on:{testStep:e.handleTestStep}}),e._v(" "),a("edit-test",{directives:[{name:"show",rawName:"v-show",value:!e.addTestActivate,expression:"!addTestActivate"}],attrs:{back:e.back,project:e.$route.params.id,node:e.currentNode.id,testStepResp:e.testStepResp,config:e.currentConfig,host:e.currentHost},on:{addSuccess:e.handleBackList}})],1)],1)],1)},staticRenderFns:[]};var nt=a("VU/8")(at,st,!1,function(e){a("Uonp")},"data-v-212b7a16",null).exports,rt={data:function(){return{fileupload:ne(),permissions:[],uploadheader:{Authorization:""+m.token},fileList:[],filedata:{project:this.$route.params.id,name:""},search:"",selectVariables:[],currentRow:"",currentPage:1,variablesData:{count:0,results:[]},editdialogVisible:!1,dialogVisible:!1,tkdialogVisible:!1,variablesForm:{key:"",value:"",desc:"",project:this.$route.params.id},tokenForm:{project:this.$route.params.id,publickeyurl:"",loginurl:"",username:"",password:""},editVariablesForm:{key:"",value:"",desc:"",id:""},rules:{key:[{required:!0,message:"请输入变量名",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}],value:[{required:!0,message:"请输入变量值",trigger:"blur"},{min:1,max:1024,message:"最多不超过1024个字符",trigger:"blur"}],publickeyurl:[{required:!0,message:"请输入公钥接口",trigger:"blur"},{min:1,max:1024,message:"最多不超过1024个字符",trigger:"blur"}],loginurl:[{required:!0,message:"请输入登陆接口",trigger:"blur"},{min:1,max:1024,message:"最多不超过1024个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}]}}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},UploadBefore:function(e){this.filedata.name=e.name},handleClickUpload:function(){},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"variable"}).then(function(t){e.permissions=t.permissions})},uploadSuccess:function(e){this.fileList=[],this.getVariablesList(),this.currentPage=1,e.success?this.$notify.success({message:e.msg}):this.$notify.error({message:e.msg})},uploadError:function(e){401===e.status?(this.$notify.error("请先登录"),this.$router.replace({name:"Login"})):403===e.status?this.$notify.error({title:"detail",message:"您没有执行该操作的权限。"}):this.$notify.error({message:e.msg})},exportVariable:function(){var e=this;se({project:this.$route.params.id}).then(function(t){new Blob([t.data],{type:"application/vnd.ms-excel"});var a=window.URL.createObjectURL(t.data),s=document.createElement("a");s.style.display="none",s.download="全局变量.xls",s.href=a,s.click(),200==t.status?e.$notify.success({message:"导出成功"}):e.$notify.error({message:"导出失败"})})},handleEditVariables:function(e){this.editVariablesForm={key:e.key,value:e.value,desc:e.desc,id:e.id},this.editdialogVisible=!0},handleExceed:function(e,t){this.$notify.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handlegettokenvariables:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.tkdialogVisible=!1,(a=t.tokenForm,p.a.post("/api/testrunner/gettokenmsg/",a)).then(function(e){t.tokenForm.username="",t.tokenForm.password="",t.tokenForm.loginurl="",t.tokenForm.publickeyurl="",t.getVariablesList()}))})},handleDelVariables:function(e){var t=this;this.$confirm("此操作将永久删除该全局变量，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/variables/"+a+"/").then(function(e){return e.data})).then(function(e){t.getVariablesList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},handleSelectionChange:function(e){this.selectVariables=e},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.variablesForm.project,search:this.search}},p.a.get("/api/testrunner/variables/",t).then(function(e){return e.data})).then(function(e){a.variablesData=e})},delSelectionVariables:function(){var e=this;0!==this.selectVariables.length?this.$confirm("此操作将永久删除勾选的全局变量，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectVariables},p.a.delete("/api/testrunner/variables/",t).then(function(e){return e.data})).then(function(t){e.getVariablesList()})}):this.$notify.warning({title:"提示",message:"请至少勾选一个全局变量",duration:1e3})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.dialogVisible=!1,(a=t.variablesForm,p.a.post("/api/testrunner/variables/",a).then(function(e){return e.data})).then(function(e){e.success?(t.variablesForm.key="",t.variablesForm.value="",t.variablesForm.desc="",t.getVariablesList(),t.$message.success(e.msg),t.currentPage=1):t.$message.error({message:e.msg,duration:1e3})}))})},handleEditConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a,s;e&&(t.editdialogVisible=!1,(a=t.editVariablesForm.id,s=t.editVariablesForm,p.a.patch("/api/testrunner/variables/"+a+"/",s).then(function(e){return e.data})).then(function(e){t.getVariablesList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error({message:e.msg,duration:1e3})}))})},getVariablesList:function(){var e,t=this;(e={params:{project:this.variablesForm.project,search:this.search}},p.a.get("/api/testrunner/variables/",e).then(function(e){return e.data})).then(function(e){t.variablesData=e})}},name:"GlobalEnv",mounted:function(){this.getVariablesList(),this.getpermissions()}},it={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新增变量\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.tkdialogVisible=!0}}},[e._v("生成token变量\n                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.variablesData.count,expression:"variablesData.count !== 0 "}],staticStyle:{"margin-left":"20px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:e.delSelectionVariables}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-upload",{staticClass:"upload-demo",staticStyle:{display:"inline"},attrs:{action:e.fileupload,"show-file-list":!1,accept:".xls,",multiple:"",limit:1,headers:e.uploadheader,"on-exceed":e.handleExceed,"file-list":e.fileList,"on-error":e.uploadError,"on-success":e.uploadSuccess,"before-upload":e.UploadBefore,data:e.filedata}},[e.permissions.includes("add")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"primary",title:"只能导入/xls文件",name:"myfile"},on:{click:e.handleClickUpload}},[e._v("\n                        导入\n                    ")]):e._e()],1),e._v(" "),e.permissions.includes("add")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.exportVariable}},[e._v("导出")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"添加变量",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"variablesForm",staticClass:"project",attrs:{model:e.variablesForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"变量名",prop:"key"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量名"},model:{value:e.variablesForm.key,callback:function(t){e.$set(e.variablesForm,"key",t)},expression:"variablesForm.key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量值",prop:"value"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量值"},model:{value:e.variablesForm.value,callback:function(t){e.$set(e.variablesForm,"value",t)},expression:"variablesForm.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量描述",prop:"desc"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入描述"},model:{value:e.variablesForm.desc,callback:function(t){e.$set(e.variablesForm,"desc",t)},expression:"variablesForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("variablesForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑变量",visible:e.editdialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.editdialogVisible=t}}},[a("el-form",{ref:"editVariablesForm",staticClass:"project",attrs:{model:e.editVariablesForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"变量名",prop:"key"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量名"},model:{value:e.editVariablesForm.key,callback:function(t){e.$set(e.editVariablesForm,"key",t)},expression:"editVariablesForm.key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量值",prop:"value"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量值"},model:{value:e.editVariablesForm.value,callback:function(t){e.$set(e.editVariablesForm,"value",t)},expression:"editVariablesForm.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量描述",prop:"desc"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入描述"},model:{value:e.editVariablesForm.desc,callback:function(t){e.$set(e.editVariablesForm,"desc",t)},expression:"editVariablesForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditConfirm("editVariablesForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"生成token全局变量",visible:e.tkdialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.tkdialogVisible=t}}},[a("el-form",{ref:"tokenForm",staticClass:"project",attrs:{model:e.tokenForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"公钥接口",prop:"publickeyurl"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入公钥接口"},model:{value:e.tokenForm.publickeyurl,callback:function(t){e.$set(e.tokenForm,"publickeyurl",t)},expression:"tokenForm.publickeyurl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登陆接口",prop:"loginurl"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入登陆接口"},model:{value:e.tokenForm.loginurl,callback:function(t){e.$set(e.tokenForm,"loginurl",t)},expression:"tokenForm.loginurl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户账号",prop:"username"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入用户账号"},model:{value:e.tokenForm.username,callback:function(t){e.$set(e.tokenForm,"username",t)},expression:"tokenForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户密码",prop:"password"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入用户密码"},model:{value:e.tokenForm.password,callback:function(t){e.$set(e.tokenForm,"password",t)},expression:"tokenForm.password"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.tkdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handlegettokenvariables("tokenForm")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"20px",overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入变量名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getVariablesList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"150px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.variablesData.results,"show-header":0!==e.variablesData.results.length,stripe:"",height:"calc(75%)"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"变量名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.key))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"变量值","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"创建人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditVariables(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.variablesData.count,expression:"variablesData.count !== 0"}],attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelVariables(t.row.id)}}},[e._v("删除\n                                    ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.variablesData.count,expression:"variablesData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.variablesData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var ot=a("VU/8")(rt,it,!1,function(e){a("V12/")},null,null).exports,lt=function(e,t){return p.a.get("/api/testrunner/reports/"+e+"/",t)},ct={data:function(){return{search:"",selectReports:[],permissions:[],currentRow:"",currentPage:1,reportData:{count:0,results:[]},loading:!0}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleWatchReports:function(e){var t=this;lt(e,{params:{project:this.$route.params.id}}).then(function(e){if(200==e.status){var a=window.open("");window.focus(),a.focus(),a.document.open(),a.document.write(e.data),a.document.close()}else if(204==e.status)return t.$notify.error("查看报告失败，报告不存在或已被删除"),t.currentPage=1,t.getReportList(),!1})},handleSelectionChange:function(e){this.selectReports=e},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/reports/",t).then(function(e){return e.data})).then(function(e){a.reportData=e})},handleDelReports:function(e){var t=this;this.$confirm("此操作将永久删除该测试报告，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a,s;(a=e,s={params:{project:t.$route.params.id}},p.a.delete("/api/testrunner/reports/"+a+"/",s)).then(function(e){t.$notify.success("删除报告成功"),t.getReportList(),t.currentPage=1})})},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"report"}).then(function(t){e.permissions=t.permissions})},delSelectionReports:function(){var e=this;0!==this.selectReports.length?this.$confirm("此操作将永久删除勾选的测试报告，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t,a;(t=e.selectReports,a={project:e.$route.params.id},p()({url:"/api/testrunner/reports/",method:"delete",params:a,data:t})).then(function(t){e.$notify.success("批量删除报告成功"),e.getReportList(),e.currentPage=1})}):this.$notify.warning("请至少勾选一个测试报告")},handleDownExcelReport:function(e,t){var a=this;te({fileType:2,id:e,project:this.$route.params.id}).then(function(e){var a=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=a,s.setAttribute("download",t+".xlsx"),document.body.appendChild(s),s.click()}).catch(function(e){a.$notify.error("文件下载失败")})},getReportList:function(){var e,t=this;(e={params:{project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/reports/",e).then(function(e){return e.data})).then(function(e){t.reportData=e,t.loading=!1})}},name:"ReportList",mounted:function(){this.getReportList(),this.getpermissions()}},ut={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.reportData.count&&e.permissions.includes("delete"),expression:"reportData.count !== 0 && permissions.includes('delete')"}],staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"mini",title:"批量删除"},on:{click:e.delSelectionReports}},[e._v("批量删除")])],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[a("div",[a("el-row",[a("el-col",{attrs:{span:5}},[a("el-input",{attrs:{placeholder:"请输入报告名称",clearable:"",size:"small"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"small",title:"搜索"},on:{click:e.getReportList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0px",right:"0",left:"230px",top:"150px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},size:"medium","element-loading-text":"正在玩命加载","highlight-current-row":"",data:e.reportData.results,"show-header":0!==e.reportData.results.length,stripe:"",height:"600px","show-overflow-tooltip":""},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{staticStyle:{color:"white"},attrs:{color:"#2C3E50",size:"small"}},[e._v(e._s(t.row.type))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"报告名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:{pass:t.row.summary.success,fail:!t.row.summary.success},domProps:{textContent:e._s(!0===t.row.summary.success?"Pass":"Fail")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"测试时间",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("timestampToTime")(t.row.summary.time.start_at)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用时",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{textContent:e._s(t.row.summary.time.duration.toFixed(3)+" 秒")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"总计",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"small"}},[e._v(e._s(t.row.summary.stat.testsRun))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"通过",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"success",size:"small"}},[e._v(" "+e._s(t.row.summary.stat.successes))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"失败",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"danger",size:"small"}},[e._v(e._s(t.row.summary.stat.failures))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"异常",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"warning",size:"small"}},[e._v(e._s(t.row.summary.stat.errors))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"跳过",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"info",size:"small"}},[e._v(e._s(t.row.summary.stat.skipped))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"系统信息",width:"135",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v(e._s(t.row.summary.platform.python_version))]),e._v(" "),a("p",[e._v("Platform: "+e._s(t.row.summary.platform.platform))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v("HttpRunner: "+e._s(t.row.summary.platform.httprunner_version))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("view")?a("el-button",{attrs:{type:"info",icon:"el-icon-view",circle:"",size:"mini",title:"查看"},on:{click:function(a){return e.handleWatchReports(t.row.id)}}}):e._e(),e._v(" "),e.permissions.includes("view")?a("el-button",{attrs:{type:"success",icon:"el-icon-download",circle:"",size:"mini",title:"下载"},on:{click:function(a){return e.handleDownExcelReport(t.row.id,t.row.name)}}}):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",title:"删除"},on:{click:function(a){return e.handleDelReports(t.row.id)}}}):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.reportData.count,expression:"reportData.count !== 0 "}],staticStyle:{"margin-top":"10px"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.reportData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var dt=a("VU/8")(ct,ut,!1,function(e){a("UMWi")},"data-v-9b4a7dc6",null).exports,pt={props:{save:Boolean,parameters:{require:!1}},computed:{height:function(){return window.screen.height-440}},methods:{parseParameters:function(){var e={parameters:[],desc:{}},t=!0,a=!1,s=void 0;try{for(var n,r=Q()(this.tableData);!(t=(n=r.next()).done);t=!0){var i=n.value,o=i.value,l=i.key,c={};if(""!==l&&""!==o){try{o=JSON.parse(o)}catch(e){}c[l]=o,e.parameters.push(c),e.desc[l]=i.desc}}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){this.tableData.push({key:"",value:"",desc:""})},handleDelete:function(e,t){this.tableData.splice(e,1)}},watch:{save:function(){this.$emit("parameters",this.parseParameters(),this.tableData)},parameters:function(){0!==this.parameters.length&&(this.tableData=this.parameters)}},data:function(){return{currentRow:"",tableData:[{key:"",value:"",desc:""}]}},name:"Parameters"},mt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",height:e.height,data:e.tableData,border:!1,"cell-style":{paddingTop:"4px",paddingBottom:"4px"}},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"数据Key",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8},clearable:"",placeholder:"key 、 key-key1"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"数据内容",width:"700"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8},clearable:"",placeholder:"${ fun() } 、 [ value ] 、 [ [ value1, value2 ] ]"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"参数描述",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"参数简要描述"},model:{value:t.row.desc,callback:function(a){e.$set(t.row,"desc",a)},expression:"scope.row.desc"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.row===e.currentRow,expression:"scope.row === currentRow"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var ht={components:{Headers:Y,Request:oe,Variables:ve,Hooks:_e,Parameters:a("VU/8")(pt,mt,!1,function(e){a("bnnx")},"data-v-60f60816",null).exports},props:{project:{require:!1},response:{require:!1}},watch:{response:function(){this.name=this.response.body.name,this.baseUrl=this.response.body.base_url,this.configdesc=this.response.configdesc,this.id=this.response.id}},methods:{handleHeader:function(e){this.header=e},handleRequest:function(e){this.request=e},handleVariables:function(e){this.variables=e},handleHooks:function(e){this.hooks=e},handleParameters:function(e){this.parameters=e,""===this.id?this.addConfig():this.updateConfig()},addConfig:function(){var e,t=this;this.validateData()&&(e={parameters:this.parameters,header:this.header,request:this.request,variables:this.variables,hooks:this.hooks,base_url:this.baseUrl,configdesc:this.configdesc,name:this.name,project:this.project},p.a.post("/api/testrunner/config/",e).then(function(e){return e.data})).then(function(e){e.success?t.$emit("addSuccess"):t.$message.error({message:e.msg,duration:1e3})})},updateConfig:function(){var e,t,a=this;this.validateData()&&(e=this.id,t={parameters:this.parameters,header:this.header,request:this.request,variables:this.variables,hooks:this.hooks,base_url:this.baseUrl,configdesc:this.configdesc,name:this.name},p.a.patch("/api/testrunner/config/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.success?a.$emit("addSuccess"):a.$message.error({message:e.msg,duration:1e3})})},validateData:function(){return""!==this.name||(this.$notify.error({title:"参数错误",message:"配置名称不能为空",duration:1500}),!1)}},data:function(){return{name:"",baseUrl:"",configdesc:"",id:"",header:[],request:[],variables:[],hooks:[],parameters:[],save:!1,activeTag:"third"}},name:"ConfigBody"},ft={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"10px"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入配置名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[a("template",{slot:"prepend"},[e._v("配置信息录入")]),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:function(t){e.save=!e.save}},slot:"append"},[e._v("保存\n            ")])],2)],1),e._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入 base_url 地址",clearable:""},model:{value:e.baseUrl,callback:function(t){e.baseUrl=t},expression:"baseUrl"}},[a("template",{slot:"prepend"},[e._v("配置请求地址")])],2)],1),e._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入配置描述信息",clearable:""},model:{value:e.configdesc,callback:function(t){e.configdesc=t},expression:"configdesc"}},[a("template",{slot:"prepend"},[e._v("配置描述信息")])],2)],1),e._v(" "),a("div",{staticClass:"request"},[a("el-tabs",{staticStyle:{"margin-left":"20px"},model:{value:e.activeTag,callback:function(t){e.activeTag=t},expression:"activeTag"}},[a("el-tab-pane",{attrs:{label:"请求头",name:"first"}},[a("headers",{attrs:{save:e.save,header:e.response?e.response.body.header:[]},on:{header:e.handleHeader}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"请求体",name:"second"}},[a("request",{attrs:{save:e.save,request:e.response?e.response.body.request:[]},on:{request:e.handleRequest}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"变量设置",name:"third"}},[a("variables",{attrs:{save:e.save,variables:e.response?e.response.body.variables:[]},on:{variables:e.handleVariables}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"前后置方法设置",name:"fourth"}},[a("hooks",{attrs:{save:e.save,hooks:e.response?e.response.body.hooks:[]},on:{hooks:e.handleHooks}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"数据驱动参数设置",name:"five"}},[a("parameters",{attrs:{save:e.save,parameters:e.response?e.response.body.parameters:[]},on:{parameters:e.handleParameters}})],1)],1)],1)])},staticRenderFns:[]};var vt=a("VU/8")(ht,ft,!1,function(e){a("ySMl")},"data-v-86388d0e",null).exports,gt={name:"ConfigList",props:{back:Boolean,project:{require:!0},permissions:{require:!0},del:Boolean},data:function(){return{search:"",selectConfig:[],currentRow:"",currentPage:1,configdes:"",configData:{count:0,results:[]}}},watch:{back:function(){this.getConfigList()},del:function(){var e=this;0!==this.selectConfig.length?this.$confirm("此操作将永久删除配置，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectConfig},p.a.delete("/api/testrunner/config/",t).then(function(e){return e.data})).then(function(t){e.getConfigList()})}):this.$notify.warning({title:"提示",message:"请至少勾选一个配置",duration:1e3})}},methods:{handleSelectionChange:function(e){this.selectConfig=e},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.project,search:this.search}},p.a.get("/api/testrunner/config/",t).then(function(e){return e.data})).then(function(e){a.configData=e})},handleDelConfig:function(e){var t=this;this.$confirm("此操作将永久删除该配置，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/config/"+a+"/").then(function(e){return e.data})).then(function(e){t.getConfigList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},handleEditConfig:function(e){this.$emit("respConfig",e)},handleCopyConfig:function(e){var t=this;this.$prompt("请输入配置名称","提示",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"配置名称不能为空"}).then(function(a){var s,n,r=a.value;(s=e,n={name:r},p.a.post("/api/testrunner/config/"+s+"/",n).then(function(e){return e.data})).then(function(e){t.getConfigList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},getConfigList:function(){var e,t=this;(e={params:{project:this.project,search:this.search}},p.a.get("/api/testrunner/config/",e).then(function(e){return e.data})).then(function(e){t.configData=e})}},mounted:function(){this.getConfigList()}},bt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{"padding-top":"10px",height:"50px",padding:"0"}},[a("div",[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入配置名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getConfigList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"150px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.configData.results,"show-header":0!==e.configData.results.length,stripe:"",height:"75%"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"配置名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"基本请求地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{textContent:e._s(""===t.row.base_url?"无":t.row.base_url)}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:t.row.configdesc}},[e._v(e._s(t.row.configdesc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditConfig(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleCopyConfig(t.row.id)}}},[e._v("复制\n                                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelConfig(t.row.id)}}},[e._v("删除\n                                ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.configData.count,expression:"configData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.configData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)},staticRenderFns:[]};var _t={components:{ConfigBody:vt,ConfigList:a("VU/8")(gt,bt,!1,function(e){a("7Xnb")},"data-v-a4818348",null).exports},computed:{initResponse:{get:function(){return this.addConfigActivate},set:function(e){this.addConfigActivate=e,this.respConfig={id:"",body:{name:"",base_url:"",confdesc:"",header:[{key:"",value:"",desc:""}],request:{data:[{key:"",value:"",desc:"",type:1}],params:[{key:"",value:"",desc:"",type:1}],json_data:""},variables:[{key:"",value:"",desc:"",type:1}],hooks:[{setup:"",teardown:""}],parameters:[{key:"",value:"",desc:""}]}}}}},data:function(){return{permissions:[],back:!1,del:!1,addConfigActivate:!1,respConfig:""}},methods:{handleAddSuccess:function(){this.back=!this.back,this.addConfigActivate=!1},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"config"}).then(function(t){e.permissions=t.permissions})},handleRespConfig:function(e){this.respConfig=e,this.addConfigActivate=!0}},name:"RecordConfig",mounted:function(){this.getpermissions()}},yt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.initResponse=!0}}},[e._v("新增配置\n                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){e.del=!e.del}}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:!e.addConfigActivate,type:"text"},on:{click:function(t){e.addConfigActivate=!1}}},[e._v("返回列表")])],1)])]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"20px"}},[a("config-body",{directives:[{name:"show",rawName:"v-show",value:e.addConfigActivate,expression:"addConfigActivate"}],attrs:{project:e.$route.params.id,response:e.respConfig},on:{addSuccess:e.handleAddSuccess}}),e._v(" "),e.addConfigActivate?e._e():a("config-list",{attrs:{permissions:e.permissions,project:e.$route.params.id,del:e.del,back:e.back},on:{respConfig:e.handleRespConfig}})],1)],1)],1)},staticRenderFns:[]};var wt=a("VU/8")(_t,yt,!1,function(e){a("pTcj")},null,null).exports,xt={components:{},props:{next:Boolean,testCase:{require:!0}},methods:{emitKwargsForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$emit("KwargsForm",t.kwargsForm)})},getHost:function(){var e=this;this.$api.hostList({params:{project:this.$route.params.id}}).then(function(t){e.hostOptions=t.data.results,e.hostOptions.push({name:"请选择"})})},getTestData:function(){var e=this;this.$api.testdataList({params:{project:this.$route.params.id}}).then(function(t){e.excelTreeOptions=[];var a=!0,s=!1,n=void 0;try{for(var r,i=Q()(t.results);!(a=(r=i.next()).done);a=!0){var o=r.value;o.excel_tree&&e.excelTreeOptions.push(o.excel_tree)}}catch(e){s=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw n}}})}},watch:{esc:function(){this.$emit("escEdit")}},data:function(){return{excelTreeOptions:[],esc:!1,hostOptions:[],testCaseName:this.testCase.name,kwargsForm:{testCaseName:"",hostInfo:"",excelTreeData:""},rules:{testCaseName:[{required:!0,message:"请输入用例名称",trigger:"blur"},{min:1,max:500,message:"长度在 1 到 500 个字符",trigger:"blur"}]}}},name:"EditTestCase",mounted:function(){this.getHost(),this.getTestData(),this.testCase.kwargs&&(this.kwargsForm=this.testCase.kwargs)}},kt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",{staticStyle:{"padding-top":"0"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"kwargsForm",attrs:{model:e.kwargsForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用例名称",prop:"testCaseName"}},[a("el-input",{attrs:{placeholder:"请输入用例名称",clearable:"",size:"medium",type:"textarea",autosize:{minRows:1,maxRows:8}},model:{value:e.kwargsForm.testCaseName,callback:function(t){e.$set(e.kwargsForm,"testCaseName",t)},expression:"kwargsForm.testCaseName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"域名参数"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.kwargsForm.hostInfo,callback:function(t){e.$set(e.kwargsForm,"hostInfo",t)},expression:"kwargsForm.hostInfo"}},e._l(e.hostOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"数据选择",width:"300px"}},[a("el-cascader",{staticStyle:{width:"50%"},attrs:{options:e.excelTreeOptions,"collapse-tags":"",placeholder:"试试搜索",clearable:"",filterable:"",size:"medium"},model:{value:e.kwargsForm.excelTreeData,callback:function(t){e.$set(e.kwargsForm,"excelTreeData",t)},expression:"kwargsForm.excelTreeData"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.esc=!e.esc}}},[e._v("返回")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.emitKwargsForm("kwargsForm")}}},[e._v("保存")])],1)],1)],1)],1)])},staticRenderFns:[]};var Ct=function(e,t){return p()({url:"/api/testrunner/schedule/",method:"POST",params:e,data:t})},St=function(e,t){return p()({url:"/api/testrunner/schedule/",method:"POST",params:e,data:t})},Tt=function(e,t,a){return p()({url:"/api/testrunner/schedule/"+e+"/",method:"PATCH",params:t,data:a})},Ft=function(e){return p.a.get("/api/testrunner/schedule/",e).then(function(e){return e.data})},$t=function(e){var t="/api/testrunner/schedule/?page="+e.params.page+"&project="+e.params.project;return p.a.get(t).then(function(e){return e.data})},Dt=function(e,t){return p.a.delete("/api/testrunner/schedule/"+e+"/",t)},Vt=function(e,t){return p.a.delete("/api/testrunner/schedule/del/",{params:e,data:t})},Pt=function(e,t){return p.a.get("/api/testrunner/run_schedule_test/"+e+"/",t)},Nt={name:"AddTasks",props:{ruleForm:{require:!0},args:{require:!0},scheduleId:{require:!0}},watch:{filterText:function(e){this.$refs.tree2.filter(e)}},components:{EditTestCase:a("VU/8")(xt,kt,!1,function(e){a("4ZFM")},"data-v-f4366014",null).exports,draggable:He.a},data:function(){return{drag:!1,currentTest:"",length:0,currentSuite:"",myargs:this.args,search:"",next:!1,listPageShow:!0,node:"",currentPage:1,filterText:"",expand:"&#xe65f;",dataTree:[],suiteData:{count:0,results:[]},rules:{name:[{required:!0,message:"请输入任务名称",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],crontab:[{required:!0,message:"请输入正确的crontab表达式",trigger:"blur"}],receiver:[{required:!0,message:"请输入邮箱，邮箱不能为空"}]},editTestCaseActivate:!1}},methods:{onStart:function(){this.drag=!0},onEnd:function(){this.drag=!1},handleEditTestCase:function(){this.editTestCaseActivate=!0,this.next=!1},saveTask:function(){var e=this,t=this.ruleForm;t.data=this.myargs,t.project=this.$route.params.id,""===this.scheduleId?Ct({project:this.$route.params.id,tasktype:"API"},t).then(function(t){201===t.status&&(e.$notify.success("添加定时任务成功"),e.$emit("changeStatus",!1),e.currentPage=1)}):Tt(this.scheduleId,{project:this.$route.params.id,tasktype:"API"},t).then(function(t){200===t.status&&(e.$notify.success("更新定时任务成功"),e.$emit("changeStatus",!1),e.currentPage=1)})},dragEnd:function(e){this.myargs.length>this.length&&this.myargs.splice(this.length,1)},drop:function(e){e.preventDefault(),this.myargs.push(this.currentSuite)},allowDrop:function(e){e.preventDefault()},handlePageChange:function(e){var t=this;Qe({params:{page:this.currentPage,node:this.node,project:this.$route.params.id,tag:"",search:""}}).then(function(e){t.suiteData=e})},handleCurrentChange:function(e){var t=this;Qe({params:{page:this.currentPage,project:this.$route.params.id,node:this.node,tag:"",search:this.search}}).then(function(e){t.suiteData=e})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.next=!0})},resetForm:function(e){this.$refs[e].resetFields()},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:2}}).then(function(t){e.dataTree=t.tree})},handleNodeClick:function(e){this.node=e.id,this.getTestList()},getTestList:function(){var e=this;Ze({params:{project:this.$route.params.id,node:this.node,tag:"",search:this.search}}).then(function(t){e.suiteData=t})}},mounted:function(){this.getTree(),this.getTestList()}},Rt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[e.next?e._e():[a("el-main",{staticStyle:{"padding-top":"0"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入任务名称",clearable:""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"时间配置",prop:"crontab"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入crontab表达式，例如 2 12 * * *"},model:{value:e.ruleForm.crontab,callback:function(t){e.$set(e.ruleForm,"crontab",t)},expression:"ruleForm.crontab"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务状态",prop:"switch"}},[a("el-switch",{model:{value:e.ruleForm.switch,callback:function(t){e.$set(e.ruleForm,"switch",t)},expression:"ruleForm.switch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"推送企业微信",prop:"iswecatsend"}},[a("el-radio-group",{model:{value:e.ruleForm.iswecatsend,callback:function(t){e.$set(e.ruleForm,"iswecatsend",t)},expression:"ruleForm.iswecatsend"}},[a("el-radio",{attrs:{label:!0}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.ruleForm.iswecatsend,expression:"ruleForm.iswecatsend"}],attrs:{label:"Webhook",prop:"webhook"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入企业微信机器人的webhook地址",clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.webhook,callback:function(t){e.$set(e.ruleForm,"webhook",t)},expression:"ruleForm.webhook"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮件策略",prop:"strategy"}},[a("el-radio-group",{model:{value:e.ruleForm.strategy,callback:function(t){e.$set(e.ruleForm,"strategy",t)},expression:"ruleForm.strategy"}},[a("el-radio",{attrs:{label:"始终发送"}}),e._v(" "),a("el-radio",{attrs:{label:"仅失败发送"}}),e._v(" "),a("el-radio",{attrs:{label:"从不发送"}}),e._v(" "),a("el-radio",{attrs:{label:"监控邮件"}})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"监控邮件"===e.ruleForm.strategy,expression:"ruleForm.strategy === '监控邮件'"}],attrs:{label:"报警次数",prop:"fail_count"}},[a("el-input-number",{attrs:{min:1,max:20,size:"small",precision:0},model:{value:e.ruleForm.fail_count,callback:function(t){e.$set(e.ruleForm,"fail_count",t)},expression:"ruleForm.fail_count"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"监控邮件"===e.ruleForm.strategy,expression:"ruleForm.strategy === '监控邮件'"}],attrs:{label:"关键字过滤",prop:"self_error"}},[a("el-input",{attrs:{type:"textarea",placeholder:'若用例失败的返回报错含有关键字则视为用例通过，多个关键字以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.self_error,callback:function(t){e.$set(e.ruleForm,"self_error",t)},expression:"ruleForm.self_error"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"敏感字过滤",prop:"sensitive_keys"}},[a("el-input",{attrs:{type:"textarea",placeholder:'将敏感字处理为******，多个敏感字以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.sensitive_keys,callback:function(t){e.$set(e.ruleForm,"sensitive_keys",t)},expression:"ruleForm.sensitive_keys"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"接收邮箱",prop:"receiver"}},[a("el-input",{attrs:{type:"textarea",placeholder:'多个邮箱以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.receiver,callback:function(t){e.$set(e.ruleForm,"receiver",t)},expression:"ruleForm.receiver"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"抄送邮箱",prop:"mail_cc"}},[a("el-input",{attrs:{type:"textarea",placeholder:'多个邮箱以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.mail_cc,callback:function(t){e.$set(e.ruleForm,"mail_cc",t)},expression:"ruleForm.mail_cc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("下一步")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)])],e._v(" "),e.next?[a("el-aside",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}],null,!1,1890694903)})],1)])]),e._v(" "),a("el-main",{staticStyle:{"padding-top":"0px"}},[a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.suiteData.count,expression:"suiteData.count !== 0"}],staticStyle:{"text-align":"center"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.suiteData.count},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),e._v(" "),a("el-col",{attrs:{span:12}},[e.args.length>0?a("el-button",{attrs:{type:"primary"},on:{click:e.saveTask}},[e._v("保存")]):e._e(),e._v(" "),e.args.length>0?a("el-button",{on:{click:function(t){e.next=!1}}},[e._v("上一步")]):e._e()],1)],1)],1),e._v(" "),a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},e._l(e.suiteData.results,function(t,s){return a("div",{key:s,staticStyle:{cursor:"pointer","margin-top":"10px",overflow:"auto"},attrs:{draggable:"true"},on:{dragstart:function(a){e.currentSuite=JSON.parse(JSON.stringify(t))}}},[a("div",{staticClass:"block block_options"},[a("span",{staticClass:"block-method block_method_options block_method_color"},[e._v("Case")]),e._v(" "),t.create_user?a("span",{staticClass:"block-test-name"},[e._v(e._s(t.name)+" 创建人："+e._s(t.create_user))]):e._e(),e._v(" "),null==t.create_user?a("span",{staticClass:"block-test-name"},[e._v(e._s(t.name))]):e._e()])])}),0),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{"max-height":"600px",overflow:"auto"},on:{drop:function(t){return e.drop(t)},dragover:function(t){return e.allowDrop(t)}}},[0===e.myargs.length?a("span",{staticStyle:{color:"red"}},[e._v("温馨提示："),a("br"),e._v("选择左侧相应用例节点显示可拖拽的用例"),a("br"),e._v("从左边拖拽用例至此区域组成任务列表"),a("br"),e._v("\n                                上下拖动此区域任务调整监控调用顺序\n                            ")]):e._e(),e._v(" "),a("div",{staticClass:"test-list"},[a("draggable",{attrs:{group:"test",sort:!0,"force-fallback":"true",animation:"200"},on:{start:e.onStart,end:e.onEnd},model:{value:e.myargs,callback:function(t){e.myargs=t},expression:"myargs"}},e._l(e.myargs,function(t,s){return a("div",{key:s,staticClass:"block block_test",on:{mousemove:function(t){e.currentTest=s}}},[a("span",{staticClass:"block-method block_method_test block_method_color"},[e._v("Tasks")]),e._v(" "),t.create_user?a("span",{staticClass:"block-test-name"},[e._v(e._s(t.name)+"  创建人："+e._s(t.create_user))]):e._e(),e._v(" "),null==t.create_user?a("span",{staticClass:"block-test-name"},[e._v(e._s(t.name))]):e._e(),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"12px",top:"8px"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.myargs.splice(s,1)}}})],1)}),0)],1)])])],1)],1)])]:e._e(),e._v(" "),[e.editTestCaseActivate?a("edit-test-case",{attrs:{testCase:e.args[e.currentTest],next:e.next},on:{escEdit:function(t){e.editTestCaseActivate=!1,e.next=!0},KwargsForm:e.handleNewTestCase}}):e._e()]],2)},staticRenderFns:[]};var jt={components:{AddTasks:a("VU/8")(Nt,Rt,!1,function(e){a("Ka8N")},"data-v-400d90ac",null).exports},data:function(){return{addTasks:!1,currentPage:1,currentRow:"",tasksData:{count:0,results:[]},permissions:[],loading:!0,ruleForm:{switch:!0,crontab:"",strategy:"始终发送",receiver:"",mail_cc:"",name:"",tasktype:"API",iswecatsend:!0,webhook:"",sensitive_keys:"",self_error:"",fail_count:1},args:[],scheduleId:"",selectTasks:[]}},methods:{handleAddTask:function(){this.addTasks=!0,this.scheduleId="",this.ruleForm={switch:!0,crontab:"",strategy:"始终发送",receiver:"",mail_cc:"",name:"",tasktype:"API",iswecatsend:!1,webhook:"",sensitive_keys:"",self_error:"",fail_count:1},this.args=[]},getpermissions:function(){var e=this;b({app_label:"djcelery",model:"periodictask"}).then(function(t){e.permissions=t.permissions})},handleSelectionChange:function(e){this.selectTasks=e},handleCopySchedule:function(e){var t=this;this.$prompt("请输入定时任务名称","提示",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"定时任务名称不能为空"}).then(function(a){var s=a.value;St({project:t.$route.params.id,tasktype:"API"},{tasktype:"API",name:s,id:e}).then(function(e){201===e.status&&t.$notify.success("复制定时任务成功"),t.getTaskList(),t.currentPage=1})})},delTasks:function(e){var t=this;this.$confirm("此操作将永久删除该定时任务，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Dt(e,{params:{project:t.$route.params.id,tasktype:"API"}}).then(function(e){204===e.status&&t.$notify.success("删除定时任务成功"),t.getTaskList(),t.currentPage=1})})},delselectTasks:function(){var e=this;0!==this.selectTasks.length?this.$confirm("此操作将永久删除选中定时任务，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Vt({project:e.$route.params.id,tasktype:"API"},e.selectTasks).then(function(t){204===t.status&&e.$notify.success("批量删除定时任务成功"),e.getTaskList(),e.currentPage=1})}):this.$notify.error("没有勾选定时任务")},handleRunSchedule:function(e){var t=this;this.$confirm("此操作将运行此定时任务并发送邮件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0,Pt(e,{params:{tasktype:"API"}}).then(function(e){t.$notify.success("执行成功，请稍后查看报告以及邮件"),t.loading=!1})})},handleCurrentChange:function(e){var t=this;$t({params:{page:this.currentPage,project:this.$route.params.id}}).then(function(e){t.tasksData=e})},handleEditSchedule:function(e,t){this.addTasks=!0,this.scheduleId=e,this.ruleForm.crontab=t.summary_kwargs.crontab,this.ruleForm.strategy=t.summary_kwargs.strategy,this.ruleForm.iswecatsend=t.summary_kwargs.iswecatsend,this.ruleForm.webhook=t.summary_kwargs.webhook,this.ruleForm.receiver=t.summary_kwargs.receiver,this.ruleForm.mail_cc=t.summary_kwargs.mail_cc,this.ruleForm.fail_count=t.summary_kwargs.fail_count,this.ruleForm.self_error=t.summary_kwargs.self_error,this.ruleForm.sensitive_keys=t.summary_kwargs.sensitive_keys,this.ruleForm.name=t.name,this.ruleForm.switch=t.enabled,this.args=t.summary_args,this.testData=t.summary_args},changeStatus:function(e){this.getTaskList(),this.currentPage=1,this.addTasks=e,this.args=[],this.ruleForm={switch:!0,crontab:"",strategy:"始终发送",receiver:"",mail_cc:"",tasktype:"API",iswecatsend:!0,webhook:"",name:"",self_error:"",fail_count:"",sensitive_keys:""}},getTaskList:function(){var e=this;Ft({params:{project:this.$route.params.id,tasktype:"API"}}).then(function(t){e.tasksData=t,e.loading=!1})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""}},name:"Tasks",mounted:function(){this.getTaskList(),this.getpermissions()}},Lt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline",disabled:e.addTasks},on:{click:e.handleAddTask}},[e._v("添加任务\n                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",icon:"el-icon-delete",size:"mini",title:"批量删除",disabled:e.addTasks},on:{click:e.delselectTasks}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:!e.addTasks,type:"text"},on:{click:function(t){e.addTasks=!1}}},[e._v("返回列表\n                ")])],1)])]),e._v(" "),a("el-container",[e.addTasks?e._e():a("el-header",{staticStyle:{padding:"0",height:"50px","margin-top":"10px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"30px"}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.tasksData.count,expression:"tasksData.count !== 0 "}],attrs:{"page-size":5,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.tasksData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)]),e._v(" "),a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",[e.addTasks?e._e():a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},height:"75%","AddTasks.vue":"","element-loading-text":"正在玩命加载",data:e.tasksData.results,"show-header":0!==e.tasksData.results.length,stripe:"","highlight-current-row":""},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}],null,!1,1281056470)}),e._v(" "),a("el-table-column",{attrs:{width:"120",label:"时间配置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.crontab))])]}}],null,!1,3364208848)}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"邮件策略"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.strategy))])]}}],null,!1,3379139436)}),e._v(" "),a("el-table-column",{attrs:{width:"110",label:"企业微信推送"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.summary_kwargs.iswecatsend?a("div",[e._v("是")]):e._e(),e._v(" "),0==t.row.summary_kwargs.iswecatsend?a("div",[e._v("否")]):e._e()]}}],null,!1,987044690)}),e._v(" "),a("el-table-column",{attrs:{width:"80",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:"","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"scope.row.enabled"}})]}}],null,!1,1078573297)}),e._v(" "),a("el-table-column",{attrs:{label:"接收人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.receiver))])]}}],null,!1,2122237646)}),e._v(" "),a("el-table-column",{attrs:{label:"抄送人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.mail_cc))])]}}],null,!1,137736545)}),e._v(" "),a("el-table-column",{attrs:{width:"200",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("add")?a("el-button",{attrs:{type:"success",icon:"el-icon-document",circle:"",size:"mini",title:"复制"},on:{click:function(a){return e.handleCopySchedule(t.row.id)}}}):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",title:"删除"},on:{click:function(a){return e.delTasks(t.row.id)}}}):e._e()],1)]}}],null,!1,553092315)})],1)],1)]),e._v(" "),e.addTasks?a("add-tasks",{attrs:{ruleForm:e.ruleForm,args:e.args,scheduleId:e.scheduleId},on:{changeStatus:e.changeStatus}}):e._e()],1)],1)},staticRenderFns:[]};var Et=a("VU/8")(jt,Lt,!1,function(e){a("C1ID")},null,null).exports,It={data:function(){return{search:"",permissions:[],currentRow:"",currentPage:1,hostIPData:{count:0,results:[]},editdialogVisible:!1,dialogVisible:!1,variablesForm:{name:"",value:"",project:this.$route.params.id},editVariablesForm:{name:"",value:"",id:""},rules:{name:[{required:!0,message:"请输入变量名",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}],value:[{required:!0,message:"请输入变量值",trigger:"blur"}]}}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEditHostIP:function(e){this.editVariablesForm={name:e.name,value:e.value,id:e.id},this.editdialogVisible=!0},handleDelHost:function(e){var t=this;this.$confirm("此操作将永久删除该域名，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/host_ip/"+a+"/").then(function(e){return e.data})).then(function(e){t.getHostIPList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error(e.msg)})})},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.variablesForm.project}},p.a.get("/api/testrunner/host_ip/",t).then(function(e){return e.data})).then(function(e){a.hostIPData=e})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.dialogVisible=!1,(a=t.variablesForm,p.a.post("/api/testrunner/host_ip/",a).then(function(e){return e.data})).then(function(e){e.success?(t.variablesForm.name="",t.variablesForm.value="",t.getHostIPList(),t.currentPage=1,t.$message.success(e.msg)):t.$message.error({message:e.msg,duration:1e3})}))})},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"hostip"}).then(function(t){e.permissions=t.permissions})},handleEditConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a,s;e&&(t.editdialogVisible=!1,(a=t.editVariablesForm.id,s=t.editVariablesForm,p.a.patch("/api/testrunner/host_ip/"+a+"/",s).then(function(e){return e.data})).then(function(e){t.getHostIPList(),t.currentPage=1,e.success?t.$message.success(e.msg):t.$message.error({message:e.msg,duration:1e3})}))})},getHostIPList:function(){var e,t=this;(e={params:{project:this.variablesForm.project}},p.a.get("/api/testrunner/host_ip/",e).then(function(e){return e.data})).then(function(e){t.hostIPData=e})}},name:"HostAddress",mounted:function(){this.getHostIPList(),this.getpermissions()}},At={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新增环境\n                    ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"添加环境",visible:e.dialogVisible,width:"35%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"variablesForm",staticClass:"project",attrs:{model:e.variablesForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"环境名",prop:"name"}},[a("el-input",{attrs:{resize:"",clearable:"",placeholder:"请输入环境名"},model:{value:e.variablesForm.name,callback:function(t){e.$set(e.variablesForm,"name",t)},expression:"variablesForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"IP列表",prop:"value"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:16},placeholder:"127.0.0.1 localhost\n192.168.0.1 gateway",clearable:""},model:{value:e.variablesForm.value,callback:function(t){e.$set(e.variablesForm,"value",t)},expression:"variablesForm.value"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("variablesForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑环境",visible:e.editdialogVisible,width:"35%",align:"center"},on:{"update:visible":function(t){e.editdialogVisible=t}}},[a("el-form",{ref:"editVariablesForm",staticClass:"project",attrs:{model:e.editVariablesForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"环境名",prop:"name"}},[a("el-input",{attrs:{resize:"",clearable:"",placeholder:"请输入环境名"},model:{value:e.editVariablesForm.name,callback:function(t){e.$set(e.editVariablesForm,"name",t)},expression:"editVariablesForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"IP列表",prop:"value"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:16},placeholder:"127.0.0.1 localhost\n192.168.0.1 gateway",clearable:""},model:{value:e.editVariablesForm.value,callback:function(t){e.$set(e.editVariablesForm,"value",t)},expression:"editVariablesForm.value"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditConfirm("editVariablesForm")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}}),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"100px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.hostIPData.results,"show-header":0!==e.hostIPData.results.length,stripe:"",height:"calc(75%)"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[a("el-table-column",{attrs:{label:"环境名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Host列表"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:5},clearable:"",disabled:""},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditHostIP(t.row)}}},[e._v("编辑\n                                        ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.hostIPData.count,expression:"hostIPData.count !== 0"}],attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelHost(t.row.id)}}},[e._v("删除\n                                        ")]):e._e()],1)]}}])})],1),e._v(" "),a("div",{staticStyle:{"padding-top":"8px","padding-left":"30px",overflow:"hidden"}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.hostIPData.count,expression:"hostIPData.count !== 0 "}],attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.hostIPData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var Bt=a("VU/8")(It,At,!1,function(e){a("e8Yq")},null,null).exports,qt={name:"DataBase",data:function(){return{editVisible:!1,dialogVisible:!1,dataBaseData:{results:[]},permissions:[],dataBaseForm:{name:"",desc:"",server:"",account:"",password:"",type:1,id:"",project:this.$route.params.id},tags:[{name:"PA",value:1},{name:"MySQL",value:2}],rules:{name:[{required:!0,message:"请输入数据库名称",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],server:[{required:!0,message:"请输入数据库访问地址",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],account:[{required:!0,message:"请输入登陆账号",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],password:[{required:!0,message:"请输入登陆密码",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],desc:[{required:!0,message:"请简要描述下该数据库",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}]}}},methods:{handleEdit:function(e,t){this.editVisible=!0,this.dataBaseForm.name=t.name,this.dataBaseForm.desc=t.desc,this.dataBaseForm.id=t.id,this.dataBaseForm.server=t.server,this.dataBaseForm.type=t.type,this.dataBaseForm.account=t.account,this.dataBaseForm.password=t.password},handleDelete:function(e,t){var a=this;this.$confirm("此操作将永久删除该数据库, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e;(e=t.id,p.a.delete("/api/testrunner/databaseconfig/"+e+"/").then(function(e){return e.data})).then(function(e){e.success?a.success("数据库删除成功"):a.$message.error(e.msg),a.getDataBaseList()}).catch(function(e){a.failure(e)})})},cancelaction:function(){""!==this.dataBaseForm.id?this.editVisible=!1:this.dialogVisible=!1,this.dataBaseForm.name="",this.dataBaseForm.desc="",this.dataBaseForm.id="",this.dataBaseForm.account="",this.dataBaseForm.password="",this.dataBaseForm.server="",this.dataBaseForm.type=1,this.getDataBaseList()},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"databaseconfig"}).then(function(t){e.permissions=t.permissions})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return""!==t.dataBaseForm.id?t.editVisible=!0:t.dialogVisible=!0,!1;t.dialogVisible=!1,t.editVisible=!1;var a,s=void 0;""===t.dataBaseForm.id?(a=t.dataBaseForm,s=p.a.post("/api/testrunner/databaseconfig/",a).then(function(e){return e.data})):s=function(e,t){return p.a.put("/api/testrunner/databaseconfig/"+e+"/",t).then(function(e){return e.data})}(t.dataBaseForm.id,t.dataBaseForm),s.then(function(e){console.log(e.name),e.name===t.dataBaseForm.name?t.success(e.name+"数据库操作成功"):e.success?t.$message.success(e.msg):t.$message.error(e.msg),t.dataBaseForm.name="",t.dataBaseForm.desc="",t.dataBaseForm.id="",t.dataBaseForm.account="",t.dataBaseForm.password="",t.dataBaseForm.server="",t.dataBaseForm.type=1,t.getDataBaseList()}).catch(function(e){t.failure(e)})})},success:function(e){this.$notify({message:e,type:"success",duration:1e3})},failure:function(e){this.$notify.error({message:e,duration:1e3})},getDataBaseList:function(){var e=this;ye(this.$route.params.id).then(function(t){e.dataBaseData=t})},getPagination:function(e){var t=this;(function(e){return p.a.get(e).then(function(e){return e.data})})(e).then(function(e){t.dataBaseData=e})}},mounted:function(){this.getDataBaseList(),this.getpermissions()}},zt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#F7F7F7",padding:"0",height:"50px"}},[a("div",{staticClass:"apiData"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n                    添加数据库\n                ")]):e._e(),e._v(" "),a("el-button",{staticStyle:{"margin-left":"50px"},attrs:{type:"info",round:"",size:"small",icon:"el-icon-d-arrow-left",disabled:null===e.dataBaseData.previous},on:{click:function(t){return e.getPagination(e.dataBaseData.previous)}}},[e._v("\n                    上一页\n                ")]),e._v(" "),a("el-button",{attrs:{type:"info",round:"",size:"small",disabled:null===e.dataBaseData.next},on:{click:function(t){return e.getPagination(e.dataBaseData.next)}}},[e._v("\n                    下一页\n                    "),a("i",{staticClass:"el-icon-d-arrow-right"})]),e._v(" "),a("el-dialog",{attrs:{title:"添加数据库",visible:e.dialogVisible,width:"40%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticStyle:{"padding-bottom":"10px",cursor:"pointer"},attrs:{id:"db_type"}},[a("el-radio-group",{model:{value:e.dataBaseForm.type,callback:function(t){e.$set(e.dataBaseForm,"type",t)},expression:"dataBaseForm.type"}},e._l(e.tags,function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.name)+"\n                            ")])}),1)],1),e._v(" "),a("el-form",{ref:"dataBaseForm",attrs:{model:e.dataBaseForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"数据库名称",prop:"name"}},[a("el-input",{model:{value:e.dataBaseForm.name,callback:function(t){e.$set(e.dataBaseForm,"name",t)},expression:"dataBaseForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"访问地址",prop:"server"}},[a("el-input",{model:{value:e.dataBaseForm.server,callback:function(t){e.$set(e.dataBaseForm,"server",t)},expression:"dataBaseForm.server"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登陆账号",prop:"account"}},[a("el-input",{model:{value:e.dataBaseForm.account,callback:function(t){e.$set(e.dataBaseForm,"account",t)},expression:"dataBaseForm.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登陆密码",prop:"password"}},[a("el-input",{model:{value:e.dataBaseForm.password,callback:function(t){e.$set(e.dataBaseForm,"password",t)},expression:"dataBaseForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"简要描述",prop:"desc"}},[a("el-input",{model:{value:e.dataBaseForm.desc,callback:function(t){e.$set(e.dataBaseForm,"desc",t)},expression:"dataBaseForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancelaction()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("dataBaseForm")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},data:e.dataBaseData.results,border:"",stripe:"","highlight-current-row":"","show-header":e.dataBaseData.results.length>0}},[a("el-table-column",{attrs:{label:"数据库名称",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?a("el-tag",{attrs:{type:""}},[e._v("PA")]):e._e(),e._v(" "),2===t.row.type?a("el-tag",{attrs:{type:"success"}},[e._v("MySQL")]):e._e(),e._v(" "),a("span",{staticStyle:{"margin-left":"10px","font-size":"18px","font-weight":"bold"}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"访问地址",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{staticStyle:{"font-size":"16px"},attrs:{type:"info"}},[e._v(e._s(t.row.server))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用户名/密码",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{staticStyle:{"font-size":"16px"},attrs:{type:"info"}},[e._v(e._s(t.row.account)+" / "+e._s(t.row.password))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{staticStyle:{"font-size":"16px"},attrs:{type:"info"}},[e._v(e._s(t.row.desc))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.permissions.includes("change")?a("el-button",{attrs:{size:"medium"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑\n                        ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"编辑数据库",visible:e.editVisible,width:"40%",align:"center"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"formName",attrs:{model:e.dataBaseForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"数据库名称",prop:"name"}},[a("el-input",{model:{value:e.dataBaseForm.name,callback:function(t){e.$set(e.dataBaseForm,"name",t)},expression:"dataBaseForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"访问地址",prop:"server"}},[a("el-input",{model:{value:e.dataBaseForm.server,callback:function(t){e.$set(e.dataBaseForm,"server",t)},expression:"dataBaseForm.server"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登陆账号",prop:"account"}},[a("el-input",{model:{value:e.dataBaseForm.account,callback:function(t){e.$set(e.dataBaseForm,"account",t)},expression:"dataBaseForm.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登陆密码",prop:"password"}},[a("el-input",{model:{value:e.dataBaseForm.password,callback:function(t){e.$set(e.dataBaseForm,"password",t)},expression:"dataBaseForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"简要描述",prop:"desc"}},[a("el-input",{model:{value:e.dataBaseForm.desc,callback:function(t){e.$set(e.dataBaseForm,"desc",t)},expression:"dataBaseForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancelaction()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("formName")}}},[e._v("确 定")])],1)],1),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n                        ")]):e._e()]}}])})],1)],1)],1)],1)},staticRenderFns:[]};var Ut=a("VU/8")(qt,zt,!1,function(e){a("0Lu9")},"data-v-6b5ee127",null).exports,Mt={name:"TaskMeta",methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleSelectionChange:function(e){this.selectTaskMeta=e},handleCurrentChange:function(){this.getTaskMetaData()},getTaskMetaData:function(){var e,t=this;(e={params:{page:this.currentPage,project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/taskmeta/",e)).then(function(e){t.TaskMetaData=e.data,t.loading=!1})}},mounted:function(){this.getTaskMetaData()},data:function(){return{search:"",selectTaskMeta:[],currentRow:"",currentPage:1,TaskMetaData:{count:0,results:[]},loading:!0}}},Ot={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"})]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{"padding-top":"10px","margin-left":"10px"}}),e._v(" "),a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0px",right:"0",left:"230px",top:"100px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{size:"medium","element-loading-text":"正在玩命加载","highlight-current-row":"",data:e.TaskMetaData.results,"show-header":0!==e.TaskMetaData.results.length,stripe:"",height:"600px"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:{pass:"SUCCESS"===t.row.status,fail:"FAILURE"===t.row.status},domProps:{textContent:e._s("SUCCESS"===t.row.status?"SUCCESS":"FAILURE")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"异常信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"right",width:"600"}},[a("pre",{staticClass:"code-block"},[e._v(e._s(t.row.traceback))]),e._v(" "),t.row.traceback?a("el-button",{staticClass:"popoverFont",attrs:{slot:"reference",round:"",type:"text"},slot:"reference"},[e._v("异常信息")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"结束时间",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.date_done))])]}}])})],1),e._v(" "),a("div",[a("el-row",[a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.TaskMetaData.count,expression:"TaskMetaData.count !== 0 "}],attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.TaskMetaData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)])],1)],1)},staticRenderFns:[]};a("VU/8")(Mt,Ot,!1,function(e){a("GViy")},"data-v-65e459a7",null).exports;var Ht=a("/dO2"),Gt={props:{save:Boolean,testcase:{require:!1}},methods:{S4:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},guid:function(){return this.S4()+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+this.S4()+this.S4()},rowDrop:function(){var e=this.$refs.table.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Ht.a.create(e,{draggable:".el-table__row",onEnd:function(e){var a=e.newIndex,s=e.oldIndex,n=t.tableData.splice(s,1)[0];t.tableData.splice(a,0,n)}})},columnDrop:function(){var e=this,t=document.querySelector(".el-table__header-wrapper tr");this.sortable=Ht.a.create(t,{animation:180,delay:0,onEnd:function(t){var a=e.dropCol[t.oldIndex];e.dropCol.splice(t.oldIndex,1),e.dropCol.splice(t.newIndex,0,a)}})},handleEdit:function(e,t){this.tableData.push({rowkeyid:this.guid(),describe:"",action:"",locationType:"",locationValue:"",CheckValueOurce:"",AttributeName:"",CheckType:"",DataItem:""})},handleDelete:function(e,t){this.tableData.splice(e,1)},parsetestcase:function(){return console.log(this.tableData),this.tableData}},watch:{save:function(){this.$emit("testcase",this.parsetestcase(),this.tableData)},testcase:function(){0!==this.testcase.length&&(this.tableData=this.testcase)}},mounted:function(){this.rowDrop(),this.columnDrop()},computed:{height:function(){return window.screen.height-440}},data:function(){return{disabled:!1,actionOptions:[{value:"地址栏跳转"},{value:"跳转窗口"},{value:"点击"},{value:"等待"},{value:"输入"},{value:"截图"},{value:"断言"},{value:"跳转iframe"},{value:"返回父iframe"}],locationTypeOptions:[{value:"XPATH"},{value:"ID"},{value:"NAME"},{value:"CLASS_NAME"},{value:"CSS"},{value:"LINK_TEXT"},{value:"PARTIAL_LINK_TEXT"},{value:"TAG_NAME"}],CheckValueOurceOptions:[{value:"普通文本"},{value:"属性值"}],CheckTypeOptions:[{value:"等于"},{value:"小于"},{value:"小于或等于"},{value:"大于"},{value:"大于或等于"},{value:"不等于"},{value:"字符串相等"},{value:"长度相等"},{value:"长度大于或相等"},{value:"长度小于"},{value:"长度小于或相等"},{value:"列表相等"}],currentRow:"",tableData:[{rowkeyid:this.guid(),describe:"",action:"",locationType:"",locationValue:"",CheckValueOurce:"",AttributeName:"",CheckType:"",DataItem:""}]}},name:"Testcases"},Kt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:e.tableData,"row-key":"rowkeyid",height:e.height,border:!1}},[a("el-table-column",{attrs:{width:"60px",label:"顺序",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:"步骤描述",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入步骤描述"},model:{value:t.row.describe,callback:function(a){e.$set(t.row,"describe",a)},expression:"scope.row.describe"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"动作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:t.row.action,callback:function(a){e.$set(t.row,"action",a)},expression:"scope.row.action"}},e._l(e.actionOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"定位方式",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",disabled:""===t.row.action},model:{value:t.row.locationType,callback:function(a){e.$set(t.row,"locationType",a)},expression:"scope.row.locationType"}},e._l(e.locationTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"定位值",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入定位值",disabled:""===t.row.locationType},model:{value:t.row.locationValue,callback:function(a){e.$set(t.row,"locationValue",a)},expression:"scope.row.locationValue"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"校验值来源",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",disabled:"断言"!==t.row.action},model:{value:t.row.CheckValueOurce,callback:function(a){e.$set(t.row,"CheckValueOurce",a)},expression:"scope.row.CheckValueOurce"}},e._l(e.CheckValueOurceOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"属性名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入属性名",disabled:"属性值"!==t.row.CheckValueOurce},model:{value:t.row.AttributeName,callback:function(a){e.$set(t.row,"AttributeName",a)},expression:"scope.row.AttributeName"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"校验方式",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",disabled:"断言"!==t.row.action},model:{value:t.row.CheckType,callback:function(a){e.$set(t.row,"CheckType",a)},expression:"scope.row.CheckType"}},e._l(e.CheckTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"数据项",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入数据项"},model:{value:t.row.DataItem,callback:function(a){e.$set(t.row,"DataItem",a)},expression:"scope.row.DataItem"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var Jt=a("VU/8")(Gt,Kt,!1,function(e){a("ODmK")},"data-v-1918f921",null).exports,Zt={name:"DebugReport",data:function(){return{srcList:["https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg"]}},methods:{srcListtest:function(e){return[e]},handleRequest:function(e){["start_timestamp"].forEach(function(t){delete e[t]});try{e.body=JSON.parse(e.body)}catch(e){}return e},handleContent:function(e){try{e=JSON.parse(e)}catch(e){}return e},handleResponse:function(e){return["response_time_ms","encoding","ok","reason","url","text","json","content_size","content_type"].forEach(function(t){delete e[t]}),e}},props:{summary:{require:!0}}},Qt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"overflow-y":"scroll",height:"800px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:[e.summary],size:"medium",border:"",stripe:"","header-cell-style":{textAlign:"center",background:"#F8F8FA"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"测试时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("timestampToTime")(t.row.time.start_at)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"持续时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{textContent:e._s(t.row.time.duration.toFixed(3)+" 秒")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"总数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(t.row.stat.testsRun))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"成功",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.stat.successes))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"失败",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(t.row.stat.failures))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"系统环境"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("Python: "+e._s(t.row.platform.python_version))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.platform.platform))])],1)])]}}])})],1),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),e._l(e.summary.details,function(t){return e._t("default",function(){return[a("div",[a("span",{staticStyle:{"font-weight":"bold","font-size":"medium"}},[e._v(e._s(t.name))])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.detail,border:"","header-cell-style":{textAlign:"center",background:"#F8F8FA"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"名 称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"用例描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.casedescribe))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"持续时间 (秒)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.time.duration.toFixed(3)+" 秒"))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:t.row.status},[e._v(e._s(t.row.status))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tabs",[a("el-tab-pane",{attrs:{label:"用例脚本信息"}},[a("pre",{staticClass:"code-block",domProps:{innerHTML:e._s(e.handleRequest(t.row.casebody))}})]),e._v(" "),null!==t.row.casesteps?a("el-tab-pane",{attrs:{label:"用例执行情况"}},e._l(t.row.casesteps,function(t){return a("div",{key:t.rowkeyid},[a("el-collapse",{attrs:{accordion:""}},[a("el-collapse-item",[a("template",{slot:"title"},[a("div",{staticStyle:{width:"95%"}},["passed"==t.status?a("i",{staticClass:"el-icon-success",staticStyle:{color:"green","padding-left":"100px"}}):e._e(),e._v(" "),"failed"==t.status?a("i",{staticClass:"el-icon-error",staticStyle:{color:"red","padding-left":"100px"}}):e._e(),e._v(" "),a("span",{staticStyle:{widht:"70%"}},[e._v(e._s(t.stepname))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#999"}},[e._v(e._s(t.time.duration)+" ms")])])]),e._v(" "),""!==t.parameters?a("div",[e._v("                                       \n                                            "+e._s(t.parameters)+"\n                                        ")]):e._e(),e._v(" "),0!==t.attachments.length?a("div",{staticClass:"demo-image__preview",staticStyle:{widht:"1000px"}},e._l(t.attachments,function(t){return a("div",{key:t.uid,staticStyle:{widht:"1000px"}},[a("el-image",{staticStyle:{width:"800px",height:"500px"},attrs:{src:t.path,"preview-src-list":[t.path]}},[e._v("\n\n                                                    >\n                                                    "),a("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v("\n                                                        加载中"),a("span",{staticClass:"dot"},[e._v("...")])])])],1)}),0):e._e()],2)],1)],1)}),0):e._e(),e._v(" "),""!==t.row.errormessage?a("el-tab-pane",{attrs:{label:"异常信息"}},[a("pre",{staticClass:"code-block",domProps:{textContent:e._s(e.handleResponse(t.row.errormessage))}})]):e._e()],1)]}}],null,!0)})],1)]})})],2)},staticRenderFns:[]};var Wt=a("VU/8")(Zt,Qt,!1,function(e){a("JGkj")},"data-v-75595a7c",null).exports,Xt=function(e){return p.a.get("/api/testrunner/uicase/",e).then(function(e){return e.data})},Yt=function(e){return p.a.get("/api/testrunner/uicase/",e).then(function(e){return e.data})},ea=function(e){return p.a.get("/api/testrunner/uitest/",e).then(function(e){return e.data})},ta=function(e){return p.a.get("/api/testrunner/uitest/",e).then(function(e){return e.data})},aa=function(e){return p.a.post("/api/testrunner/run_testplansuite/",e).then(function(e){return e.data})},sa={components:{Testcase:Jt,Report:Wt,variables:ve},props:{nodeId:{require:!1},project:{require:!1},config:{require:!0},response:{require:!1}},methods:{reverseStatus:function(){this.save=!this.save,this.run=!0},handleVariables:function(e){this.variables=e,this.run?(this.runuicase(),this.run=!1):""===this.id?this.addUICase():this.updateUIcase()},handleHeader:function(e){this.testcase=e},validateData:function(){return""===this.casedescribe?(this.$notify.error({title:"用例描述错误",message:"用例描述不能为空",duration:1500}),!1):""!==this.name||(this.$notify.error({title:"name错误",message:"用例名称不能为空",duration:1500}),!1)},updateUIcase:function(){var e,t,a=this;this.validateData()&&(e=this.id,t={testcase:this.testcase,casedescribe:this.casedescribe,variables:this.variables,name:this.name},p.a.patch("/api/testrunner/uicase/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.success?a.$emit("addSuccess"):a.$message.error({message:e.msg,duration:1e3})})},runuicase:function(){var e,t=this;this.validateData()&&(this.loading=!0,(e={project:this.$route.params.id,name:this.name,config:this.config,casedescribe:this.casedescribe,variables:this.variables,testcase:this.testcase},p.a.post("/api/testrunner/run_uicase/",e).then(function(e){return e.data})).then(function(e){t.summary=e,t.dialogTableVisible=!0,t.loading=!1}).catch(function(e){t.loading=!1}))},addUICase:function(){var e,t=this;this.validateData()&&(e={testcase:this.testcase,casedescribe:this.casedescribe,variables:this.variables,method:"CASE",name:this.name,nodeId:this.nodeId,project:this.project},p.a.post("/api/testrunner/uicase/",e).then(function(e){return e.data})).then(function(e){e.success?t.$emit("addSuccess"):t.$message.error({message:e.msg,duration:1e3})})}},watch:{response:function(){this.name=this.response.name,this.casedescribe=this.response.casedescribe,this.id=this.response.id,this.testcase=this.response.body,this.variables=this.response.variables}},data:function(){return{loading:!1,name:"",casedescribe:"",id:"",testcase:[],variables:[],dialogTableVisible:!1,save:!1,run:!1,summary:{},activeTag:"first"}},name:"CaseBody"},na={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",[a("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入用例名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[a("template",{slot:"prepend"},[e._v("用例名称")]),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:function(t){e.save=!e.save}},slot:"append"},[e._v("保存\n                ")])],2),e._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary",disabled:e.loading},on:{click:e.reverseStatus}},[e._v("运行\n            ")])],1),e._v(" "),a("div",[a("el-input",{staticStyle:{width:"600px","margin-top":"10px"},attrs:{placeholder:"请输入用例描述",clearable:""},model:{value:e.casedescribe,callback:function(t){e.casedescribe=t},expression:"casedescribe"}},[a("template",{slot:"prepend"},[e._v("用例描述")])],2)],1)]),e._v(" "),a("div",{staticClass:"request"},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("el-tabs",{staticStyle:{"margin-left":"20px"},model:{value:e.activeTag,callback:function(t){e.activeTag=t},expression:"activeTag"}},[a("el-tab-pane",{attrs:{label:"用例步骤",name:"first"}},[a("testcase",{attrs:{save:e.save,testcase:e.response?e.response.body:[]},on:{testcase:e.handleHeader}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"变量设置",name:"two"}},[a("variables",{attrs:{save:e.save,variables:e.response?e.response.variables:[]},on:{variables:e.handleVariables}})],1)],1)],1)])},staticRenderFns:[]};var ra=a("VU/8")(sa,na,!1,function(e){a("EGP7")},"data-v-7bf6efb9",null).exports,ia={components:{Report:Wt},name:"CaseList",props:{run:Boolean,back:Boolean,node:{require:!0},project:{require:!0},config:{require:!0},permissions:{require:!0},del:Boolean},data:function(){return{checked:!1,search:"",reportName:"",asyncs:!1,filterText:"",loading:!1,expand:"&#xe65f;",dataTree:{},dialogTreeVisible:!1,dialogTableVisible:!1,summary:{},selectUIcase:[],currentRow:"",currentPage:1,apiData:{count:0,results:[]}}},watch:{filterText:function(e){this.$refs.tree.filter(e)},run:function(){this.asyncs=!1,this.reportName="",this.getTree()},back:function(){this.getUIcaseList()},node:function(){this.search="",this.getUIcaseList()},checked:function(){this.checked?this.toggleAll():this.toggleClear()},del:function(){var e=this;0!==this.selectUIcase.length?this.$confirm("此操作将永久删除用例，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectUIcase},p.a.delete("/api/testrunner/uicase/",t).then(function(e){return e.data})).then(function(t){e.getUIcaseList()})}):this.$notify.warning({title:"提示",message:"请至少选择一个用例",duration:1e3})}},methods:{handleCopyUIcase:function(e){var t=this;this.$prompt("请输入用例名称","提示",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"用例名称不能为空"}).then(function(a){var s,n,r=a.value;(s=e,n={name:r},p.a.post("/api/testrunner/uicase/"+s+"/",n).then(function(e){return e.data})).then(function(e){e.success?t.getUIcaseList():t.$message.error(e.msg)})})},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},runTree:function(){var e=this;this.dialogTreeVisible=!1;var t,a=this.$refs.tree.getCheckedKeys();0===a.length?this.$notify.error({title:"提示",message:"请至少选择一个节点",duration:1500}):(t={config:this.config,project:this.project,relation:a,async:this.asyncs,name:this.reportName},p.a.post("/api/testrunner/run_uicase_tree/",t).then(function(e){return e.data})).then(function(t){t.hasOwnProperty("status")?e.$message.info({message:t.msg,duration:1500}):(e.summary=t,e.dialogTableVisible=!0)})},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:3}}).then(function(t){e.dataTree=t.tree,e.dialogTreeVisible=!0})},handleSelectionChange:function(e){this.selectUIcase=e},toggleAll:function(){this.$refs.multipleTable.toggleAllSelection()},toggleClear:function(){this.$refs.multipleTable.clearSelection()},getUIcaseList:function(){var e=this;Xt({params:{node:this.node,project:this.project,search:this.search}}).then(function(t){e.apiData=t})},handleCurrentChange:function(e){var t=this;Yt({params:{page:this.currentPage,node:this.node,project:this.project,search:this.search}}).then(function(e){t.apiData=e})},handleDelUIcase:function(e){var t=this;this.$confirm("此操作将永久删除该用例，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/uicase/"+a+"/").then(function(e){return e.data})).then(function(e){e.success?t.getUIcaseList():t.$message.error(e.msg)})})},handleRowClick:function(e){var t,a=this;(t=e.id,p.a.get("/api/testrunner/uicase/"+t+"/").then(function(e){return e.data})).then(function(e){e.success?a.$emit("api",e):a.$message.error(e.msg)})},handleRunUIcase:function(e){var t,a,s=this;this.loading=!0,(t=e,a={params:{project:this.$route.params.id,config:this.config}},p.a.get("/api/testrunner/run_uicase_pk/"+t+"/",a).then(function(e){return e.data})).then(function(e){s.summary=e,s.dialogTableVisible=!0,s.loading=!1}).catch(function(e){s.loading=!1})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""}},mounted:function(){this.getUIcaseList()}},oa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-left":"10px"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:1}},[e.apiData.count>0?a("el-checkbox",{staticStyle:{"padding-top":"14px","padding-left":"2px"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}):e._e()],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入用例名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUIcaseList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"运行用例",visible:e.dialogTreeVisible,width:"45%"},on:{"update:visible":function(t){e.dialogTreeVisible=t}}},[a("div",[a("div",[a("el-row",{attrs:{gutter:2}},[a("el-col",{attrs:{span:8}},[a("el-switch",{staticStyle:{"margin-top":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"异步执行","inactive-text":"同步执行"},model:{value:e.asyncs,callback:function(t){e.asyncs=t},expression:"asyncs"}})],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.asyncs,expression:"asyncs"}],attrs:{clearable:"",placeholder:"请输入报告名称",disabled:!1},model:{value:e.reportName,callback:function(t){e.reportName=t},expression:"reportName"}})],1)],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-input",{attrs:{placeholder:"输入节点名称进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"overflow-y":"scroll",height:"400px"},attrs:{"filter-node-method":e.filterNode,data:e.dataTree,"show-checkbox":"","node-key":"id","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,"highlight-current":!0},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTreeVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.runTree}},[e._v("确 定")])],1)]),e._v(" "),a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"500px",top:"160px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",height:"700px",data:e.apiData.results,"show-header":!0,stripe:""},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{label:"用例名称",prop:"name","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"用例描述",prop:"describe","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",prop:"create_user",width:"150","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleRowClick(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleCopyUIcase(t.row.id)}}},[e._v("复制\n                                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.handleRunUIcase(t.row.id)}}},[e._v("运行")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelUIcase(t.row.id)}}},[e._v("删除\n                                ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.apiData.count,expression:"apiData.count !== 0 "}],staticStyle:{"margin-top":"10px"},attrs:{"page-size":11,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.apiData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var la={watch:{filterText:function(e){this.$refs.tree2.filter(e)}},components:{CaseBody:ra,CaseList:a("VU/8")(ia,oa,!1,function(e){a("swIO")},"data-v-2850a802",null).exports},computed:{initResponse:{get:function(){return this.addCaseFlag},set:function(e){this.addCaseFlag=e,this.response={id:"",name:"",casedescribe:"",body:[{rowkeyid:this.guid(),describe:"",action:"",locationType:"",locationValue:"",CheckValueOurce:"",AttributeName:"",CheckType:"",DataItem:""}],variables:[{key:"",value:"",desc:"",type:1}]}}}},data:function(){return{permissions:[],loading:!1,configOptions:[],hostOptions:[],currentConfig:"请选择",currentHost:"请选择",back:!1,del:!1,run:!1,response:"",nodeForm:{name:""},rules:{name:[{required:!0,message:"请输入节点名称",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}]},radio:"根节点",addCaseFlag:!1,treeId:"",maxId:"",rmid:"",dialogVisible:!1,currentNode:"",data:"",filterText:"",expand:"&#xe65f;",dataTree:[]}},methods:{quxiao:function(){this.nodeForm.name="",this.dialogVisible=!1},S4:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},guid:function(){return this.S4()+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+this.S4()+this.S4()},handleBackList:function(){this.addCaseFlag=!1,this.back=!this.back},handleDragEnd:function(){this.updateTree(!1)},handleAddSuccess:function(){this.back=!this.back,this.addCaseFlag=!1},handleAPI:function(e){this.addCaseFlag=!0,this.response=e},getpermissions:function(){var e=this;b({app_label:"TestRunner",model:"uicase"}).then(function(t){e.permissions=t.permissions})},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:3}}).then(function(t){e.dataTree=t.tree,e.treeId=t.id,e.maxId=t.max})},getConfig:function(){var e=this;Ae(this.$route.params.id).then(function(t){e.configOptions=t,e.configOptions.push({name:"请选择"})})},getHost:function(){var e=this;Ee(this.$route.params.id).then(function(t){e.hostOptions=t,e.hostOptions.push({name:"请选择"})})},updateTree:function(e){var t=this;Re(this.treeId,{body:this.dataTree,node:this.currentNode.id,mode:e,type:3}).then(function(e){e.success?(t.dataTree=e.tree,t.maxId=e.max):t.$message.error(e.msg)})},deleteNode:function(){var e=this;this.$confirm("此操作将永久删除该节点下所有接口, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){""===e.currentNode?e.$message.info("请选择一个节点"):0!==e.currentNode.children.length?e.$message.warning("此节点有子节点，不可删除！"):(e.remove(e.currentNode,e.data),e.updateTree(!0))})},renameNode:function(){var e=this;this.$prompt("请输入节点名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"节点名称不能为空"}).then(function(t){var a=t.value,s=e.data.parent,n=s.data.children||s.data;n[n.findIndex(function(t){return t.id===e.currentNode.id})].label=a,e.updateTree(!1)})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.append(t.currentNode),t.updateTree(!1),t.nodeForm.name="",t.dialogVisible=!1)})},handleNodeClick:function(e,t){this.addCaseFlag=!1,this.currentNode=e,this.data=t},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},remove:function(e,t){var a=t.parent,s=a.data.children||a.data,n=s.findIndex(function(t){return t.id===e.id});s.splice(n,1)},append:function(e){var t={id:this.guid(),label:this.nodeForm.name,children:[]};""!==e&&0!==this.dataTree.length&&"根节点"!==this.radio?(e.children||this.$set(e,"children",[]),e.children.push(t)):this.dataTree.push(t)}},name:"webtestcaselist",mounted:function(){this.getTree(),this.getConfig(),this.getHost(),this.getpermissions()}},ca={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n                    新建分组\n                ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"新建分组",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"nodeForm",staticClass:"project",attrs:{model:e.nodeForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"节点名称",prop:"name"}},[a("el-input",{model:{value:e.nodeForm.name,callback:function(t){e.$set(e.nodeForm,"name",t)},expression:"nodeForm.name"}})],1)],1),e._v(" "),a("el-radio-group",{attrs:{size:"small"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"根节点"}}),e._v(" "),a("el-radio-button",{attrs:{label:"子节点"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.quxiao()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("nodeForm")}}},[e._v("确 定")])],1)],1),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"danger",size:"small",icon:"el-icon-delete"},on:{click:e.deleteNode}},[e._v("删除分组\n                ")]):e._e(),e._v(" "),e.permissions.includes("change")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"info",size:"small",icon:"el-icon-edit-outline"},on:{click:e.renameNode}},[e._v("重命名\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.initResponse=!0}}},[e._v("添加用例\n                ")]):e._e(),e._v(" "),e._v("\n                 配置:\n                "),a("el-select",{attrs:{placeholder:"请选择",size:"small",tyle:"margin-left: -6px",filterable:""},model:{value:e.currentConfig,callback:function(t){e.currentConfig=t},expression:"currentConfig"}},e._l(e.configOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),!e.addCaseFlag&&e.permissions.includes("add")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.run=!e.run}}},[e._v("运行")]):e._e(),e._v(" "),!e.addCaseFlag&&e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.del=!e.del}}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:!e.addCaseFlag,type:"text"},on:{click:e.handleBackList}},[e._v("返回列表\n                ")])],1)])]),e._v(" "),a("el-container",[a("el-aside",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,draggable:"","highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick,"node-drag-end":e.handleDragEnd},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)])]),e._v(" "),a("el-main",{staticStyle:{padding:"0"}},[a("case-body",{directives:[{name:"show",rawName:"v-show",value:e.addCaseFlag,expression:"addCaseFlag"}],attrs:{nodeId:e.currentNode.id,project:e.$route.params.id,response:e.response,config:e.currentConfig,host:e.currentHost},on:{addSuccess:e.handleAddSuccess}}),e._v(" "),a("case-list",{directives:[{name:"show",rawName:"v-show",value:!e.addCaseFlag,expression:"!addCaseFlag"}],attrs:{permissions:e.permissions,node:""!==e.currentNode?e.currentNode.id:"",project:e.$route.params.id,config:e.currentConfig,host:e.currentHost,del:e.del,back:e.back,run:e.run},on:{api:e.handleAPI}})],1)],1)],1)},staticRenderFns:[]};a("VU/8")(la,ca,!1,function(e){a("rmiQ")},"data-v-52a17e55",null).exports;var ua={props:{save:Boolean,testcase:{require:!1}},methods:{S4:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},guid:function(){return this.S4()+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+"-"+this.S4()+this.S4()+this.S4()},rowDrop:function(){var e=this.$refs.table.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Ht.a.create(e,{draggable:".el-table__row",onEnd:function(e){var a=e.newIndex,s=e.oldIndex,n=t.tableData.splice(s,1)[0];t.tableData.splice(a,0,n)}})},columnDrop:function(){var e=this,t=document.querySelector(".el-table__header-wrapper tr");this.sortable=Ht.a.create(t,{animation:180,delay:0,onEnd:function(t){var a=e.dropCol[t.oldIndex];e.dropCol.splice(t.oldIndex,1),e.dropCol.splice(t.newIndex,0,a)}})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleEdit:function(e,t){this.tableData.push({rowkeyid:this.guid(),describe:"",action:"",locationType:"",locationValue:"",CheckValueOurce:"",AttributeName:"",CheckType:"",DataItem:""})},handleDelete:function(e,t){this.tableData.splice(e,1)},parsetestcase:function(){return console.log(this.tableData),this.tableData}},watch:{save:function(){this.$emit("testcase",this.parsetestcase(),this.tableData)},testcase:function(){0!==this.testcase.length&&(this.tableData=this.testcase)}},mounted:function(){this.rowDrop(),this.columnDrop()},computed:{height:function(){return window.screen.height-440}},data:function(){return{actionOptions:[{value:"地址栏跳转"},{value:"跳转窗口"},{value:"点击"},{value:"等待"},{value:"输入"},{value:"截图"},{value:"断言"},{value:"跳转iframe"},{value:"返回父iframe"}],locationTypeOptions:[{value:"XPATH"},{value:"ID"},{value:"NAME"},{value:"CLASS_NAME"},{value:"CSS"},{value:"LINK_TEXT"},{value:"PARTIAL_LINK_TEXT"},{value:"TAG_NAME"}],CheckValueOurceOptions:[{value:"普通文本"},{value:"属性值"}],CheckTypeOptions:[{value:"等于"},{value:"小于"},{value:"小于或等于"},{value:"大于"},{value:"大于或等于"},{value:"不等于"},{value:"字符串相等"},{value:"长度相等"},{value:"长度大于或相等"},{value:"长度小于"},{value:"长度小于或相等"},{value:"列表相等"}],currentRow:"",tableData:[{rowkeyid:this.guid(),describe:"",action:"",locationType:"",locationValue:"",CheckValueOurce:"",AttributeName:"",CheckType:"",DataItem:""}]}},name:"Testcases"},da={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:e.tableData,"row-key":"rowkeyid",height:e.height,border:!1}},[a("el-table-column",{attrs:{width:"60px",label:"顺序",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:"步骤描述",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入步骤描述"},model:{value:t.row.describe,callback:function(a){e.$set(t.row,"describe",a)},expression:"scope.row.describe"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"动作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:t.row.action,callback:function(a){e.$set(t.row,"action",a)},expression:"scope.row.action"}},e._l(e.actionOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"定位方式",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",disabled:""===t.row.action},model:{value:t.row.locationType,callback:function(a){e.$set(t.row,"locationType",a)},expression:"scope.row.locationType"}},e._l(e.locationTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"定位值",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入定位值",disabled:""===t.row.locationType},model:{value:t.row.locationValue,callback:function(a){e.$set(t.row,"locationValue",a)},expression:"scope.row.locationValue"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"校验值来源",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",disabled:"断言"!==t.row.action},model:{value:t.row.CheckValueOurce,callback:function(a){e.$set(t.row,"CheckValueOurce",a)},expression:"scope.row.CheckValueOurce"}},e._l(e.CheckValueOurceOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"属性名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入属性名",disabled:"属性值"!==t.row.CheckValueOurce},model:{value:t.row.AttributeName,callback:function(a){e.$set(t.row,"AttributeName",a)},expression:"scope.row.AttributeName"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"校验方式",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",disabled:"断言"!==t.row.action},model:{value:t.row.CheckType,callback:function(a){e.$set(t.row,"CheckType",a)},expression:"scope.row.CheckType"}},e._l(e.CheckTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"数据项",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",placeholder:"请输入数据项"},model:{value:t.row.DataItem,callback:function(a){e.$set(t.row,"DataItem",a)},expression:"scope.row.DataItem"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"info"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==t.$index,expression:"scope.$index !== 0"}],attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)},staticRenderFns:[]};var pa={components:{Testcase:a("VU/8")(ua,da,!1,function(e){a("W/um")},"data-v-2aa42cc5",null).exports,Report:Te,variables:ve},props:{response:{require:!0}},methods:{handleHeader:function(e,t){this.testcase=t,this.tempBody.body=e},handleVariables:function(e,t){if(this.variables=t,this.tempBody.variables=e,this.tempBody.describe=this.describe,this.tempBody.name=this.name,this.tempBody.method=this.method,this.validateData()){var a={body:this.testcase,name:this.name,describe:this.describe,variables:this.variables,method:this.method};this.$emit("getNewBody",a,this.tempBody),this.run=!1}},validateData:function(){return""===this.describe?(this.$notify.error({title:"用例描述错误",message:"用例描述不能为空",duration:1500}),!1):""!==this.name||(this.$notify.error({title:"name错误",message:"用例名称不能为空",duration:1500}),!1)}},watch:{esc:function(){this.$emit("escEdit")}},data:function(){return{loading:!1,run:!1,esc:!1,variables:[],name:this.response.name,describe:this.response.describe,testcase:[],tempBody:{},method:"",save:!1,summary:{},dialogTableVisible:!1,activeTag:"first"}},name:"TestBody",mounted:function(){this.testcase=this.response.body,this.variables=this.response.variables,this.method=this.response.method}},ma={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",[a("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入用例名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[a("template",{slot:"prepend"},[e._v("用例信息录入")]),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:function(t){e.save=!e.save}},slot:"append"},[e._v("保存\n                ")])],2),e._v(" "),a("el-button",{attrs:{slot:"append",type:"danger"},on:{click:function(t){e.esc=!e.esc}},slot:"append"},[e._v("返回\n            ")])],1),e._v(" "),a("div",[a("el-input",{staticStyle:{width:"600px","margin-top":"10px"},attrs:{placeholder:"请输入用例描述",clearable:""},model:{value:e.describe,callback:function(t){e.describe=t},expression:"describe"}},[a("template",{slot:"prepend"},[e._v("用例描述")])],2)],1),e._v(" "),e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"request"},[a("el-tabs",{staticStyle:{"margin-left":"20px"},model:{value:e.activeTag,callback:function(t){e.activeTag=t},expression:"activeTag"}},[a("el-tab-pane",{attrs:{label:"用例步骤",name:"first"}},[a("testcase",{attrs:{save:e.save,testcase:e.testcase},on:{testcase:e.handleHeader}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"变量设置",name:"two"}},[a("variables",{attrs:{save:e.save,variables:e.variables},on:{variables:e.handleVariables}})],1)],1)],1)])},staticRenderFns:[]};var ha=a("VU/8")(pa,ma,!1,function(e){a("xsS8")},"data-v-75ef4c13",null).exports,fa={components:{draggable:He.a,TestBody:ha,Report:Wt},computed:{isConfigExist:{get:function(){return this.testData.length>0&&"config"===this.testData[0].method&&"请选择"!==this.testData[0].name}}},props:{project:{require:!0},config:{require:!0},node:{require:!0},testStepResp:{require:!1},back:Boolean},name:"EditTest",watch:{config:function(){var e={body:{name:this.config,method:"config"},method:"config",name:this.config};0!==this.testData.length&&"config"===this.testData[0].body.method||"请选择"===this.config?"请选择"!==this.config&&this.testData.splice(0,1,e):this.testData.splice(0,0,e)},back:function(){this.editTestStepActivate=!1},filterText:function(e){this.$refs.tree2.filter(e)},testStepResp:function(){try{this.testName=this.testStepResp.case.name,this.testId=this.testStepResp.case.id,this.testTag=this.testStepResp.case.tag,this.relation=this.testStepResp.case.relation,this.testData=JSON.parse(Me()(this.testStepResp.step))}catch(e){this.testName="",this.testId="",this.testTag="集成用例",this.testData=JSON.parse(Me()(this.testStepResp))}}},data:function(){return{tagOptions:{1:"冒烟用例",2:"集成用例",3:"监控脚本",4:"回归用例",5:"系统用例",6:"空库用例"},suite_loading:!1,loading:!1,dialogTableVisible:!1,editTestStepActivate:!1,currentPage:1,length:0,testId:"",search:"",testName:"",relation:"",testTag:"集成用例",currentTest:"",currentNode:"",currentAPI:"",data:"",filterText:"",expand:"&#xe65f;",dataTree:[],summary:{},caseData:{count:0,results:[]},testData:[]}},methods:{handleNewBody:function(e,t){this.editTestStepActivate=!1;var a=this.testData[this.currentTest].testplan,s=this.testData[this.currentTest].id;this.testData[this.currentTest]={body:t.body,newBody:t,testplan:a,describe:t.describe,id:s,name:t.name,method:t.method,variables:e.variables}},onStart:function(){this.drag=!0},onEnd:function(){this.drag=!1},validateData:function(){return""===this.testName||this.testName.length>100?(this.$notify.warning({title:"提示",duration:1e3,message:"用例集名称必填，不能超过100个字符"}),!1):0!==this.testData.length||(this.$notify.warning({title:"提示",duration:1e3,message:"测试用例集至少包含一个用例"}),!1)},addTestSuite:function(){var e,t=this,a=this.testData.length;"config"===this.testData[0].method&&(a-=1),(e={length:a,project:this.project,relation:this.node,name:this.testName,body:this.testData,tag:this.testTag},p.a.post("/api/testrunner/uitest/",e).then(function(e){return e.data})).then(function(e){e.success?t.$emit("addSuccess"):t.$message({message:e.msg,type:"error",duration:1e3})})},updateTestSuite:function(){var e,t,a=this,s=this.testData.length;"config"===this.testData[0].method&&(s-=1),(e=this.testId,t={length:s,name:this.testName,tag:this.testTag,body:this.testData,project:this.project,relation:this.relation},p.a.patch("/api/testrunner/uitest/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.success?a.$emit("addSuccess"):a.$message({message:e.msg,type:"error",duration:1e3})})},handleClickSave:function(){this.validateData()&&(""===this.testId?this.addTestSuite():this.updateTestSuite())},handleClickRun:function(){var e=this;this.validateData()&&(this.suite_loading=!0,aa({config:this.config,name:this.testName,body:this.testData,project:this.project}).then(function(t){e.suite_loading=!1,e.summary=t,e.dialogTableVisible=!0}).catch(function(t){e.suite_loading=!1}))},handleSingleRun:function(){var e=this;this.loading=!0;var t=this.config;this.testData.length>0&&"config"===this.testData[0].method&&(t=this.testData[0].name),aa({body:this.testData[this.currentTest],config:t,project:this.project}).then(function(t){e.loading=!1,e.summary=t,e.dialogTableVisible=!0}).catch(function(t){e.loading=!1})},handlePageChange:function(e){var t=this;Yt({params:{page:this.currentPage,node:this.currentNode,project:this.project,search:this.search}}).then(function(e){t.caseData=e})},getUIcaseList:function(){var e=this;Xt({params:{node:this.currentNode,project:this.project,search:this.search}}).then(function(t){e.caseData=t})},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:3}}).then(function(t){e.dataTree=t.tree})},handleNodeClick:function(e,t){this.currentNode=e.id,this.data=t,this.getUIcaseList()},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},dragEnd:function(e){this.testData.length>this.length&&this.testData.splice(this.length,1)},drop:function(e){e.preventDefault(),this.testData.push(this.currentAPI)},allowDrop:function(e){e.preventDefault()}},mounted:function(){this.getTree(),this.getUIcaseList()}},va={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-aside",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)])]),e._v(" "),a("el-main",[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.editTestStepActivate,expression:"!editTestStepActivate"}]},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:7}},[a("el-input",{attrs:{placeholder:"请输入用例名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUIcaseList},slot:"append"})],1)],1),e._v(" "),a("el-col",{staticStyle:{right:"145px",position:"absolute"},attrs:{span:30}},[e.testData.length>0?a("el-input",{staticStyle:{width:"400px","text-align":"center"},attrs:{placeholder:"请输入测试用例名称",clearable:""},model:{value:e.testName,callback:function(t){e.testName=t},expression:"testName"}},[a("el-select",{staticStyle:{width:"105px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.testTag,callback:function(t){e.testTag=t},expression:"testTag"}},e._l(e.tagOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:e.handleClickSave},slot:"append"},[e._v("保存\n                        ")])],1):e._e(),e._v(" "),e.testData.length>0?a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.suite_loading,expression:"suite_loading"}],attrs:{type:"primary"},on:{click:e.handleClickRun},model:{value:e.testName,callback:function(t){e.testName=t},expression:"testName"}},[e._v("运行\n                    ")]):e._e()],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.editTestStepActivate,expression:"!editTestStepActivate"}],staticStyle:{"margin-top":"10px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[e._l(e.caseData.results,function(t,s){return a("div",{key:s,staticStyle:{cursor:"pointer","margin-top":"10px"},attrs:{draggable:"true"},on:{dragstart:function(a){e.currentAPI=JSON.parse(JSON.stringify(t))}}},[a("div",{staticClass:"block block_post"},[a("span",{staticClass:"block-method block_method_post block_method_color"},[e._v("CASE")]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-method block_url test_demo_ellipsis"},[e._v(e._s(t.name))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.describe,placement:"top"}},[a("span",{staticClass:"block-summary-description test_demo_ellipsis"},[e._v(e._s(t.describe))])])],1)])}),e._v(" "),a("el-footer",{staticStyle:{"padding-top":"30px","padding-left":"0px"}},[a("el-col",{attrs:{span:10}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.caseData.count,expression:"caseData.count !== 0"}],staticStyle:{"margin-top":"5px","text-align":"center"},attrs:{"page-size":11,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.caseData.count},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],2),e._v(" "),a("el-col",{attrs:{span:12}},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("div",{staticStyle:{"max-height":"600px",overflow:"auto"},on:{drop:function(t){return e.drop(t)},dragover:function(t){return e.allowDrop(t)}}},[a("div",{staticClass:"test-list"},[0===e.testData.length?a("span",{staticStyle:{color:"red"}},[e._v("温馨提示："),a("br"),e._v("选择左侧相应用例节点显示可拖拽的CASE"),a("br"),e._v("从左边拖拽CASE至此区域组成业务用例"),a("br"),e._v("\n                                上下拖动此区域接口调整接口调用顺序\n                            ")]):e._e(),e._v(" "),e.isConfigExist?a("div",{staticClass:"block block_test",on:{mousemove:function(t){e.currentTest=-1}}},[a("span",{staticClass:"block-method block_method_config block_method_color"},[e._v(e._s(e.testData[0].method))]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.testData[0].name,expression:"testData[0].name"}],staticClass:"block-test-name",attrs:{disabled:""},domProps:{value:e.testData[0].name},on:{input:function(t){t.target.composing||e.$set(e.testData[0],"name",t.target.value)}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1===e.currentTest,expression:"currentTest === -1"}],staticStyle:{position:"absolute",right:"12px",top:"8px"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.testData.splice(e.index,1)}}})],1):e._e(),e._v(" "),a("draggable",{attrs:{group:"test",sort:!0,"force-fallback":"true",animation:"200"},on:{start:e.onStart,end:e.onEnd},model:{value:e.testData,callback:function(t){e.testData=t},expression:"testData"}},e._l(e.testData,function(t,s){return"config"!==t.method?a("div",{key:s,staticClass:"block block_test",on:{mousemove:function(t){e.currentTest=s}}},[a("span",{staticClass:"block-method block_method_test block_method_color"},[e._v("CASE")]),e._v(" "),a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("span",{staticClass:"block-test-name test_demo_ellipsis"},[e._v(e._s(t.name))])]),e._v(" "),a("el-tooltip",{attrs:{content:t.describe,placement:"top"}},[a("span",{staticClass:"block-test-name test_demo_ellipsis"},[e._v(e._s(t.describe))])]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"84px",top:"8px"},attrs:{type:"info",icon:"el-icon-edit",circle:"",size:"mini",title:"编辑"},on:{click:function(t){e.editTestStepActivate=!0}}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"48px",top:"8px"},attrs:{type:"success",icon:"el-icon-caret-right",circle:"",size:"mini",title:"运行"},on:{click:e.handleSingleRun}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"12px",top:"8px"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",title:"删除"},on:{click:function(t){return e.testData.splice(s,1)}}})],1):e._e()}),0)],1)])],1)],1)],1),e._v(" "),e.editTestStepActivate?a("test-body",{attrs:{response:e.testData[e.currentTest],config:e.config},on:{escEdit:function(t){e.editTestStepActivate=!1},getNewBody:e.handleNewBody}}):e._e()],1)],1)},staticRenderFns:[]};var ga=a("VU/8")(fa,va,!1,function(e){a("kjZi")},"data-v-55c3212e",null).exports,ba={name:"TestList",components:{Report:Wt},props:{run:Boolean,back:Boolean,project:{require:!0},host:{require:!0},node:{require:!1},permissions:{require:!0},del:Boolean},watch:{filterText:function(e){this.$refs.tree.filter(e)},run:function(){this.asyncs=!1,this.reportName="",this.getTree()},node:function(){this.search="",this.getUItestPlanList()},back:function(){this.getUItestPlanList()},del:function(){var e=this;0!==this.selectTest.length?this.$confirm("此操作将永久删除测试用例集，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectTest},p.a.delete("/api/testrunner/uitest/",t).then(function(e){return e.data})).then(function(t){e.getUItestPlanList()})}):this.$notify.warning({title:"提示",message:"请至少选择一个用例集",duration:1e3})}},data:function(){return{search:"",asdialogVisible:!1,asynform:{isasynchronous:!0,id:"",name:""},options:[{value:"",label:"全部"},{value:"1",label:"冒烟用例"},{value:"2",label:"集成用例"},{value:"3",label:"监控脚本"},{value:"4",label:"回归用例"},{value:"5",label:"系统用例"},{value:"6",label:"空库用例"}],rules:{isasynchronous:[{required:!0,message:"请选择运行方式",trigger:"blur"}]},value:"",reportName:"",asyncs:!1,filterText:"",expand:"&#xe65f;",dialogTreeVisible:!1,dataTree:{},loading:!1,dialogTableVisible:!1,selectTest:[],summary:{},currentRow:"",testData:{count:0,results:[]},currentPage:1,defaultProps:{children:"children",label:"label"}}},methods:{getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:4}}).then(function(t){e.dataTree=t.tree,e.dialogTreeVisible=!0})},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},runTree:function(){var e=this;this.dialogTreeVisible=!1;var t,a=this.$refs.tree.getCheckedKeys();0===a.length?this.$notify.error({title:"提示",message:"请至少选择一个节点",duration:1500}):(t={project:this.project,relation:a,async:this.asyncs,name:this.reportName},p.a.post("/api/testrunner/run_testplansuite_tree/",t).then(function(e){return e.data})).then(function(t){t.hasOwnProperty("status")?e.$message.info({message:t.msg,duration:1500}):(e.summary=t,e.dialogTableVisible=!0)})},showtable:function(e,t){this.asynform={isasynchronous:!0,id:e,name:t},this.asdialogVisible=!0},handleRunTest:function(){var e,t,a=this;this.loading=!0,this.asdialogVisible=!1,(e=this.asynform.id,t={params:{project:this.project,name:this.asynform.name,async:this.asynform.isasynchronous}},p.a.get("/api/testrunner/run_testplansuite_pk/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.hasOwnProperty("status")?(a.loading=!1,a.$message.info({message:e.msg,duration:1500})):(a.summary=e,a.dialogTableVisible=!0,a.loading=!1)}).catch(function(e){a.loading=!1}),this.asynform={isasynchronous:"",id:"",name:""}},handleCurrentChange:function(e){var t=this;ta({params:{page:this.currentPage,project:this.project,tag:this.value,node:this.node,search:this.search}}).then(function(e){t.testData=e})},handleEditTest:function(e){var t,a=this;(t=e,p.a.get("/api/testrunner/uitestplanstep/"+t+"/").then(function(e){return e.data})).then(function(e){a.$emit("testStep",e)})},handleCopyTest:function(e){var t=this;this.$prompt("请输入测试计划名称","提示",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"名称不能为空"}).then(function(a){var s,n,r=a.value;(s=e,n={name:r,relation:t.node,project:t.project},p.a.post("/api/testrunner/uitest/"+s+"/",n).then(function(e){return e.data})).then(function(e){e.success?t.getUItestPlanList():t.$message.error(e.msg)})})},handleSelectionChange:function(e){this.selectTest=e},handleDelTest:function(e){var t=this;this.$confirm("此操作将永久删除该测试计划，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/uitest/"+a+"/").then(function(e){return e.data})).then(function(e){e.success?t.getUItestPlanList():t.$message.error(e.msg)})})},getUItestPlanList:function(){var e=this;ea({params:{project:this.project,node:this.node,search:this.search,tag:this.value}}).then(function(t){e.testData=t})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""}},mounted:function(){this.getUItestPlanList()}},_a={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{"padding-top":"10px",height:"50px"}},[a("div",{staticStyle:{overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{staticStyle:{"padding-left":"25px","padding-right":"0px",width:"25%"},attrs:{span:7}},[e._v("\n                      用例类型:                    \n                  "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getUItestPlanList},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入测试计划名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUItestPlanList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px",height:"700px"}},[a("el-dialog",{attrs:{title:"请选择运行方式",visible:e.asdialogVisible,width:"20%",align:"center"},on:{"update:visible":function(t){e.asdialogVisible=t}}},[a("p",{staticStyle:{color:"red"}},[e._v("计划调试运行时间较长，建议使用异步执行")]),e._v(" "),a("el-form",{ref:"asynform",staticClass:"project",attrs:{model:e.asynform,rules:e.rules,"label-width":"100px"}},[a("div",{staticStyle:{"margin-top":"20px"}},[a("el-radio",{attrs:{label:!1,border:"",size:"medium",prop:"isasynchronous"},model:{value:e.asynform.isasynchronous,callback:function(t){e.$set(e.asynform,"isasynchronous",t)},expression:"asynform.isasynchronous"}},[e._v("调试")]),e._v(" "),a("el-radio",{attrs:{label:!0,border:"",size:"medium",prop:"isasynchronous"},model:{value:e.asynform.isasynchronous,callback:function(t){e.$set(e.asynform,"isasynchronous",t)},expression:"asynform.isasynchronous"}},[e._v("异步")])],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.asdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleRunTest()}}},[e._v("确 定")])],1)],1),e._v(" "),a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"500px",top:"160px"}},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%","modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"运行测试用例集",visible:e.dialogTreeVisible,width:"45%","modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogTreeVisible=t}}},[a("div",[a("div",[a("el-row",{attrs:{gutter:2}},[a("el-col",{attrs:{span:8}},[a("el-switch",{staticStyle:{"margin-top":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"异步执行","inactive-text":"同步执行"},model:{value:e.asyncs,callback:function(t){e.asyncs=t},expression:"asyncs"}})],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.asyncs,expression:"asyncs"}],attrs:{clearable:"",placeholder:"请输入报告名称",disabled:!1},model:{value:e.reportName,callback:function(t){e.reportName=t},expression:"reportName"}})],1)],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-input",{attrs:{value:"",placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"overflow-y":"scroll",height:"400px"},attrs:{data:e.dataTree,"check-strictly":!1,"filter-node-method":e.filterNode,"show-checkbox":"","check-on-click-node":"","node-key":"id","highlight-current":"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTreeVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.runTree}},[e._v("确 定")])],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.testData.results,"show-header":0!==e.testData.count,stripe:"",height:"700px"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{label:"计划名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用例个数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.length)+" 个")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用例类型",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return["冒烟用例"===t.row.tag?a("el-tag",[e._v(e._s(t.row.tag))]):e._e(),e._v(" "),"集成用例"===t.row.tag?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.tag))]):e._e(),e._v(" "),"监控脚本"===t.row.tag?a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(t.row.tag))]):e._e(),e._v(" "),"回归用例"===t.row.tag?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.row.tag))]):e._e(),e._v(" "),"系统用例"===t.row.tag?a("el-tag",{attrs:{type:"primary"}},[e._v(e._s(t.row.tag))]):e._e(),e._v(" "),"空库用例"===t.row.tag?a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.row.tag))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditTest(t.row.id)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.showtable(t.row.id,t.row.name)}}},[e._v("运行")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleCopyTest(t.row.id)}}},[e._v("复制\n                                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelTest(t.row.id)}}},[e._v("删除\n                                ")]):e._e()],1)]}}])})],1),e._v(" "),a("div",[a("el-footer",{staticStyle:{"padding-top":"10px"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:9}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.testData.count,expression:"testData.count !== 0 "}],attrs:{"current-page":e.currentPage,"page-size":11,layout:"total, prev, pager, next, jumper",total:e.testData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var ya={computed:{buttonActivate:{get:function(){return!this.addTestActivate||""===this.currentNode},set:function(e){this.addTestActivate=e,this.testStepResp=[]}}},watch:{filterText:function(e){this.$refs.tree2.filter(e)}},components:{EditTest:ga,TestList:a("VU/8")(ba,_a,!1,function(e){a("+GCz")},"data-v-b1cd43d8",null).exports},data:function(){return{permissions:[],testStepResp:[],nodeForm:{name:""},rules:{name:[{required:!0,message:"请输入节点名称",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}]},hostOptions:[],back:!1,del:!1,run:!1,radio:"根节点",addTestActivate:!0,currentConfig:"请选择",currentHost:"请选择",treeId:"",maxId:"",dialogVisible:!1,currentNode:"",data:"",filterText:"",expand:"&#xe65f;",dataTree:[],configOptions:[]}},methods:{handleDragEnd:function(){this.updateTree(!1)},getConfig:function(){var e=this;Ae(this.$route.params.id).then(function(t){e.configOptions=t,e.configOptions.push({name:"请选择"})})},handleBackList:function(){this.addTestActivate=!0,this.back=!this.back},quxiao:function(){this.nodeForm.name="",this.dialogVisible=!1},handleTestStep:function(e){this.testStepResp=e,this.addTestActivate=!1},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:4}}).then(function(t){e.dataTree=t.tree,e.treeId=t.id})},updateTree:function(e){var t=this;Re(this.treeId,{mode:e,body:this.dataTree,node:this.currentNode.id,type:4}).then(function(e){e.success?t.dataTree=e.tree:t.$message.error(e.msg)})},renameNode:function(){var e=this;this.$prompt("请输入节点名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"节点名称不能为空"}).then(function(t){var a=t.value,s=e.data.parent,n=s.data.children||s.data;n[n.findIndex(function(t){return t.id===e.currentNode.id})].label=a,e.updateTree(!1)})},getpermissions:function(){var e=this;b({app_label:"TestRunner",model:"uitestplan"}).then(function(t){e.permissions=t.permissions})},deleteNode:function(){var e=this;this.$confirm("此操作将永久删除该节点下所有用例, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){""===e.currentNode?e.$message.info("请选择一个节点"):0!==e.currentNode.children.length?e.$message.warning("此节点有子节点，不可删除！"):(e.remove(e.currentNode,e.data),e.updateTree(!0))})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.append(t.currentNode),t.updateTree(!1),t.dialogVisible=!1,t.nodeForm.name="")})},handleNodeClick:function(e,t){this.currentNode=e,this.data=t},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},remove:function(e,t){var a=t.parent,s=a.data.children||a.data,n=s.findIndex(function(t){return t.id===e.id});s.splice(n,1)},append:function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var a={id:t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),label:this.nodeForm.name,children:[]};""!==e&&0!==this.dataTree.length&&"根节点"!==this.radio?(e.children||this.$set(e,"children",[]),e.children.push(a)):this.dataTree.push(a)},getHost:function(){var e=this;Ee(this.$route.params.id).then(function(t){e.hostOptions=t,e.hostOptions.push({name:"请选择"})})}},name:"UICaseTestPlan",mounted:function(){this.getTree(),this.getConfig(),this.getHost(),this.getpermissions()}},wa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus",disabled:!e.addTestActivate},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n                    新建分组\n                ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"新建分组",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"nodeForm",staticClass:"project",attrs:{model:e.nodeForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"节点名称",prop:"name"}},[a("el-input",{model:{value:e.nodeForm.name,callback:function(t){e.$set(e.nodeForm,"name",t)},expression:"nodeForm.name"}})],1)],1),e._v(" "),a("el-radio-group",{attrs:{size:"small"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"根节点"}}),e._v(" "),a("el-radio-button",{attrs:{label:"子节点"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.quxiao()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("nodeForm")}}},[e._v("确 定")])],1)],1),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",disabled:e.buttonActivate},on:{click:e.deleteNode}},[e._v("删除分组\n                ")]):e._e(),e._v(" "),e.permissions.includes("change")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"info",size:"small",icon:"el-icon-edit-outline"},on:{click:e.renameNode}},[e._v("重命名\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline",disabled:e.buttonActivate},on:{click:function(t){e.buttonActivate=!1}}},[e._v("添加测试计划\n                ")]):e._e(),e._v(" "),e._v("\n                 配置:\n                "),a("el-select",{attrs:{placeholder:"请选择",size:"small",tyle:"margin-left: -6px",filterable:"",disabled:e.addTestActivate},model:{value:e.currentConfig,callback:function(t){e.currentConfig=t},expression:"currentConfig"}},e._l(e.configOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),e.addTestActivate&&e.permissions.includes("add")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.run=!e.run}}},[e._v("运行")]):e._e(),e._v(" "),e.addTestActivate&&e.permissions.includes("delete")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){e.del=!e.del}}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:e.addTestActivate,type:"text"},on:{click:e.handleBackList}},[e._v("返回列表\n                ")])],1)])]),e._v(" "),a("el-container",[a("el-aside",{directives:[{name:"show",rawName:"v-show",value:e.addTestActivate,expression:"addTestActivate"}],staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,draggable:"","highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick,"node-drag-end":e.handleDragEnd},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)])]),e._v(" "),a("el-main",{staticStyle:{padding:"0"}},[a("test-list",{directives:[{name:"show",rawName:"v-show",value:e.addTestActivate,expression:"addTestActivate"}],attrs:{permissions:e.permissions,project:e.$route.params.id,node:""!==e.currentNode?e.currentNode.id:"",del:e.del,back:e.back,run:e.run,host:e.currentHost},on:{testStep:e.handleTestStep}}),e._v(" "),a("edit-test",{directives:[{name:"show",rawName:"v-show",value:!e.addTestActivate,expression:"!addTestActivate"}],attrs:{back:e.back,project:e.$route.params.id,node:e.currentNode.id,testStepResp:e.testStepResp,config:e.currentConfig,host:e.currentHost},on:{addSuccess:e.handleBackList}})],1)],1)],1)},staticRenderFns:[]};a("VU/8")(ya,wa,!1,function(e){a("US7L")},"data-v-0ecfc53c",null).exports;var xa={name:"DebugReport",data:function(){return{srcList:["https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg"]}},methods:{srcListtest:function(e){return[e]},handleRequest:function(e){["start_timestamp"].forEach(function(t){delete e[t]});try{e.body=JSON.parse(e.body)}catch(e){}return e},handleContent:function(e){try{e=JSON.parse(e)}catch(e){}return e},handleResponse:function(e){return["response_time_ms","encoding","ok","reason","url","text","json","content_size","content_type"].forEach(function(t){delete e[t]}),e}},props:{summary:{require:!0}}},ka={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"overflow-y":"scroll",height:"800px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:[e.summary],size:"medium",border:"",stripe:"","header-cell-style":{textAlign:"center",background:"#F8F8FA"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"测试时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("timestampToTime")(t.row.time.start_at)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"持续时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{textContent:e._s(t.row.time.duration.toFixed(3)+" 秒")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"总数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(t.row.stat.testsRun))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"成功",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.stat.successes))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"失败",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(t.row.stat.failures))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"系统环境"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("Python: "+e._s(t.row.platform.python_version))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.platform.platform))])],1)])]}}])})],1),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),e._l(e.summary.details,function(t){return e._t("default",function(){return[a("div",{key:t.name},[a("span",{staticStyle:{"font-weight":"bold","font-size":"medium"}},[e._v(e._s(t.name))])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.detail,border:"","header-cell-style":{textAlign:"center",background:"#F8F8FA"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"名 称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"用例描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.casedescribe))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"持续时间 (秒)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.time.duration.toFixed(3)+" 秒"))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:t.row.status},[e._v(e._s(t.row.status))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tabs",[a("el-tab-pane",{attrs:{label:"用例脚本信息"}},[a("pre",{staticClass:"code-block",domProps:{innerHTML:e._s(e.handleRequest(t.row.casebody))}})]),e._v(" "),null!==t.row.casesteps?a("el-tab-pane",{attrs:{label:"用例执行情况"}},e._l(t.row.casesteps,function(t){return a("div",{key:t.rowkeyid},[a("el-collapse",{attrs:{accordion:""}},[a("el-collapse-item",[a("template",{slot:"title"},[a("div",{staticStyle:{width:"95%"}},["passed"==t.status?a("i",{staticClass:"el-icon-success",staticStyle:{color:"green","padding-left":"100px"}}):e._e(),e._v(" "),"failed"==t.status?a("i",{staticClass:"el-icon-error",staticStyle:{color:"red","padding-left":"100px"}}):e._e(),e._v(" "),a("span",{staticStyle:{widht:"70%"}},[e._v(e._s(t.stepname))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#999"}},[e._v(e._s(t.time.duration)+" ms")])])]),e._v(" "),""!==t.parameters?a("div",[e._v("                                       \n                                    "+e._s(t.parameters))]):e._e(),e._v(" "),0!==t.attachments.length?a("div",{staticClass:"demo-image__preview",staticStyle:{widht:"1000px"}},e._l(t.attachments,function(t){return a("div",{key:t.uid,staticStyle:{widht:"1000px"}},[a("el-image",{staticStyle:{width:"800px",height:"500px"},attrs:{src:t.path,"preview-src-list":[t.path]}},[e._v("\n\n                                            >\n                                            "),a("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v("\n                                                加载中"),a("span",{staticClass:"dot"},[e._v("...")])])])],1)}),0):e._e()],2)],1)],1)}),0):e._e(),e._v(" "),""!==t.row.errormessage?a("el-tab-pane",{attrs:{label:"异常信息"}},[a("pre",{staticClass:"code-block",domProps:{textContent:e._s(e.handleResponse(t.row.errormessage))}})]):e._e()],1)]}}],null,!0)})],1)]})})],2)},staticRenderFns:[]};var Ca={components:{Report:a("VU/8")(xa,ka,!1,function(e){a("XU5M")},"data-v-726a8fe1",null).exports},data:function(){return{search:"",permissions:[],selectReports:[],currentRow:"",currentPage:1,reportData:{count:0,results:[]},summary:{},loading:!0,dialogTableVisible:!1}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleWatchReports:function(e){var t=window.open("");window.focus(),lt(e,{params:{project:this.$route.params.id}}).then(function(e){t.focus(),t.document.open(),t.document.write(e.data),t.document.close()})},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"uireport"}).then(function(t){e.permissions=t.permissions})},getreportdetail:function(e){var t,a,s=this;(t=e,a={params:{project:this.$route.params.id}},p.a.get("/api/testrunner/uireports/"+t+"/",a).then(function(e){return e.data})).then(function(e){s.summary=e.summary,s.loading=!1,s.dialogTableVisible=!0})},handleSelectionChange:function(e){this.selectReports=e},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/uireports/",t).then(function(e){return e.data})).then(function(e){a.reportData=e})},handleDelReports:function(e){var t=this;this.$confirm("此操作将永久删除该测试报告，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a,s;(a=e,s={params:{project:t.$route.params.id}},p.a.delete("/api/testrunner/uireports/"+a+"/",s)).then(function(e){t.$notify.success("删除报告成功"),t.getReportList()})})},delSelectionReports:function(){var e=this;0!==this.selectReports.length?this.$confirm("此操作将永久删除勾选的测试报告，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t,a;console.log(e.selectReports),(t=e.selectReports,a={project:e.$route.params.id},p()({url:"/api/testrunner/uireports/",method:"delete",params:a,data:t})).then(function(t){e.$notify.success("批量删除报告成功"),e.getReportList()})}):this.$notify.warning("请至少勾选一个测试报告")},getReportList:function(){var e,t=this;(e={params:{project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/uireports/",e).then(function(e){return e.data})).then(function(e){t.reportData=e,t.loading=!1})}},name:"UIReportList",mounted:function(){this.getReportList(),this.getpermissions()}},Sa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.reportData.count,expression:"reportData.count !== 0"}],staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"mini",title:"批量删除"},on:{click:e.delSelectionReports}},[e._v("批量删除")]):e._e()],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[a("div",[a("el-row",[a("el-col",{attrs:{span:5}},[a("el-input",{attrs:{placeholder:"请输入报告名称",clearable:"",size:"small"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"small",title:"搜索"},on:{click:e.getReportList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px"}},[e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("report",{attrs:{summary:e.summary}})],1):e._e(),e._v(" "),a("div",{staticStyle:{position:"fixed",bottom:"0px",right:"0",left:"230px",top:"150px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},size:"medium","element-loading-text":"正在玩命加载","highlight-current-row":"",data:e.reportData.results,"show-header":0!==e.reportData.results.length,stripe:"",height:"600px","show-overflow-tooltip":""},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{staticStyle:{color:"white"},attrs:{color:"#2C3E50",size:"small"}},[e._v(e._s(t.row.type))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"报告名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:{pass:t.row.summary.success,fail:!t.row.summary.success},domProps:{textContent:e._s(!0===t.row.summary.success?"Pass":"Fail")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"测试时间",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("timestampToTime")(t.row.summary.time.start_at)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用时",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{textContent:e._s(t.row.summary.time.duration.toFixed(3)+" 秒")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"总计",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"small"}},[e._v(e._s(t.row.summary.stat.testsRun))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"通过",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"success",size:"small"}},[e._v(" "+e._s(t.row.summary.stat.successes))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"失败",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"danger",size:"small"}},[e._v(e._s(t.row.summary.stat.failures))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"系统信息",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v(e._s(t.row.summary.platform.python_version))]),e._v(" "),a("p",[e._v("Platform: "+e._s(t.row.summary.platform.platform))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v("系统 "+e._s(t.row.summary.platform.platform))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("view")?a("el-button",{attrs:{type:"info",size:"mini",title:"查看"},on:{click:function(a){return e.getreportdetail(t.row.id)}}},[e._v("查看\n                                    ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini",title:"删除"},on:{click:function(a){return e.handleDelReports(t.row.id)}}},[e._v("删除\n                                    ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.reportData.count,expression:"reportData.count !== 0 "}],staticStyle:{"margin-top":"10px"},attrs:{"page-size":11,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.reportData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};a("VU/8")(Ca,Sa,!1,function(e){a("qbfa")},"data-v-4d5576fc",null).exports;var Ta={components:{},props:{next:Boolean,testCase:{require:!0}},methods:{emitKwargsForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$emit("KwargsForm",t.kwargsForm)})},getHost:function(){var e=this;this.$api.hostList({params:{project:this.$route.params.id}}).then(function(t){e.hostOptions=t.data.results,e.hostOptions.push({name:"请选择"})})},getTestData:function(){var e=this;this.$api.testdataList({params:{project:this.$route.params.id}}).then(function(t){e.excelTreeOptions=[];var a=!0,s=!1,n=void 0;try{for(var r,i=Q()(t.results);!(a=(r=i.next()).done);a=!0){var o=r.value;o.excel_tree&&e.excelTreeOptions.push(o.excel_tree)}}catch(e){s=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw n}}})}},watch:{esc:function(){this.$emit("escEdit")}},data:function(){return{excelTreeOptions:[],esc:!1,hostOptions:[],testCaseName:this.testCase.name,kwargsForm:{testCaseName:"",hostInfo:"",excelTreeData:""},rules:{testCaseName:[{required:!0,message:"请输入用例名称",trigger:"blur"},{min:1,max:500,message:"长度在 1 到 500 个字符",trigger:"blur"}]}}},name:"EditTestCase",mounted:function(){this.getHost(),this.getTestData(),this.testCase.kwargs&&(this.kwargsForm=this.testCase.kwargs)}},Fa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",{staticStyle:{"padding-top":"0"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"kwargsForm",attrs:{model:e.kwargsForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用例名称",prop:"testCaseName"}},[a("el-input",{attrs:{placeholder:"请输入用例名称",clearable:"",size:"medium",type:"textarea",autosize:{minRows:1,maxRows:8}},model:{value:e.kwargsForm.testCaseName,callback:function(t){e.$set(e.kwargsForm,"testCaseName",t)},expression:"kwargsForm.testCaseName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"域名参数"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.kwargsForm.hostInfo,callback:function(t){e.$set(e.kwargsForm,"hostInfo",t)},expression:"kwargsForm.hostInfo"}},e._l(e.hostOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"数据选择",width:"300px"}},[a("el-cascader",{staticStyle:{width:"50%"},attrs:{options:e.excelTreeOptions,"collapse-tags":"",placeholder:"试试搜索",clearable:"",filterable:"",size:"medium"},model:{value:e.kwargsForm.excelTreeData,callback:function(t){e.$set(e.kwargsForm,"excelTreeData",t)},expression:"kwargsForm.excelTreeData"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.esc=!e.esc}}},[e._v("返回")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.emitKwargsForm("kwargsForm")}}},[e._v("保存")])],1)],1)],1)],1)])},staticRenderFns:[]};var $a={name:"AddTasks",props:{ruleForm:{require:!0},args:{require:!0},scheduleId:{require:!0}},watch:{filterText:function(e){this.$refs.tree2.filter(e)}},components:{EditTestCase:a("VU/8")(Ta,Fa,!1,function(e){a("tuwf")},"data-v-79c49b74",null).exports,draggable:He.a},data:function(){return{drag:!1,currentTest:"",length:0,currentSuite:"",myargs:this.args,search:"",next:!1,listPageShow:!0,node:"",currentPage:1,filterText:"",expand:"&#xe65f;",dataTree:[],suiteData:{count:0,results:[]},rules:{name:[{required:!0,message:"请输入任务名称",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],crontab:[{required:!0,message:"请输入正确的crontab表达式",trigger:"blur"}],receiver:[{required:!0,message:"请输入邮箱，邮箱不能为空"}]},editTestCaseActivate:!1}},methods:{onStart:function(){this.drag=!0},onEnd:function(){this.drag=!1},handleEditTestCase:function(){this.editTestCaseActivate=!0,this.next=!1},saveTask:function(){var e=this,t=this.ruleForm;t.data=this.myargs,t.project=this.$route.params.id,""===this.scheduleId?Ct({project:this.$route.params.id,tasktype:"UI"},t).then(function(t){201===t.status&&(e.$notify.success("添加定时任务成功"),e.$emit("changeStatus",!1))}):Tt(this.scheduleId,{project:this.$route.params.id,tasktype:"UI"},t).then(function(t){200===t.status&&(e.$notify.success("更新定时任务成功"),e.$emit("changeStatus",!1))})},dragEnd:function(e){this.myargs.length>this.length&&this.myargs.splice(this.length,1)},drop:function(e){e.preventDefault(),this.myargs.push(this.currentSuite)},allowDrop:function(e){e.preventDefault()},handlePageChange:function(e){var t=this;ta({params:{page:this.currentPage,node:this.node,project:this.$route.params.id,tag:"",search:""}}).then(function(e){t.suiteData=e})},handleCurrentChange:function(e){var t=this;ta({params:{page:this.currentPage,project:this.$route.params.id,node:this.node,tag:"",search:this.search}}).then(function(e){t.suiteData=e})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.next=!0})},resetForm:function(e){this.$refs[e].resetFields()},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:4}}).then(function(t){e.dataTree=t.tree})},handleNodeClick:function(e){this.node=e.id,this.getTestList()},getTestList:function(){var e=this;ea({params:{project:this.$route.params.id,node:this.node,tag:"",search:this.search}}).then(function(t){e.suiteData=t})}},mounted:function(){this.getTree(),this.getTestList()}},Da={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[e.next?e._e():[a("el-main",{staticStyle:{"padding-top":"0"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入任务名称",clearable:""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"时间配置",prop:"crontab"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入crontab表达式，例如 2 12 * * *"},model:{value:e.ruleForm.crontab,callback:function(t){e.$set(e.ruleForm,"crontab",t)},expression:"ruleForm.crontab"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务状态",prop:"switch"}},[a("el-switch",{model:{value:e.ruleForm.switch,callback:function(t){e.$set(e.ruleForm,"switch",t)},expression:"ruleForm.switch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮件策略",prop:"strategy"}},[a("el-radio-group",{model:{value:e.ruleForm.strategy,callback:function(t){e.$set(e.ruleForm,"strategy",t)},expression:"ruleForm.strategy"}},[a("el-radio",{attrs:{label:"始终发送"}}),e._v(" "),a("el-radio",{attrs:{label:"仅失败发送"}}),e._v(" "),a("el-radio",{attrs:{label:"从不发送"}})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"监控邮件"===e.ruleForm.strategy,expression:"ruleForm.strategy === '监控邮件'"}],attrs:{label:"报警次数",prop:"fail_count"}},[a("el-input-number",{attrs:{min:1,max:20,size:"small",precision:0},model:{value:e.ruleForm.fail_count,callback:function(t){e.$set(e.ruleForm,"fail_count",t)},expression:"ruleForm.fail_count"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"监控邮件"===e.ruleForm.strategy,expression:"ruleForm.strategy === '监控邮件'"}],attrs:{label:"关键字过滤",prop:"self_error"}},[a("el-input",{attrs:{type:"textarea",placeholder:'若用例失败的返回报错含有关键字则视为用例通过，多个关键字以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.self_error,callback:function(t){e.$set(e.ruleForm,"self_error",t)},expression:"ruleForm.self_error"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"敏感字过滤",prop:"sensitive_keys"}},[a("el-input",{attrs:{type:"textarea",placeholder:'将敏感字处理为******，多个敏感字以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.sensitive_keys,callback:function(t){e.$set(e.ruleForm,"sensitive_keys",t)},expression:"ruleForm.sensitive_keys"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"接收邮箱",prop:"receiver"}},[a("el-input",{attrs:{type:"textarea",placeholder:'多个邮箱以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.receiver,callback:function(t){e.$set(e.ruleForm,"receiver",t)},expression:"ruleForm.receiver"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"抄送邮箱",prop:"mail_cc"}},[a("el-input",{attrs:{type:"textarea",placeholder:'多个邮箱以";"分隔',clearable:"",size:"medium",autosize:{minRows:1,maxRows:4}},model:{value:e.ruleForm.mail_cc,callback:function(t){e.$set(e.ruleForm,"mail_cc",t)},expression:"ruleForm.mail_cc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("下一步")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)])],e._v(" "),e.next?[a("el-aside",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"nav-api-side"},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree2",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}],null,!1,1890694903)})],1)])]),e._v(" "),a("el-main",{staticStyle:{"padding-top":"0px"}},[a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.suiteData.count,expression:"suiteData.count !== 0"}],staticStyle:{"text-align":"center"},attrs:{"page-size":11,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.suiteData.count},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),e._v(" "),a("el-col",{attrs:{span:12}},[e.args.length>0?a("el-button",{attrs:{type:"primary"},on:{click:e.saveTask}},[e._v("保存")]):e._e(),e._v(" "),e.args.length>0?a("el-button",{on:{click:function(t){e.next=!1}}},[e._v("上一步")]):e._e()],1)],1)],1),e._v(" "),a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},e._l(e.suiteData.results,function(t,s){return a("div",{key:s,staticStyle:{cursor:"pointer","margin-top":"10px",overflow:"auto"},attrs:{draggable:"true"},on:{dragstart:function(a){e.currentSuite=JSON.parse(JSON.stringify(t))}}},[a("div",{staticClass:"block block_options"},[a("span",{staticClass:"block-method block_method_options block_method_color"},[e._v("Case")]),e._v(" "),a("span",{staticClass:"block_name"},[e._v(e._s(t.name))])])])}),0),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{"max-height":"600px",overflow:"auto"},on:{drop:function(t){return e.drop(t)},dragover:function(t){return e.allowDrop(t)}}},[0===e.myargs.length?a("span",{staticStyle:{color:"red"}},[e._v("温馨提示："),a("br"),e._v("选择左侧相应用例节点显示可拖拽的用例"),a("br"),e._v("从左边拖拽用例至此区域组成任务列表"),a("br"),e._v("\n                                上下拖动此区域任务调整监控调用顺序\n                            ")]):e._e(),e._v(" "),a("div",{staticClass:"test-list"},[a("draggable",{attrs:{group:"test",sort:!0,"force-fallback":"true",animation:"200"},on:{start:e.onStart,end:e.onEnd},model:{value:e.myargs,callback:function(t){e.myargs=t},expression:"myargs"}},e._l(e.myargs,function(t,s){return a("div",{key:s,staticClass:"block block_test",on:{mousemove:function(t){e.currentTest=s}}},[a("span",{staticClass:"block-method block_method_test block_method_color"},[e._v("Tasks")]),e._v(" "),a("span",{staticClass:"block-test-name"},[e._v(e._s(t.name))]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentTest===s,expression:"currentTest === index"}],staticStyle:{position:"absolute",right:"12px",top:"8px"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.myargs.splice(s,1)}}})],1)}),0)],1)])])],1)],1)])]:e._e(),e._v(" "),[e.editTestCaseActivate?a("edit-test-case",{attrs:{testCase:e.args[e.currentTest],next:e.next},on:{escEdit:function(t){e.editTestCaseActivate=!1,e.next=!0},KwargsForm:e.handleNewTestCase}}):e._e()]],2)},staticRenderFns:[]};var Va={components:{AddTasks:a("VU/8")($a,Da,!1,function(e){a("TQM2")},"data-v-02f7fd53",null).exports},data:function(){return{addTasks:!1,permissions:[],currentPage:1,currentRow:"",tasksData:{count:0,results:[]},loading:!0,ruleForm:{switch:!0,crontab:"",strategy:"始终发送",receiver:"",mail_cc:"",name:"",tasktype:"UI",sensitive_keys:"",self_error:"",fail_count:1},args:[],scheduleId:"",selectTasks:[]}},methods:{handleAddTask:function(){this.addTasks=!0,this.scheduleId="",this.ruleForm={switch:!0,crontab:"",strategy:"始终发送",receiver:"",mail_cc:"",name:"",tasktype:"UI",sensitive_keys:"",self_e0rror:"",fail_count:1},this.args=[]},handleSelectionChange:function(e){this.selectTasks=e},getpermissions:function(){var e=this;b({app_label:"djcelery",model:"taskmeta"}).then(function(t){e.permissions=t.permissions})},handleCopySchedule:function(e){var t=this;this.$prompt("请输入定时任务名称","提示",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"定时任务名称不能为空"}).then(function(a){var s=a.value;St({project:t.$route.params.id,tasktype:"UI"},{tasktype:"UI",name:s,id:e}).then(function(e){201===e.status&&(t.$notify.success("复制定时任务成功"),t.getTaskList())})})},delTasks:function(e){var t=this;this.$confirm("此操作将永久删除该定时任务，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Dt(e,{params:{project:t.$route.params.id,tasktype:"UI"}}).then(function(e){204===e.status&&(t.$notify.success("删除定时任务成功"),t.getTaskList())})})},delselectTasks:function(){var e=this;0!==this.selectTasks.length?this.$confirm("此操作将永久删除选中定时任务，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Vt({project:e.$route.params.id,tasktype:"UI"},e.selectTasks).then(function(t){204===t.status&&(e.$notify.success("批量删除定时任务成功"),e.getTaskList())})}):this.$notify.error("没有勾选定时任务")},handleRunSchedule:function(e){var t=this;this.$confirm("此操作将运行此定时任务并发送邮件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0,Pt(e,{params:{tasktype:"UI"}}).then(function(e){t.$notify.success("执行成功，请稍后查看报告以及邮件"),t.loading=!1})})},handleCurrentChange:function(e){var t=this;$t({params:{page:this.currentPage,project:this.$route.params.id}}).then(function(e){t.tasksData=e})},handleEditSchedule:function(e,t){this.addTasks=!0,this.scheduleId=e,this.ruleForm.crontab=t.summary_kwargs.crontab,this.ruleForm.strategy=t.summary_kwargs.strategy,this.ruleForm.receiver=t.summary_kwargs.receiver,this.ruleForm.mail_cc=t.summary_kwargs.mail_cc,this.ruleForm.fail_count=t.summary_kwargs.fail_count,this.ruleForm.self_error=t.summary_kwargs.self_error,this.ruleForm.sensitive_keys=t.summary_kwargs.sensitive_keys,this.ruleForm.name=t.name,this.ruleForm.switch=t.enabled,this.args=t.summary_args,this.testData=t.summary_args},changeStatus:function(e){this.getTaskList(),this.addTasks=e,this.args=[],this.ruleForm={switch:!0,crontab:"",strategy:"始终发送",receiver:"",mail_cc:"",tasktype:"UI",name:"",self_error:"",fail_count:"",sensitive_keys:""}},getTaskList:function(){var e=this;Ft({params:{project:this.$route.params.id,tasktype:"UI"}}).then(function(t){e.tasksData=t,e.loading=!1})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""}},name:"Tasks",mounted:function(){this.getTaskList(),this.getpermissions()}},Pa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline",disabled:e.addTasks},on:{click:e.handleAddTask}},[e._v("添加任务\n                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",icon:"el-icon-delete",size:"mini",title:"批量删除",disabled:e.addTasks},on:{click:e.delselectTasks}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:!e.addTasks,type:"text"},on:{click:function(t){e.addTasks=!1}}},[e._v("返回列表\n                ")])],1)])]),e._v(" "),a("el-container",[e.addTasks?e._e():a("el-header",{staticStyle:{padding:"0",height:"50px","margin-top":"10px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"30px"}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.tasksData.count,expression:"tasksData.count !== 0 "}],attrs:{"page-size":11,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.tasksData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)]),e._v(" "),a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"230px",top:"100px"}},[e.addTasks?e._e():a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},height:"75%","AddTasks.vue":"","element-loading-text":"正在玩命加载",data:e.tasksData.results,"show-header":0!==e.tasksData.results.length,stripe:"","highlight-current-row":""},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}],null,!1,1281056470)}),e._v(" "),a("el-table-column",{attrs:{width:"120",label:"时间配置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.crontab))])]}}],null,!1,3364208848)}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"邮件策略"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.strategy))])]}}],null,!1,3379139436)}),e._v(" "),a("el-table-column",{attrs:{width:"80",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:"","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"scope.row.enabled"}})]}}],null,!1,1078573297)}),e._v(" "),a("el-table-column",{attrs:{label:"接收人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.receiver))])]}}],null,!1,2122237646)}),e._v(" "),a("el-table-column",{attrs:{label:"抄送人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.summary_kwargs.mail_cc))])]}}],null,!1,137736545)}),e._v(" "),a("el-table-column",{attrs:{width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",icon:"el-icon-edit",circle:"",size:"mini",title:"编辑"},on:{click:function(a){return e.handleEditSchedule(t.row.id,t.row)}}}):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",icon:"el-icon-caret-right",circle:"",size:"mini",title:"运行"},on:{click:function(a){return e.handleRunSchedule(t.row.id)}}}):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"success",icon:"el-icon-document",circle:"",size:"mini",title:"复制"},on:{click:function(a){return e.handleCopySchedule(t.row.id)}}}):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",title:"删除"},on:{click:function(a){return e.delTasks(t.row.id)}}}):e._e()],1)]}}],null,!1,1938979042)})],1)],1)]),e._v(" "),e.addTasks?a("add-tasks",{attrs:{ruleForm:e.ruleForm,args:e.args,scheduleId:e.scheduleId},on:{changeStatus:e.changeStatus}}):e._e()],1)],1)},staticRenderFns:[]};a("VU/8")(Va,Pa,!1,function(e){a("eKDA")},null,null).exports;var Na={name:"TestData",mounted:function(){this.$nextTick(function(){this.getTestdataList(),this.getpermissions(),this.getTree()})},data:function(){return{fileupload:ee(),fileList:[],filedata:{project:this.$route.params.id,name:"",relation:1},testData:{count:0,results:[]},uploadheader:{Authorization:""+m.token},permissions:[],selectTestData:[],search:"",currentRow:"",currentPage:1,loading:!0,dialogVisible:!1,nodeForm:{name:""},rules:{name:[{required:!0,message:"请输入节点名称",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}]},radio:"根节点",filterText:"",dataTree:[],currentNode:"",treeId:"",maxId:"",expand:"&#xe65f;"}},methods:{quxiao:function(){this.nodeForm.name="",this.dialogVisible=!1},handleLockTestdata:function(e){var t=this;this.$confirm("此操作将锁定此文件,之后无法更新或者删除，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a,s;(a={project:t.$route.params.id},s={project:t.$route.params.id,lock_type:1,file_id:e},p()({url:"/api/testrunner/lock_file/",method:"POST",params:a,data:s})).then(function(e){201===e.status&&t.$notify.success("文件锁定成功"),204===e.status&&t.$notify.success("文件解锁成功")})})},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"modelwithfilefield"}).then(function(t){e.permissions=t.permissions})},handleDragEnd:function(){this.updateTree(!1)},getTree:function(){var e=this;Ne(this.$route.params.id,{params:{type:5}}).then(function(t){e.dataTree=t.tree,e.treeId=t.id})},updateTree:function(e){var t=this;Re(this.treeId,{mode:e,body:this.dataTree,node:this.currentNode.id,type:3}).then(function(e){e.success?(t.dataTree=e.tree,t.$notify.success("更新成功")):t.$notify.error(e.msg)})},renameNode:function(){var e=this;this.$prompt("请输入节点名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"节点名称不能为空"}).then(function(t){var a=t.value,s=e.data.parent,n=s.data.children||s.data;n[n.findIndex(function(t){return t.id===e.currentNode.id})].label=a,e.updateTree(!1)})},deleteNode:function(){var e=this;this.$confirm("此操作将永久删除该节点下所有测试文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){""===e.currentNode?e.$notify.info("请选择一个节点"):0!==e.currentNode.children.length?e.$notify.warning("此节点有子节点，不可删除！"):(e.remove(e.currentNode,e.data),e.updateTree(!0))})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.append(t.currentNode),t.updateTree(!1),t.dialogVisible=!1,t.nodeForm.name="")})},handleNodeClick:function(e,t){this.currentNode=e,this.data=t},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},remove:function(e,t){var a=t.parent,s=a.data.children||a.data,n=s.findIndex(function(t){return t.id===e.id});s.splice(n,1)},append:function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var a={id:t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),label:this.nodeForm.name,children:[]};""!==e&&0!==this.dataTree.length&&"根节点"!==this.radio?(e.children||this.$set(e,"children",[]),e.children.push(a)):this.dataTree.push(a)},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleExceed:function(e,t){this.$notify.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},UploadBefore:function(e){if(""===this.currentNode)return this.$notify.error("请在左侧选择一个上传节点"),!1;this.filedata.name=e.name,this.filedata.relation=this.currentNode.id},handleClickUpload:function(){},uploadSuccess:function(e){this.fileList=[],this.$notify.success("文件上传成功"),this.getTestdataList(),this.currentPage=1},uploadError:function(e){401===e.status?(this.$notify.error("请先登录"),this.$router.replace({name:"Login"})):403===e.status?this.$notify.error({title:"detail",message:"您没有执行该操作的权限。"}):406===e.status?this.$notify.error({title:"detail",message:"该文件被已被锁定，无法更新或删除。"}):this.$notify.error("文件上传失败")},delSelectiontestdata:function(){var e=this;0!==this.selectTestData.length?this.$confirm("此操作将永久删除勾选的文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t,a;(t={project:e.$route.params.id},a=e.selectTestData,p.a.delete("/api/testrunner/file/del/",{params:t,data:a})).then(function(t){e.$notify.success("批量删除文件完成"),e.getTestdataList(),e.currentPage=1})}):this.$notify.warning("请至少勾选一个文件")},handleSelectionChange:function(e){this.selectTestData=e},handleCurrentChange:function(e){var t,a,s=this;(t={page:this.currentPage,project:this.filedata.project,search:this.search},a="/api/testrunner/file/?page="+t.page+"&project="+t.project+"&search="+t.search,p.a.get(a).then(function(e){return e.data})).then(function(e){s.testData=e})},handleDownTestdata:function(e,t){var a=this;te({fileType:1,id:e,project:this.$route.params.id}).then(function(e){var a=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=a,s.setAttribute("download",t),document.body.appendChild(s),s.click()}).catch(function(e){a.$notify.error("文件下载失败")})},handleDelTestdata:function(e){var t=this;this.$confirm("此操作将永久删除该测试文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a,s;(a=e,s={params:{project:t.$route.params.id}},p.a.delete("/api/testrunner/file/"+a+"/",s)).then(function(e){406===e.status?t.$notify.error({title:"detail",message:"该文件被已被锁定，无法更新或删除。"}):e.data.success?t.$notify.success(e.data.msg):t.$notify.error(e.data.msg),t.getTestdataList(),t.currentPage=1})})},getTestdataList:function(){var e=this;ae({params:{project:this.filedata.project,search:this.search,node:""===this.currentNode?"":this.currentNode.id}}).then(function(t){e.testData=t,e.loading=!1})}},watch:{filterText:function(e){this.$refs.tree3.filter(e)},currentNode:function(){this.getTestdataList()}}},Ra={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"10px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新建分组\n                ")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"新建分组",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"nodeForm",staticClass:"project",attrs:{model:e.nodeForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"节点名称",prop:"name"}},[a("el-input",{model:{value:e.nodeForm.name,callback:function(t){e.$set(e.nodeForm,"name",t)},expression:"nodeForm.name"}})],1)],1),e._v(" "),a("el-radio-group",{attrs:{size:"small"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"根节点"}}),e._v(" "),a("el-radio-button",{attrs:{label:"子节点"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.quxiao()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleConfirm("nodeForm")}}},[e._v("确 定")])],1)],1),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{disabled:""===e.currentNode,type:"danger",size:"small",icon:"el-icon-delete"},on:{click:e.deleteNode}},[e._v("删除分组\n                ")]):e._e(),e._v(" "),e.permissions.includes("change")?a("el-button",{staticStyle:{"margin-left":"0px"},attrs:{disabled:""===e.currentNode,type:"info",size:"small",icon:"el-icon-refresh-right"},on:{click:e.renameNode}},[e._v("重命名\n                ")]):e._e(),e._v(" "),a("el-upload",{staticClass:"upload-demo",staticStyle:{display:"inline"},attrs:{disabled:""===e.currentNode,action:e.fileupload,"show-file-list":!1,accept:".xlsx, .xls, .jpg, .png",multiple:"",limit:1,headers:e.uploadheader,"on-exceed":e.handleExceed,"file-list":e.fileList,"on-error":e.uploadError,"on-success":e.uploadSuccess,"before-upload":e.UploadBefore,data:e.filedata}},[e.permissions.includes("add")?a("el-button",{attrs:{disabled:""===e.currentNode,size:"small",type:"primary",icon:"el-icon-upload",title:"只能上传jpg/png/xlsx/xls文件"},on:{click:e.handleClickUpload}},[e._v("\n                        点击上传\n                    ")]):e._e()],1),e._v(" "),a("div",{staticStyle:{display:"inline"}},[e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.testData.count,expression:"testData.count !== 0 "}],staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini",title:"批量删除"},on:{click:e.delSelectiontestdata}},[e._v("批量删除")]):e._e()],1)],1)])]),e._v(" "),a("el-container",[a("el-container",[a("el-aside",{staticStyle:{"margin-top":"150px"}},[a("div",{staticClass:"nav-api-side",staticStyle:{"margin-top":"50px"}},[a("div",{staticClass:"api-tree"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"medium",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree3",attrs:{data:e.dataTree,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,draggable:"","highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick,"node-drag-end":e.handleDragEnd},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expand)}}),e._v("  "+e._s(s.label))])])}}])})],1)])]),e._v(" "),a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("el-header",{staticStyle:{"margin-left":"-10px","margin-top":"8px",height:"50px"}},[a("div",{staticStyle:{overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入文件名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getTestdataList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},"element-loading-text":"正在玩命加载","highlight-current-row":"",data:e.testData.results,"show-header":0!==e.testData.results.length,stripe:"",height:"600px"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"上传时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.create_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"300",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("add")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.testData.count,expression:"testData.count !== 0"}],attrs:{type:"success",size:"mini",title:"下载"},on:{click:function(a){return e.handleDownTestdata(t.row.id,t.row.name)}}},[e._v("\n                                    下载\n                                    ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.testData.count,expression:"testData.count !== 0"}],attrs:{type:"danger",size:"mini",title:"删除"},on:{click:function(a){return e.handleDelTestdata(t.row.id)}}},[e._v("删除\n                                    ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.testData.count,expression:"testData.count !== 0 "}],attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.testData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var ja={data:function(){return{resultdialogVisible:!1,search:"",selectVariables:[],currentRow:"",currentPage:1,permissions:[],fileoneexceltree:[],filetwoexceltree:[],DataContrastData:{count:0,results:[]},testData:[],results:[],asdialogVisible:!1,editdialogVisible:!1,dialogVisible:!1,DataContrastForm:{fileonename:"",fileoneid:"",fileonesheet:"",filetwoname:"",filetwoid:"",filetwosheet:"",project:this.$route.params.id,fileoneRange:"",filetwoRange:"",desc:""},asynform:{isasyncs:!0,project:this.$route.params.id,id:""},editDataContrastForm:{fileonename:"",fileoneid:"",fileonesheet:"",filetwoname:"",filetwoid:"",filetwosheet:"",fileoneRange:"",filetwoRange:"",desc:"",id:""},rules:{fileonename:[{required:!0,message:"请选择文件一",trigger:"blur"}],fileonesheet:[{required:!0,message:"请选择sheet页",trigger:"blur"}],filetwoname:[{required:!0,message:"请选择文件二",trigger:"blur"}],filetwosheet:[{required:!0,message:"请选择sheet页",trigger:"blur"}],isasyncs:[{required:!0,message:"请选择运行方式",trigger:"blur"}],fileoneRange:[{required:!0,message:"请输入文件一单元格范围",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}],filetwoRange:[{required:!0,message:"请输入文件二单元格范围",trigger:"blur"},{min:1,max:50,message:"最多不超过50个字符",trigger:"blur"}]}}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handlerelustDataContrasts:function(e){this.results=e,this.resultdialogVisible=!0},getpermissions:function(){var e=this;b({app_label:"test_runner",model:"modelwithfilefield"}).then(function(t){e.permissions=t.permissions})},handleDataContrast:function(e){this.editDataContrastForm={fileonename:e.fileonename,fileoneid:e.fileoneid,fileonesheet:e.fileonesheet,filetwoname:e.filetwoname,filetwoid:e.filetwoid,filetwosheet:e.filetwosheet,fileoneRange:e.fileoneRange,filetwoRange:e.filetwoRange,desc:e.desc,id:e.id},this.editdialogVisible=!0},showtable:function(e){this.asynform={isasyncs:!0,project:this.$route.params.id,id:e},this.asdialogVisible=!0},handrunDataContrastById:function(){var e,t,a=this;this.asdialogVisible=!1,(e=this.asynform.id,t={params:{project:this.$route.params.id,isasyncs:this.asynform.isasyncs}},p.a.get("/api/testrunner/run_datacontrast_pk/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.success?(a.$message.success(e.msg),a.getDataContrastList()):a.$message.error(e.msg)})},handleDelDataContrast:function(e){var t=this;this.$confirm("此操作将永久删除该核对记录，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/datacontrast/"+a+"/").then(function(e){return e.data})).then(function(e){e.success?t.getDataContrastList():t.$message.error(e.msg)})})},handleSelectionChange:function(e){this.selectVariables=e},getfileoneexceltree:function(e){if(this.DataContrastForm.fileonesheet="",this.editDataContrastForm.fileonesheet="",null!=e&&""!=e&&void 0!=e){var t;t=this.testData.find(function(t){return t.name==e}),this.DataContrastForm.fileoneid=t.id,this.editDataContrastForm.fileoneid=t.id,this.fileoneexceltree=t.excel_tree.children}},getfiletwoexceltree:function(e){if(this.DataContrastForm.filetwosheet="",this.editDataContrastForm.filetwosheet="",null!=e&&""!=e&&void 0!=e){var t;t=this.testData.find(function(t){return t.name==e}),this.DataContrastForm.filetwoid=t.id,this.editDataContrastForm.filetwoid=t.id,this.filetwoexceltree=t.excel_tree.children}},clearone:function(){this.DataContrastForm.fileonename="",this.DataContrastForm.fileoneid="",this.DataContrastForm.fileonesheet="",this.editDataContrastForm.fileonename="",this.editDataContrastForm.fileonesheet=""},cleartwo:function(){this.DataContrastForm.filetwoname="",this.DataContrastForm.filetwosheet="",this.DataContrastForm.filetwoid="",this.editDataContrastForm.filetwoname="",this.editDataContrastForm.filetwosheet=""},getTestdataList:function(){var e=this;ae({params:{project:this.$route.params.id,search:"",node:""}}).then(function(t){e.testData=t.results})},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/datacontrast/",t).then(function(e){return e.data})).then(function(e){a.DataContrastData=e})},delSelectionVariables:function(){var e=this;0!==this.selectVariables.length?this.$confirm("此操作将永久删除勾选的核对记录，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectVariables},p.a.delete("/api/testrunner/datacontrast/",t).then(function(e){return e.data})).then(function(t){e.getDataContrastList()})}):this.$notify.warning({title:"提示",message:"请至少勾选一个核对记录",duration:1e3})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.dialogVisible=!1,(a=t.DataContrastForm,p.a.post("/api/testrunner/datacontrast/",a).then(function(e){return e.data})).then(function(e){e.success?(t.DataContrastForm.fileonename="",t.DataContrastForm.fileoneid="",t.DataContrastForm.fileonesheet="",t.DataContrastForm.filetwoname="",t.DataContrastForm.filetwoid="",t.DataContrastForm.filetwosheet="",t.DataContrastForm.fileoneRange="",t.DataContrastForm.filetwoRange="",t.DataContrastForm.desc="",t.getDataContrastList()):t.$message.info({message:e.msg,duration:1e3})}))})},handleEditConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a,s;e&&(t.editdialogVisible=!1,(a=t.editDataContrastForm.id,s=t.editDataContrastForm,p.a.patch("/api/testrunner/datacontrast/"+a+"/",s).then(function(e){return e.data})).then(function(e){e.success?t.getDataContrastList():t.$message.info({message:e.msg,duration:1e3})}))})},getDataContrastList:function(){var e,t=this;(e={params:{project:this.$route.params.id,search:this.search}},p.a.get("/api/testrunner/datacontrast/",e).then(function(e){return e.data})).then(function(e){t.DataContrastData=e})}},name:"DataContrast",mounted:function(){this.getDataContrastList(),this.getTestdataList(),this.getpermissions()}},La={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("view")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加数据核对\n                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.DataContrastData.count,expression:"DataContrastData.count !== 0 "}],staticStyle:{"margin-left":"20px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:e.delSelectionVariables}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"核对结果",visible:e.resultdialogVisible,width:"50%",align:"center"},on:{"update:visible":function(t){e.resultdialogVisible=t}}},[a("div",{staticClass:"outer-container"},[a("div",{staticClass:"inner-container"},e._l(e.results,function(t){return a("div",{key:t},[a("span",[e._v(e._s(t))])])}),0)])]),e._v(" "),a("el-dialog",{attrs:{title:"请选择运行方式",visible:e.asdialogVisible,width:"20%",center:""},on:{"update:visible":function(t){e.asdialogVisible=t}}},[a("p",{staticStyle:{color:"red","text-align":"center"}},[e._v("部分EXCEL打开时间较长，建议使用异步执行")]),e._v(" "),a("el-form",{ref:"asynform",staticClass:"project",staticStyle:{"text-align":"center"},attrs:{model:e.asynform,rules:e.rules,"label-width":"100px"}},[a("div",{staticStyle:{"margin-top":"20px"}},[a("el-radio",{attrs:{label:!1,border:"",size:"medium",prop:"isasyncs"},model:{value:e.asynform.isasyncs,callback:function(t){e.$set(e.asynform,"isasyncs",t)},expression:"asynform.isasyncs"}},[e._v("调试")]),e._v(" "),a("el-radio",{attrs:{label:!0,border:"",size:"medium",prop:"isasyncs"},model:{value:e.asynform.isasyncs,callback:function(t){e.$set(e.asynform,"isasyncs",t)},expression:"asynform.isasyncs"}},[e._v("异步")])],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.asdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handrunDataContrastById()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加数据核对",visible:e.dialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"DataContrastForm",staticClass:"project",attrs:{model:e.DataContrastForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文件一",prop:"fileonename"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择文件一"},on:{change:function(t){return e.getfileoneexceltree(t)},clear:function(t){return e.clearone()}},model:{value:e.DataContrastForm.fileonename,callback:function(t){e.$set(e.DataContrastForm,"fileonename",t)},expression:"DataContrastForm.fileonename"}},e._l(e.testData,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"sheet",prop:"fileonesheet"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择sheet页"},model:{value:e.DataContrastForm.fileonesheet,callback:function(t){e.$set(e.DataContrastForm,"fileonesheet",t)},expression:"DataContrastForm.fileonesheet"}},e._l(e.fileoneexceltree,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"单元格范围",prop:"fileoneRange"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入核对的单元格范围,比如：A1:B5"},model:{value:e.DataContrastForm.fileoneRange,callback:function(t){e.$set(e.DataContrastForm,"fileoneRange",t)},expression:"DataContrastForm.fileoneRange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件二",prop:"filetwoname"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择文件二"},on:{change:function(t){return e.getfiletwoexceltree(t)},clear:function(t){return e.cleartwo()}},model:{value:e.DataContrastForm.filetwoname,callback:function(t){e.$set(e.DataContrastForm,"filetwoname",t)},expression:"DataContrastForm.filetwoname"}},e._l(e.testData,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"sheet",prop:"filetwosheet"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择sheet页"},model:{value:e.DataContrastForm.filetwosheet,callback:function(t){e.$set(e.DataContrastForm,"filetwosheet",t)},expression:"DataContrastForm.filetwosheet"}},e._l(e.filetwoexceltree,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"单元格范围",prop:"filetwoRange"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入核对的单元格范围,比如：A1:B5"},model:{value:e.DataContrastForm.filetwoRange,callback:function(t){e.$set(e.DataContrastForm,"filetwoRange",t)},expression:"DataContrastForm.filetwoRange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"desc"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入简要描述"},model:{value:e.DataContrastForm.desc,callback:function(t){e.$set(e.DataContrastForm,"desc",t)},expression:"DataContrastForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("DataContrastForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑数据核对",visible:e.editdialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.editdialogVisible=t}}},[a("el-form",{ref:"editDataContrastForm",staticClass:"project",attrs:{model:e.editDataContrastForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文件一",prop:"fileonename"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择文件一"},on:{change:function(t){return e.getfileoneexceltree(t)},clear:function(t){return e.clearone()}},model:{value:e.editDataContrastForm.fileonename,callback:function(t){e.$set(e.editDataContrastForm,"fileonename",t)},expression:"editDataContrastForm.fileonename"}},e._l(e.testData,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"sheet",prop:"fileonesheet"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择sheet页"},model:{value:e.editDataContrastForm.fileonesheet,callback:function(t){e.$set(e.editDataContrastForm,"fileonesheet",t)},expression:"editDataContrastForm.fileonesheet"}},e._l(e.fileoneexceltree,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"单元格范围",prop:"fileoneRange"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入核对的单元格范围,比如：A1:B5"},model:{value:e.editDataContrastForm.fileoneRange,callback:function(t){e.$set(e.editDataContrastForm,"fileoneRange",t)},expression:"editDataContrastForm.fileoneRange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件二",prop:"filetwoname"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择文件二"},on:{change:function(t){return e.getfiletwoexceltree(t)},clear:function(t){return e.cleartwo()}},model:{value:e.editDataContrastForm.filetwoname,callback:function(t){e.$set(e.editDataContrastForm,"filetwoname",t)},expression:"editDataContrastForm.filetwoname"}},e._l(e.testData,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"sheet",prop:"filetwosheet"}},[a("el-select",{staticStyle:{float:"left",width:"100%"},attrs:{size:"medium",clearable:"",placeholder:"请选择sheet页"},model:{value:e.editDataContrastForm.filetwosheet,callback:function(t){e.$set(e.editDataContrastForm,"filetwosheet",t)},expression:"editDataContrastForm.filetwosheet"}},e._l(e.filetwoexceltree,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"单元格范围",prop:"filetwoRange"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入核对的单元格范围,比如：A1:B5"},model:{value:e.editDataContrastForm.filetwoRange,callback:function(t){e.$set(e.editDataContrastForm,"filetwoRange",t)},expression:"editDataContrastForm.filetwoRange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"desc"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入简要描述"},model:{value:e.editDataContrastForm.desc,callback:function(t){e.$set(e.editDataContrastForm,"desc",t)},expression:"editDataContrastForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditConfirm("editDataContrastForm")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"20px",overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入关键字",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getDataContrastList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"220px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.DataContrastData.results,"show-header":0!==e.DataContrastData.results.length,stripe:"",height:"calc(75%)"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"文件一","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.fileonename)+"-"+e._s(t.row.fileonesheet)+"-["+e._s(t.row.fileoneRange)+"]")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文件二","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.filetwoname)+"-"+e._s(t.row.filetwosheet)+"-["+e._s(t.row.filetwoRange)+"]")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态","show-overflow-tooltip":"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.Status?a("div",[e._v("未核对")]):e._e(),e._v(" "),1==t.row.Status?a("div",[e._v("核对中")]):e._e(),e._v(" "),2==t.row.Status?a("div",[e._v("核对完成")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"创建人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"300",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("add")?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.showtable(t.row.id)}}},[e._v("核对")]):e._e(),e._v(" "),e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleDataContrast(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("view")?a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return e.handlerelustDataContrasts(t.row.result)}}},[e._v("查看")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.DataContrastData.count,expression:"DataContrastData.count !== 0"}],attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelDataContrast(t.row.id)}}},[e._v("删除\n                                    ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.DataContrastData.count,expression:"DataContrastData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":11,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.DataContrastData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var Ea={components:{TestData:a("VU/8")(Na,Ra,!1,function(e){a("gsZH")},"data-v-24f29282",null).exports,DataContrast:a("VU/8")(ja,La,!1,function(e){a("0Qll")},null,null).exports},data:function(){return{activeName:"first",tabs:{first:!0,second:!1}}},methods:{handleClick:function(e){switch(this.activeName=e.name,this.activeName){case"first":this.switchTab("first");break;case"second":this.switchTab("second")}},switchTab:function(e){for(var t in this.tabs)this.tabs[t]=t===e}}},Ia={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticStyle:{"padding-top":"10px","margin-left":"10px"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"资料管理",name:"first"}},[e.tabs.first?a("TestData"):e._e()],1)],1)},staticRenderFns:[]},Aa=a("VU/8")(Ea,Ia,!1,null,null,null).exports,Ba={data:function(){return{fileupload:ne(),uploadheader:{Authorization:""+m.token},fileList:[],filedata:{project:this.$route.params.id,name:""},permissions:[],search:"",selectVariables:[],currentRow:"",currentPage:1,variablesData:{count:0,results:[]},editdialogVisible:!1,dialogVisible:!1,tkdialogVisible:!1,variablesForm:{key:"",value:"",desc:"",project:this.$route.params.id},editVariablesForm:{key:"",value:"",desc:"",id:""},rules:{key:[{required:!0,message:"请输入变量名",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}],value:[{required:!0,message:"请输入变量值",trigger:"blur"},{min:1,max:1024,message:"最多不超过1024个字符",trigger:"blur"}]}}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},UploadBefore:function(e){this.filedata.name=e.name},handleClickUpload:function(){},uploadSuccess:function(e){this.fileList=[],this.$notify.success({message:e.msg}),this.getVariablesList()},uploadError:function(e){401===e.status?(this.$notify.error("请先登录"),this.$router.replace({name:"Login"})):403===e.status?this.$notify.error({title:"detail",message:"您没有执行该操作的权限。"}):this.$notify.error({message:e.msg})},getpermissions:function(){var e=this;b({app_label:"TestRunner",model:"uivariables"}).then(function(t){e.permissions=t.permissions})},exportVariable:function(){var e=this;se({project:this.$route.params.id}).then(function(t){new Blob([t.data],{type:"application/vnd.ms-excel"});var a=window.URL.createObjectURL(t.data),s=document.createElement("a");s.style.display="none",s.download="全局变量.xls",s.href=a,s.click(),200==t.status?e.$notify.success({message:"导出成功"}):e.$notify.error({message:"导出失败"})})},handleEditVariables:function(e){this.editVariablesForm={key:e.key,value:e.value,desc:e.desc,id:e.id},this.editdialogVisible=!0},handleExceed:function(e,t){this.$notify.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleDelVariables:function(e){var t=this;this.$confirm("此操作将永久删除该全局变量，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/uivariables/"+a+"/").then(function(e){return e.data})).then(function(e){e.success?t.getVariablesList():t.$message.error(e.msg)})})},handleSelectionChange:function(e){this.selectVariables=e},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.variablesForm.project,search:this.search}},p.a.get("/api/testrunner/uivariables/",t).then(function(e){return e.data})).then(function(e){a.variablesData=e})},delSelectionVariables:function(){var e=this;0!==this.selectVariables.length?this.$confirm("此操作将永久删除勾选的全局变量，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectVariables},p.a.delete("/api/testrunner/uivariables/",t).then(function(e){return e.data})).then(function(t){e.getVariablesList()})}):this.$notify.warning({title:"提示",message:"请至少勾选一个全局变量",duration:1e3})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.dialogVisible=!1,(a=t.variablesForm,p.a.post("/api/testrunner/uivariables/",a).then(function(e){return e.data})).then(function(e){e.success?(t.variablesForm.key="",t.variablesForm.value="",t.variablesForm.desc="",t.getVariablesList()):t.$message.info({message:e.msg,duration:1e3})}))})},handleEditConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a,s;e&&(t.editdialogVisible=!1,(a=t.editVariablesForm.id,s=t.editVariablesForm,p.a.patch("/api/testrunner/uivariables/"+a+"/",s).then(function(e){return e.data})).then(function(e){e.success?t.getVariablesList():t.$message.info({message:e.msg,duration:1e3})}))})},getVariablesList:function(){var e,t=this;(e={params:{project:this.variablesForm.project,search:this.search}},p.a.get("/api/testrunner/uivariables/",e).then(function(e){return e.data})).then(function(e){t.variablesData=e})}},name:"UiGlobalEnv",mounted:function(){this.getVariablesList(),this.getpermissions()}},qa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新增变量\n                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.variablesData.count,expression:"variablesData.count !== 0 "}],staticStyle:{"margin-left":"20px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:e.delSelectionVariables}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"添加变量",visible:e.dialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"variablesForm",staticClass:"project",attrs:{model:e.variablesForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"变量名",prop:"key"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量名"},model:{value:e.variablesForm.key,callback:function(t){e.$set(e.variablesForm,"key",t)},expression:"variablesForm.key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量值",prop:"value"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量值"},model:{value:e.variablesForm.value,callback:function(t){e.$set(e.variablesForm,"value",t)},expression:"variablesForm.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量描述",prop:"desc"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入描述"},model:{value:e.variablesForm.desc,callback:function(t){e.$set(e.variablesForm,"desc",t)},expression:"variablesForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("variablesForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑变量",visible:e.editdialogVisible,width:"30%",align:"center"},on:{"update:visible":function(t){e.editdialogVisible=t}}},[a("el-form",{ref:"editVariablesForm",staticClass:"project",attrs:{model:e.editVariablesForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"变量名",prop:"key"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量名"},model:{value:e.editVariablesForm.key,callback:function(t){e.$set(e.editVariablesForm,"key",t)},expression:"editVariablesForm.key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量值",prop:"value"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入变量值"},model:{value:e.editVariablesForm.value,callback:function(t){e.$set(e.editVariablesForm,"value",t)},expression:"editVariablesForm.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"变量描述",prop:"desc"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入描述"},model:{value:e.editVariablesForm.desc,callback:function(t){e.$set(e.editVariablesForm,"desc",t)},expression:"editVariablesForm.desc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditConfirm("editVariablesForm")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"30px",overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入变量名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getVariablesList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"150px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},"highlight-current-row":"",data:e.variablesData.results,"show-header":0!==e.variablesData.results.length,stripe:"",height:"calc(75%)"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"变量名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.key))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"变量值","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"创建人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditVariables(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.variablesData.count,expression:"variablesData.count !== 0"}],attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelVariables(t.row.id)}}},[e._v("删除\n                                    ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.variablesData.count,expression:"variablesData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":11,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.variablesData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};a("VU/8")(Ba,qa,!1,function(e){a("qsDG")},null,null).exports;var za={components:{Variables:ve},props:{project:{require:!1},response:{require:!1}},watch:{response:function(){this.name=this.response.name,this.basePage=this.response.base_page,this.configdesc=this.response.configdesc,this.id=this.response.id}},methods:{handleVariables:function(e){this.variables=e,""===this.id?this.addConfig():this.updateConfig()},addConfig:function(){var e,t=this;this.validateData()&&(e={variables:this.variables,base_page:this.basePage,configdesc:this.configdesc,name:this.name,project:this.project},p.a.post("/api/testrunner/uiconfig/",e).then(function(e){return e.data})).then(function(e){e.success?t.$emit("addSuccess"):t.$message.error({message:e.msg,duration:1e3})})},updateConfig:function(){var e,t,a=this;this.validateData()&&(e=this.id,t={variables:this.variables,base_page:this.basePage,configdesc:this.configdesc,name:this.name},p.a.patch("/api/testrunner/uiconfig/"+e+"/",t).then(function(e){return e.data})).then(function(e){e.success?a.$emit("addSuccess"):a.$message.error({message:e.msg,duration:1e3})})},validateData:function(){return""!==this.name||(this.$notify.error({title:"参数错误",message:"配置名称不能为空",duration:1500}),!1)}},data:function(){return{name:"",basePage:"",configdesc:"",id:"",variables:[],save:!1,activeTag:"third"}},name:"ConfigBody"},Ua={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"10px"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入配置名称",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[a("template",{slot:"prepend"},[e._v("配置信息录入")]),e._v(" "),a("el-button",{attrs:{slot:"append",type:"success",plain:""},on:{click:function(t){e.save=!e.save}},slot:"append"},[e._v("保存\n            ")])],2)],1),e._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入所属页面",clearable:""},model:{value:e.basePage,callback:function(t){e.basePage=t},expression:"basePage"}},[a("template",{slot:"prepend"},[e._v("所属页面")])],2)],1),e._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入配置描述信息",clearable:""},model:{value:e.configdesc,callback:function(t){e.configdesc=t},expression:"configdesc"}},[a("template",{slot:"prepend"},[e._v("配置描述信息")])],2)],1),e._v(" "),a("div",{staticClass:"request"},[a("el-tabs",{staticStyle:{"margin-left":"20px"},model:{value:e.activeTag,callback:function(t){e.activeTag=t},expression:"activeTag"}},[a("el-tab-pane",{attrs:{label:"变量设置",name:"third"}},[a("variables",{attrs:{save:e.save,variables:e.response?e.response.body.variables:[]},on:{variables:e.handleVariables}})],1)],1)],1)])},staticRenderFns:[]};var Ma=a("VU/8")(za,Ua,!1,function(e){a("UAAL")},"data-v-577efc77",null).exports,Oa={name:"ConfigList",props:{back:Boolean,project:{require:!0},del:Boolean,permissions:{require:!0}},data:function(){return{search:"",selectConfig:[],currentRow:"",currentPage:1,configdes:"",configData:{count:0,results:[]}}},watch:{back:function(){this.getConfigList()},del:function(){var e=this;0!==this.selectConfig.length?this.$confirm("此操作将永久删除配置，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectConfig},p.a.delete("/api/testrunner/uiconfig/",t).then(function(e){return e.data})).then(function(t){e.getConfigList()})}):this.$notify.warning({title:"提示",message:"请至少勾选一个配置",duration:1e3})}},methods:{handleSelectionChange:function(e){this.selectConfig=e},handleCurrentChange:function(e){var t,a=this;(t={params:{page:this.currentPage,project:this.project,search:this.search}},p.a.get("/api/testrunner/uiconfig/",t).then(function(e){return e.data})).then(function(e){a.configData=e})},handleDelConfig:function(e){var t=this;this.$confirm("此操作将永久删除该配置，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/testrunner/uiconfig/"+a+"/").then(function(e){return e.data})).then(function(e){e.success?t.getConfigList():t.$message.error(e.msg)})})},handleEditConfig:function(e){this.$emit("respConfig",e)},handleCopyConfig:function(e){var t=this;this.$prompt("请输入配置名称","提示",{confirmButtonText:"确定",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"配置名称不能为空"}).then(function(a){var s,n,r=a.value;(s=e,n={name:r},p.a.post("/api/testrunner/uiconfig/"+s+"/",n).then(function(e){return e.data})).then(function(e){e.success?t.getConfigList():t.$message.error(e.msg)})})},cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},getConfigList:function(){var e,t=this;(e={params:{project:this.project,search:this.search}},p.a.get("/api/testrunner/uiconfig/",e).then(function(e){return e.data})).then(function(e){t.configData=e})}},mounted:function(){this.getConfigList()}},Ha={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{"padding-top":"10px",height:"50px",padding:"0"}},[a("div",[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入配置名称",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getConfigList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"150px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.configData.results,"show-header":0!==e.configData.results.length,stripe:"",height:"75%"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"配置名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属页面"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{textContent:e._s(""===t.row.base_page?"无":t.row.base_page)}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:t.row.configdesc}},[e._v(e._s(t.row.configdesc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.create_user))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.update_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[e.permissions.includes("change")?a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditConfig(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleCopyConfig(t.row.id)}}},[e._v("复制\n                                ")]):e._e(),e._v(" "),e.permissions.includes("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelConfig(t.row.id)}}},[e._v("删除\n                                ")]):e._e()],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.configData.count,expression:"configData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":11,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.configData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)},staticRenderFns:[]};var Ga={components:{ConfigBody:Ma,ConfigList:a("VU/8")(Oa,Ha,!1,function(e){a("l99c")},"data-v-313da264",null).exports},computed:{initResponse:{get:function(){return this.addConfigActivate},set:function(e){this.addConfigActivate=e,this.respConfig={id:"",body:{name:"",base_page:"",confdesc:"",variables:[{key:"",value:"",desc:"",type:1}]}}}}},data:function(){return{permissions:[],back:!1,del:!1,addConfigActivate:!1,respConfig:""}},methods:{handleAddSuccess:function(){this.back=!this.back,this.addConfigActivate=!1},getpermissions:function(){var e=this;b({app_label:"TestRunner",model:"uiconfig"}).then(function(t){e.permissions=t.permissions})},handleRespConfig:function(e){this.respConfig=e,this.addConfigActivate=!0}},name:"UIRecordConfig",mounted:function(){this.getpermissions()}},Ka={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[e.permissions.includes("add")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.initResponse=!0}}},[e._v("新增配置\n                ")]):e._e(),e._v(" "),e.permissions.includes("add")?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){e.del=!e.del}}},[e._v("批量删除")]):e._e(),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"30px"},attrs:{disabled:!e.addConfigActivate,type:"text"},on:{click:function(t){e.addConfigActivate=!1}}},[e._v("返回列表")])],1)])]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"20px"}},[a("config-body",{directives:[{name:"show",rawName:"v-show",value:e.addConfigActivate,expression:"addConfigActivate"}],attrs:{project:e.$route.params.id,response:e.respConfig},on:{addSuccess:e.handleAddSuccess}}),e._v(" "),e.addConfigActivate?e._e():a("config-list",{attrs:{permissions:e.permissions,project:e.$route.params.id,del:e.del,back:e.back},on:{respConfig:e.handleRespConfig}})],1)],1)],1)},staticRenderFns:[]};a("VU/8")(Ga,Ka,!1,function(e){a("93n+")},null,null).exports;var Ja={name:"DataStatistics",data:function(){return{projectMessage:[]}},methods:{success:function(e){this.$notify({message:e.msg,type:"success",duration:1e3})},failure:function(e){this.$notify.error({message:e.msg,duration:1e3})},getProjectDetail:function(){var e=this;p.a.get("/api/testrunner/getallprojectmessage/").then(function(e){return e.data}).then(function(t){e.projectMessage=t.data})}},mounted:function(){this.getProjectDetail()}},Za={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"box-card"},[a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266","text-align":"center"},data:e.projectMessage,stripe:"",border:""}},[a("el-table-column",{attrs:{width:"60",label:"序号",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pr_name",label:"项目名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"api_count",label:"接口数量",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{prop:"case_count",label:"用例数量",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Cove_Count",label:"覆盖接口数量",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{label:"用例覆盖率",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.Case_Coveage)+"%")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"task_count",label:"任务数",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{prop:"PlanCase_Count",label:"执行用例数",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{label:"执行覆盖率",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.Plan_Coveage)+"%")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"report_count",label:"测试报告数",align:"right"}})],1)],1)])},staticRenderFns:[]},Qa=a("VU/8")(Ja,Za,!1,null,null,null).exports,Wa=function(e){return p.a.get("/api/user/group/",e).then(function(e){return e.data})},Xa={data:function(){var e=this;return{search:"",selectVariables:[],currentRow:"",currentPage:1,userData:{count:0,results:[]},editdialogVisible:!1,dialogVisible:!1,tkdialogVisible:!1,usersForm:{name:"",username:"",password:"",newpassword:"",email:"",is_active:!0},data:[],groupdata:[],projectData:[],editusersForm:{name:"",username:"",email:"",is_active:"",is_superuser:"",belong_project:[],groups:[],id:""},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}],username:[{validator:function(e,t,a){return t?/^[a-zA-Z0-9_-]{4,16}$/.test(t)?void a():a(new Error("用户名4到16位,只能是字母,数字,下划线,连字符")):a(new Error("账号不能为空"))},required:!0,trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:50,message:"最少需要6个字符",trigger:"blur"}],newpassword:[{validator:function(t,a,s){if(!a)return s(new Error("确认密码不能为空"));a!==e.usersForm.password?s(new Error("与密码不一致!")):a.toString().length<6?s(new Error("密码至少六位")):s()},required:!0,trigger:"blur"}],is_active:[{required:!0,message:"请选择是否启用",trigger:"blur"}],is_superuser:[{required:!0,message:"请选择角色类型",trigger:"blur"}],email:[{validator:function(e,t,a){return t?/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(t)?void a():a(new Error("邮箱格式不正确")):a(new Error("邮箱不能为空"))},required:!0,trigger:"blur"}]}}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},clear:function(){},handleEditVariables:function(e){this.editusersForm={name:e.name,username:e.username,email:e.email,id:e.id,is_active:e.is_active,is_superuser:e.is_superuser,belong_project:e.belong_project,groups:e.groups},this.editdialogVisible=!0},getProjectList:function(){var e=this;E().then(function(t){e.projectData=t.results2;var a=[];e.projectData.forEach(function(e,t){a.push({key:e.id,label:e.name})}),e.data=a})},getUserGroupList:function(){var e=this;Wa({params:{search:""}}).then(function(t){var a=[];t.results2.forEach(function(e,t){a.push({key:e.id,label:e.name})}),e.groupdata=a})},handleDelUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,v("/api/user/userinfo/"+a+"/")).then(function(e){e.success?t.GetUserlist():t.$message.error(e.msg)})})},handleSelectionChange:function(e){this.selectVariables=e},handleCurrentChange:function(e){var t,a=this;(t={page:this.currentPage,search:this.search},h("/api/user/userinfo/",t)).then(function(e){a.userData=e})},delSelectionUsers:function(){var e=this;0!==this.selectVariables.length?this.$confirm("此操作将永久删除勾选的用户，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectVariables},v("/api/user/userinfo/",t)).then(function(t){e.GetUserlist()})}):this.$notify.warning({title:"提示",message:"请至少勾选一个用户",duration:1e3})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.dialogVisible=!1,(a=t.usersForm,f("/api/user/userinfo/",a)).then(function(e){e.success?(t.$message.success({message:e.msg,duration:1e3}),t.usersForm.name="",t.usersForm.username="",t.usersForm.password="",t.usersForm.newpassword="",t.usersForm.is_active=!0,t.usersForm.email="",t.GetUserlist()):t.$message.error(e.msg)}))})},handleEditConfirm:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.editdialogVisible=!1,_(t.editusersForm).then(function(e){e.success?(t.$message.success(e.msg),t.GetUserlist()):t.$message.error({message:e.msg,duration:1e3})}))})},GetUserlist:function(){var e,t=this;(e={search:this.search},h("/api/user/userinfo/",e)).then(function(e){t.userData=e})}},name:"UserList",mounted:function(){this.GetUserlist(),this.getProjectList(),this.getUserGroupList()}},Ya={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新增用户\n                ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.userData.count,expression:"userData.count !== 0 "}],staticStyle:{"margin-left":"20px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:e.delSelectionUsers}},[e._v("批量删除")]),e._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:e.dialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"usersForm",staticClass:"project",attrs:{model:e.usersForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入姓名"},model:{value:e.usersForm.name,callback:function(t){e.$set(e.usersForm,"name",t)},expression:"usersForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入账号"},model:{value:e.usersForm.username,callback:function(t){e.$set(e.usersForm,"username",t)},expression:"usersForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入密码",type:"password"},model:{value:e.usersForm.password,callback:function(t){e.$set(e.usersForm,"password",t)},expression:"usersForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"newpassword"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入确认密码",type:"password"},model:{value:e.usersForm.newpassword,callback:function(t){e.$set(e.usersForm,"newpassword",t)},expression:"usersForm.newpassword"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"E-Mail",prop:"email"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入E-Mail"},model:{value:e.usersForm.email,callback:function(t){e.$set(e.usersForm,"email",t)},expression:"usersForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"is_active"}},[a("el-radio",{attrs:{label:!0},model:{value:e.usersForm.is_active,callback:function(t){e.$set(e.usersForm,"is_active",t)},expression:"usersForm.is_active"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:!1},model:{value:e.usersForm.is_active,callback:function(t){e.$set(e.usersForm,"is_active",t)},expression:"usersForm.is_active"}},[e._v("否")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("usersForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑用户",visible:e.editdialogVisible,width:"60%",center:""},on:{"update:visible":function(t){e.editdialogVisible=t}}},[a("el-form",{ref:"editusersForm",staticClass:"project",attrs:{model:e.editusersForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入姓名"},model:{value:e.editusersForm.name,callback:function(t){e.$set(e.editusersForm,"name",t)},expression:"editusersForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{attrs:{disabled:"",placeholder:"请输入账号"},model:{value:e.editusersForm.username,callback:function(t){e.$set(e.editusersForm,"username",t)},expression:"editusersForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"E-Mail",prop:"email"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入E-Mail"},model:{value:e.editusersForm.email,callback:function(t){e.$set(e.editusersForm,"email",t)},expression:"editusersForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"is_active"}},[a("el-radio",{attrs:{label:!0},model:{value:e.editusersForm.is_active,callback:function(t){e.$set(e.editusersForm,"is_active",t)},expression:"editusersForm.is_active"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:!1},model:{value:e.editusersForm.is_active,callback:function(t){e.$set(e.editusersForm,"is_active",t)},expression:"editusersForm.is_active"}},[e._v("否")])],1),e._v(" "),a("el-form-item",{attrs:{label:"是否超管",prop:"is_superuser"}},[a("el-radio",{attrs:{label:!0},model:{value:e.editusersForm.is_superuser,callback:function(t){e.$set(e.editusersForm,"is_superuser",t)},expression:"editusersForm.is_superuser"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:!1},model:{value:e.editusersForm.is_superuser,callback:function(t){e.$set(e.editusersForm,"is_superuser",t)},expression:"editusersForm.is_superuser"}},[e._v("否")])],1),e._v(" "),a("el-form-item",{staticClass:"edit_dev",attrs:{label:"所属角色"}},[a("el-transfer",{attrs:{data:e.groupdata,titles:["待选择角色","已选择角色"]},model:{value:e.editusersForm.groups,callback:function(t){e.$set(e.editusersForm,"groups",t)},expression:"editusersForm.groups"}})],1),e._v(" "),a("el-form-item",{staticClass:"edit_dev",attrs:{label:"所属项目"}},[a("el-transfer",{attrs:{data:e.data,titles:["待选择项目","已选择项目"]},model:{value:e.editusersForm.belong_project,callback:function(t){e.$set(e.editusersForm,"belong_project",t)},expression:"editusersForm.belong_project"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditConfirm("editusersForm")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"20px",overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入用户姓名或账号",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.GetUserlist},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"220px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.userData.results,"show-header":0!==e.userData.results.length,stripe:"",height:"calc(75%)"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用户账号","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.username))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"E-Mail","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.email))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否启用","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.is_active?a("div",[e._v("是")]):e._e(),e._v(" "),0==t.row.is_active?a("div",[e._v("否")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否超管","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.is_superuser?a("div",[e._v("是")]):e._e(),e._v(" "),0==t.row.is_superuser?a("div",[e._v("否")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("datetimeFormat")(t.row.date_joined)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handleEditVariables(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.userData.count,expression:"userData.count !== 0"}],attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelUser(t.row.id)}}},[e._v("删除\n                                    ")])],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.userData.count,expression:"userData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.userData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var es=a("VU/8")(Xa,Ya,!1,function(e){a("p81v")},null,null).exports,ts={data:function(){return{dialogVisible:!1,editdialogVisible:!1,search:"",currentRow:"",currentPage:1,selectVariables:[],data:[],userGroupData:{count:0,results:[]},addusergroupForm:{name:"",permissions:[]},editusergroupFrom:{id:"",name:"",permissions:[]},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:1,max:100,message:"最多不超过100个字符",trigger:"blur"}]}}},methods:{cellMouseEnter:function(e){this.currentRow=e},cellMouseLeave:function(e){this.currentRow=""},handleSelectionChange:function(e){this.selectVariables=e},handleCurrentChange:function(e){var t,a,s=this;(t={page:this.currentPage,search:this.search},a="/api/user/group/?page="+t.page+"&search="+t.search,p.a.get(a).then(function(e){return e.data})).then(function(e){s.userGroupData=e})},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.dialogVisible=!1,(a=t.addusergroupForm,p.a.post("/api/user/group/",a).then(function(e){return e.data})).then(function(e){e.success?(t.$message.success(e.msg),t.GetUserGroupList(),t.addusergroupForm.name="",t.addusergroupForm.permissions=[]):t.$message.error(e.msg)}))})},delSelectionUsers:function(){var e=this;0!==this.selectVariables.length&&this.$confirm("此操作将永久删除勾选的用户，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t={data:e.selectVariables},p.a.delete("/api/user/group/",t).then(function(e){return e.data})).then(function(t){t.success?(e.$message.success(t.msg),e.GetUserGroupList()):e.$message.error(t.msg)})})},GetUserGroupList:function(){var e=this;Wa({params:{search:this.search}}).then(function(t){e.userGroupData=t})},GerPermissionList:function(){var e,t=this;p.a.get("/api/user/permission/",e).then(function(e){return e.data}).then(function(e){var a=[];e.data.forEach(function(e,t){a.push({key:e.id,label:e.name})}),t.data=a})},handerEditUserGroup:function(e){this.editusergroupFrom={id:e.id,name:e.name,permissions:e.permissions},this.editdialogVisible=!0},handleEditConfirm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(t.editdialogVisible=!1,(a=t.editusergroupFrom,p.a.patch("/api/user/group/",a).then(function(e){return e.data})).then(function(e){e.success?(t.$message.success(e.msg),t.GetUserGroupList()):t.$message.error(e.msg)}))})},handerDelUserGroup:function(e){var t=this;this.$confirm("此操作将永久删除该用户，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e,p.a.delete("/api/user/group/"+a+"/").then(function(e){return e.data})).then(function(e){e.success?(t.$message.success(e.msg),t.GetUserGroupList()):t.$message.error(e.msg)})})}},name:"UserGroup",mounted:function(){this.GetUserGroupList(),this.GerPermissionList()}},as={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{background:"#fff",padding:"0",height:"50px"}},[a("div",{staticClass:"nav-api-header"},[a("div",{staticStyle:{"padding-top":"10px","margin-left":"20px"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n                新增角色\n                ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.userGroupData.count,expression:"userGroupData.count !== 0 "}],staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:e.delSelectionUsers}},[e._v("\n                批量删除\n                ")]),e._v(" "),a("el-dialog",{attrs:{title:"添加角色",visible:e.dialogVisible,width:"60%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"addusergroupForm",staticClass:"project",attrs:{model:e.addusergroupForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入角色名称"},model:{value:e.addusergroupForm.name,callback:function(t){e.$set(e.addusergroupForm,"name",t)},expression:"addusergroupForm.name"}})],1),e._v(" "),a("el-form-item",{staticClass:"edit_dev",attrs:{label:"授权"}},[a("el-transfer",{attrs:{data:e.data,titles:["待选择权限","已选择权限"]},model:{value:e.addusergroupForm.permissions,callback:function(t){e.$set(e.addusergroupForm,"permissions",t)},expression:"addusergroupForm.permissions"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("addusergroupForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑角色",visible:e.editdialogVisible,width:"60%",center:""},on:{"update:visible":function(t){e.editdialogVisible=t}}},[a("el-form",{ref:"editusergroupFrom",staticClass:"project",attrs:{model:e.editusergroupFrom,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入角色名称"},model:{value:e.editusergroupFrom.name,callback:function(t){e.$set(e.editusergroupFrom,"name",t)},expression:"editusergroupFrom.name"}})],1),e._v(" "),a("el-form-item",{staticClass:"edit_dev",attrs:{label:"授权"}},[a("el-transfer",{attrs:{data:e.data,titles:["待选择权限","已选择权限"]},model:{value:e.editusergroupFrom.permissions,callback:function(t){e.$set(e.editusergroupFrom,"permissions",t)},expression:"editusergroupFrom.permissions"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEditConfirm("editusergroupFrom")}}},[e._v("确 定")])],1)],1)],1)])]),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0",height:"50px"}},[a("div",{staticStyle:{"padding-top":"8px","padding-left":"20px",overflow:"hidden"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入用户组名称"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.GetUserGroupList},slot:"append"})],1)],1)],1)],1)]),e._v(" "),a("el-container",[a("el-main",{staticStyle:{padding:"0","margin-left":"10px","margin-top":"10px"}},[a("div",{staticStyle:{position:"fixed",bottom:"0",right:"0",left:"220px",top:"220px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef0f4",color:"#606266"},"highlight-current-row":"",data:e.userGroupData.results,"show-header":0!==e.userGroupData.results.length,stripe:"",height:"calc(75%)"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"角色名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.currentRow===t.row,expression:"currentRow === scope.row"}]},[a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return e.handerEditUserGroup(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.userGroupData.count,expression:"userGroupData.count !== 0"}],attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handerDelUserGroup(t.row.id)}}},[e._v("删除\n                                    ")])],1)]}}])})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.userGroupData.count,expression:"userGroupData.count !== 0 "}],staticStyle:{"padding-top":"10px"},attrs:{"page-size":5,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.userGroupData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var ss=a("VU/8")(ts,as,!1,function(e){a("H5mK")},null,null).exports,ns={components:{ProjectList:B,DataStatistics:Qa,UserList:es,UserGroup:ss},data:function(){return{activeName:"first",tabs:{first:!0,second:!1,three:!1,four:!1,five:!1}}},methods:{handleClick:function(e){switch(this.activeName=e.name,this.activeName){case"first":this.switchTab("first");break;case"second":this.switchTab("second");break;case"three":this.switchTab("three");break;case"four":this.switchTab("four");break;case"five":this.switchTab("five")}},switchTab:function(e){for(var t in this.tabs)this.tabs[t]=t===e}}},rs={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticStyle:{"padding-top":"10px","margin-left":"10px"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"项目列表",name:"first"}},[e.tabs.first?a("ProjectList"):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:"统计数据",name:"second"}},[e.tabs.second?a("DataStatistics"):e._e()],1),e._v(" "),1==this.$store.state.Is_superuser||"true"==this.$store.state.Is_superuser?a("el-tab-pane",{attrs:{label:"用户管理",name:"three"}},[e.tabs.three?a("UserList"):e._e()],1):e._e(),e._v(" "),1==this.$store.state.Is_superuser||"true"==this.$store.state.Is_superuser?a("el-tab-pane",{attrs:{label:"权限管理",name:"four"}},[e.tabs.four?a("UserGroup"):e._e()],1):e._e()],1)},staticRenderFns:[]},is=a("VU/8")(ns,rs,!1,null,null,null).exports;s.default.use(l.a);var os=new l.a({mode:"history",routes:[{path:"/testrunner/register",name:"Register",component:P,meta:{title:"用户注册"}},{path:"/testrunner/login",name:"Login",component:j,meta:{title:"用户登录"}},{path:"/testrunner",name:"Index",component:$,meta:{title:"首页",requireAuth:!0},children:[{name:"homelist",path:"index_list",component:is,meta:{title:"系统管理",requireAuth:!0}},{name:"UserList",path:"UserList",component:es,meta:{title:"用户管理",requireAuth:!0}},{name:"UserGroup",path:"UserGroup",component:ss,meta:{title:"权限管理",requireAuth:!0}},{name:"ProjectList",path:"project_list",component:B,meta:{title:"项目列表",requireAuth:!0}},{name:"DataStatistics",path:"Data_Statistics/:id",component:Qa,meta:{title:"数据统计",requireAuth:!0}},{name:"DataBase",path:"DataBase_list/:id",component:Ut,meta:{title:"数据库配置",requireAuth:!0}},{name:"ProjectDetail",path:"project/:id/dashbord",component:U,meta:{title:"项目预览",requireAuth:!0}},{name:"DebugTalk",path:"debugtalk/:id",component:J,meta:{title:"编辑驱动",requireAuth:!0}},{name:"RecordApi",path:"api_record/:id",component:ze,meta:{title:"接口模板",requireAuth:!0}},{name:"AutoTest",path:"auto_test/:id",component:nt,meta:{title:"自动化测试",requireAuth:!0}},{name:"RecordConfig",path:"record_config/:id",component:wt,meta:{title:"配置管理",requireAuth:!0}},{name:"GlobalEnv",path:"global_env/:id",component:ot,meta:{title:"全局变量",requireAuth:!0}},{name:"Reports",path:"reports/:id",component:dt,meta:{title:"历史报告",requireAuth:!0}},{name:"Task",path:"tasks/:id",component:Et,meta:{title:"定时任务",requireAuth:!0}},{name:"TestDataIndex",path:"testdataIndex/:id",component:Aa,meta:{title:"测试资料库",requireAuth:!0}},{name:"HostIP",path:"host_ip/:id",component:Bt,meta:{title:"HOST配置",requireAuth:!0}}]}]}),ls=(a("TzC8"),a("6Qis"),a("uyVo"),a("dj7y"),a("d5T6"),a("NYxO"));s.default.use(ls.a);var cs=new ls.a.Store({state:m,mutations:{isLogin:function(e,t){e.token=t},setUser:function(e,t){e.user=t},setRouterName:function(e,t){e.routerName=t},setUseractualname:function(e,t){e.useractualname=t},setUseEmail:function(e,t){e.email=t},setIs_superuser:function(e,t){e.Is_superuser=t}}}),us=a("XLwt");s.default.config.productionTip=!1,s.default.use(r.a),s.default.prototype.$echarts=us,s.default.filter("datetimeFormat",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YY-MM-DD hh:mm:ss",a=new Date(e),s=a.getFullYear(),n=a.getMonth()+1,r=a.getDate(),i=a.getHours(),o=a.getMinutes(),l=a.getSeconds(),c=Array.apply(null,Array(10)).map(function(e,t){return"0"+t});return t.replace(/YY/g,s).replace(/MM/g,c[n]||n).replace(/DD/g,c[r]||r).replace(/hh/g,c[i]||i).replace(/mm/g,c[o]||o).replace(/ss/g,c[l]||l)}),s.default.filter("timestampToTime",function(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+(t.getDate()+" ")+(t.getHours()+":")+(t.getMinutes()+":")+t.getSeconds()}),s.default.prototype.setLocalValue=function(e,t){window.localStorage?localStorage.setItem(e,t):alert("This browser does NOT support localStorage")},s.default.prototype.getLocalValue=function(e){var t=localStorage.getItem(e);return t||""},os.beforeEach(function(e,t,a){setTimeout(function(t){e.meta.title&&(document.title=e.meta.title),e.meta.requireAuth?""!==cs.state.token?a():a({name:"Login"}):a()})}),new s.default({el:"#app",router:os,store:cs,components:{App:o},template:"<App/>",created:function(){null===this.getLocalValue("token")&&this.setLocalValue("token",""),null===this.getLocalValue("user")&&this.setLocalValue("user",""),null===this.getLocalValue("routerName")&&this.setLocalValue("routerName","ProjectList"),null===this.getLocalValue("useractualname")&&this.setLocalValue("useractualname",""),null===this.getLocalValue("email")&&this.setLocalValue("email",""),null===this.getLocalValue("Is_superuser")&&this.setLocalValue("Is_superuser",""),this.$store.commit("isLogin",this.getLocalValue("token")),this.$store.commit("setUser",this.getLocalValue("user")),this.$store.commit("setRouterName",this.getLocalValue("routerName")),this.$store.commit("setUseractualname",this.getLocalValue("useractualname")),this.$store.commit("setUseEmail",this.getLocalValue("email")),this.$store.commit("setIs_superuser",this.getLocalValue("Is_superuser"))}})},NI1z:function(e,t){},O7CB:function(e,t,a){e.exports=a.p+"static/img/login-left-night.f43356b5.f43356b.png"},ODmK:function(e,t){},OkVz:function(e,t){},TQM2:function(e,t){},TzC8:function(e,t){},UAAL:function(e,t){},UD7K:function(e,t){},UMWi:function(e,t){},US7L:function(e,t){},Uonp:function(e,t){},"V12/":function(e,t){},VZlN:function(e,t){},"W/um":function(e,t){},W0BZ:function(e,t){},XU5M:function(e,t){},bRCp:function(e,t){},bnnx:function(e,t){},d5T6:function(e,t){},dj7y:function(e,t){},e8Yq:function(e,t){},eKDA:function(e,t){},fn7o:function(e,t){},gsZH:function(e,t){},ithZ:function(e,t){},jAaO:function(e,t){},kjZi:function(e,t){},ksBu:function(e,t){},l99c:function(e,t){},m2dO:function(e,t){},mEqO:function(e,t){},o75T:function(e,t){},oi8e:function(e,t){},p81v:function(e,t){},pTcj:function(e,t){},qbfa:function(e,t){},qpjN:function(e,t){},qsDG:function(e,t){},rmiQ:function(e,t){},sfPE:function(e,t){},swIO:function(e,t){},tuwf:function(e,t){},tvR6:function(e,t){},uyVo:function(e,t){},vrYQ:function(e,t){},xQym:function(e,t){},xsS8:function(e,t){},ySMl:function(e,t){},yxV7:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.58c11311b5bdc822111a.js.map
